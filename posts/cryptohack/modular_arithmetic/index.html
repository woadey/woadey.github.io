<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self'; form-action 'self'; frame-src 'self'; img-src 'self' data: https://*.google-analytics.com https://*.googletagmanager.com; object-src 'none'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' https://*.googletagmanager.com; prefetch-src 'self'; connect-src 'self' https://*.google-analytics.com https://*.analytics.google.com https://*.googletagmanager.com"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>CryptoHack: Modular Arithmetic | woadey</title><meta name=keywords content="cryptohack,crypto,modular,arithmetic"><meta name=description content="Writeups for CryptoHack's [Modular Arithmetic Course](https://cryptohack.org/courses/modular/course_details/)"><meta name=author content><link rel=canonical href=https://woadey.lol/posts/cryptohack/modular_arithmetic/><link crossorigin=anonymous href=/assets/css/stylesheet.74e2997bef7be88264fdd0518b5d02b5c5186f3b5b0a09baa04824e8b9a8ea8f.css integrity="sha256-dOKZe+976IJk/dBRi10CtcUYbztbCgm6oEgk6Lmo6o8=" rel="preload stylesheet" as=style><link rel=icon href=https://woadey.lol/favicon/pink_trans_bg/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://woadey.lol/favicon/pink_trans_bg/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://woadey.lol/favicon/pink_trans_bg/favicon-32x32.png><link rel=apple-touch-icon href=https://woadey.lol/favicon/white_pink_bg/apple-touch-icon.png><link rel=mask-icon href=https://woadey.lol/favicon/pink_trans_bg/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-EF924K1NXR"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EF924K1NXR",{anonymize_ip:!1})}</script><meta property="og:title" content="CryptoHack: Modular Arithmetic"><meta property="og:description" content="Writeups for CryptoHack's [Modular Arithmetic Course](https://cryptohack.org/courses/modular/course_details/)"><meta property="og:type" content="article"><meta property="og:url" content="https://woadey.lol/posts/cryptohack/modular_arithmetic/"><meta property="og:image" content="https://woadey.lol/images/cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-10-29T20:05:14-07:00"><meta property="article:modified_time" content="2022-10-29T20:05:14-07:00"><meta property="og:site_name" content="woadey's blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://woadey.lol/images/cover.png"><meta name=twitter:title content="CryptoHack: Modular Arithmetic"><meta name=twitter:description content="Writeups for CryptoHack's [Modular Arithmetic Course](https://cryptohack.org/courses/modular/course_details/)"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"posts","item":"https://woadey.lol/posts/"},{"@type":"ListItem","position":2,"name":"CryptoHack: Modular Arithmetic","item":"https://woadey.lol/posts/cryptohack/modular_arithmetic/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"CryptoHack: Modular Arithmetic","name":"CryptoHack: Modular Arithmetic","description":"Writeups for CryptoHack's [Modular Arithmetic Course](https://cryptohack.org/courses/modular/course_details/)","keywords":["cryptohack","crypto","modular","arithmetic"],"articleBody":"Greatest Common Divisor The Greatest Common Divisor (GCD), sometimes known as the highest common factor, is the largest number which divides two positive integers (a,b).\nFor a = 12, b = 8 we can calculate the divisors of a: {1,2,3,4,6,12} and the divisors of b: {1,2,4,8}. Comparing these two, we see that gcd(a,b) = 4.\nNow imagine we take a = 11, b = 17. Both a and b are prime numbers. As a prime number has only itself and 1 as divisors, gcd(a,b) = 1.\nWe say that for any two integers a,b, if gcd(a,b) = 1 then a and b are coprime integers.\nIf a and b are prime, they are also coprime. If a is prime and b \u003c a then a and b are coprime. There are many tools to calculate the GCD of two integers, but for this task we recommend looking up Euclid’s Algorithm.\nTry coding it up; it’s only a couple of lines. Use a = 12, b = 8 to test it.\nNow calculate gcd(a,b) for a = 66528, b = 52920 and enter it below.\nEuclid's Algorithm pseudocode:\n1 2 3 4 5 6 7 function gcd(a, b) while a ≠ b if a \u003e b a := a − b else b := b − a return a 1 2 3 4 5 function gcd(a, b) if b = 0 return a else return gcd(b, a mod b) Solution 1 2 3 4 5 def gcd(a,b): if b == 0: return a else: return gcd(b, a % b) \u003e gcd(12, 8) 4 \u003e gcd(66528, 52920) 1512 Extended GCD Let a and b be positive integers.\nThe extended Euclidean algorithm is an efficient way to find integers u,v such that a * u + b * v = gcd(a,b)\nUsing the two primes p = 26513, q = 32321, find the integers u,v such that p * u + q * v = gcd(p,q)\nEnter whichever of u and v is the lower number as the flag.\nSolution I watched this video and read this article to better understand the extended Euclidean Algorithm.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # source: https://www.geeksforgeeks.org/python-program-for-basic-and-extended-euclidean-algorithms-2/ # function for extended Euclidean Algorithm def gcdExtended(a, b): # Base Case if a == 0 : return b,0,1 gcd,x1,y1 = gcdExtended(b%a, a) # Update x and y using results of recursive call x = y1 - (b//a) * x1 y = x1 return gcd,x,y \u003e gcdExtended(26513, 32321) (1, 10245, -8404) \u003e min(10245, -8404) -8404 Modular Arithmetic 1 Imagine you lean over and look at a cryptographer’s notebook. You see some notes in the margin:\n4 + 9 = 1 5 - 7 = 10 2 + 3 = 5 At first you might think they’ve gone mad. Maybe this is why there are so many data leaks nowadays you’d think, but this is nothing more than modular arithmetic modulo 12 (albeit with some sloppy notation).\nYou may not have been calling it modular arithmetic, but you’ve been doing these kinds of calculations since you learnt to tell the time (look again at those equations and think about adding hours).\nFormally, “calculating time” is described by the theory of congruences. We say that two integers are congruent modulo m if a ≡ b mod m.\nAnother way of saying this, is that when we divide the integer a by m, the remainder is b. This tells you that if m divides a (this can be written as m | a) then a ≡ 0 mod m.\nCalculate the following integers:\n11 ≡ x mod 6 8146798528947 ≡ y mod 17 The solution is the smaller of the two integers.\nSolution if a ≡ b mod m, then b ≡ a mod m.\nSo:\n11 ≡ x mod 6 -\u003e x ≡ 11 mod 6 -\u003e x ≡ 5 8146798528947 ≡ y mod 17 -\u003e y ≡ 8146798528947 mod 17 -\u003e y ≡ 4 \u003e min(11 % 6, 8146798528947 % 17) 4 Modular Arithmetic 2 We’ll pick up from the last challenge and imagine we’ve picked a modulus p, and we will restrict ourselves to the case when p is prime.\nThe integers modulo p define a field, denoted Fp.\nA finite field Fp is the set of integers {0,1,...,p-1}, and under both addition and multiplication there is an inverse element b for every element a in the set, such that a + b = 0 and a * b = 1.\nLets say we pick p = 17. Calculate 3^17 mod 17. Now do the same but with 5^17 mod 17.\nWhat would you expect to get for 7^16 mod 17? Try calculating that.\nThis interesting fact is known as Fermat’s little theorem. We’ll be needing this (and its generalizations) when we look at RSA cryptography.\nNow take the prime p = 65537. Calculate 273246787654^65536 mod 65537.\nDid you need a calculator?\nSolution In summary, Fermat’s Little Theorem states that:\nif p is prime, for every integer a: pow(a, p) = a mod p and, if p is prime and a is an integer coprime with p: pow(a, p-1) = 1 mod p So:\n1 2 3 4 5 6 7 from math import gcd a = 273246787654 p = 65537 if gcd(a,p) == 1: print(\"Coprime! Solution is 1\") Modular Inverting As we’ve seen, we can work within a finite field Fp, adding and multiplying elements, and always obtain another element of the field.\nFor all elements g in the field, there exists a unique integer d such that g * d ≡ 1 mod p.\nThis is the multiplicative inverse of g.\nExample: 7 * 8 = 56 ≡ 1 mod 11\nWhat is the inverse element: 3 * d ≡ 1 mod 13?\nSolution Followed this tutorial.\n1 2 3 4 5 6 # a = 3 # c = 13 def imod(a,c): for i in range(c-1): if a*i == 1%c: return i \u003e print(imod(7,11)) 8 \u003e print(imod(3,13)) 9 Alternate solution(s):\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 # source: CryptoHack user @Hon ''' Looking again at Fermat's little theorem... if p is prime, for every integer a: pow(a, p) = a mod p and, if p is prime and a is an integer coprime with p: pow(a, p-1) = 1 mod p We can do some magic like this: Note: i'll use math notation, so a^b means pow(a,b) a^(p-1) = 1 (mod p) a^(p-1) * a^-1 = a^-1 (mod p) a^(p-2) * a * a^-1 = a^-1 (mod p) a^(p-2) * 1 = a^-1 (mod p) So finally we have: a^(p-2) = a^-1 (mod p) So, doing a^(p-2) and then (mod p) we can achieve our result ''' a = 3 p = 13 print(pow(a,p-2) % p) 1 2 3 4 5 6 7 8 9 10 11 12 # source: CryptoHack user @DaBaddest ''' The problem given is 3 * d ≡ 1 mod 13 To calculate d we can divide both sides by 3 which gives us d = (1/3) * 1 mod 13 which is equivalent to d = 3^-1 mod 13, where ^ symbol is raised to the power of We can easily convert this into python equation using the pow function ''' print(pow(3, -1, 13)) Quadratic Residues We’ve looked at multiplication and division in modular arithmetic, but what does it mean to take the square root modulo an integer?\nFor the following discussion, let’s work modulo p = 29. We can take the integer a = 11 and calculate a^2 = 5 mod 29.\nAs a = 11, a^2 = 5, we say the square root of 5 is 11.\nThis feels good, but now let’s think about the square root of 18. From the above, we know we need to find some integer a such that a^2 = 18\nYour first idea might be to start with a = 1 and loop to a = p-1. In this discussion p isn’t too large and we can quickly look.\nHave a go, try coding this and see what you find. If you’ve coded it right, you’ll find that for all a ∈ Fp* you never find an a such that a^2 = 18.\nWhat we are seeing, is that for the elements of F*p, not every element has a square root. In fact, what we find is that for roughly one half of the elements of Fp*, there is no square root.\nIn other words, x is a quadratic residue when it is possible to take the square root of x modulo an integer p.\nIn the below list there are two non-quadratic residues and one quadratic residue.\nFind the quadratic residue and then calculate its square root. Of the two possible roots, submit the smaller one as the flag.\np = 29 ints = [14, 6, 11] Solution 1 2 3 4 5 p = 29 ints = [14, 6, 11] qr = [a for a in range(p-1) if pow(a,2,p) in ints] print(min(qr)) 8 Legendre Symbol In Quadratic Residues we learnt what it means to take the square root modulo an integer. We also saw that taking a root isn’t always possible.\nIn the previous case when p = 29, even the simplest method of calculating the square root was fast enough, but as p gets larger, this method becomes wildly unreasonable.\nLucky for us, we have a way to check whether an integer is a quadratic residue with a single calculation thanks to Legendre. In the following, we will assume we are working modulo a prime p.\nBefore looking at Legendre’s symbol, let’s take a brief detour to see an interesting property of quadratic (non-)residues.\nQuadratic Residue * Quadratic Residue = Quadratic Residue Quadratic Residue * Quadratic Non-residue = Quadratic Non-residue Quadratic Non-residue * Quadratic Non-residue = Quadratic Residue So what’s the trick? The Legendre Symbol gives an efficient way to determine whether an integer is a quadratic residue modulo an odd prime p.\nLegendre’s Symbol: (a / p) ≡ a^(p-1)/2 mod p obeys:\n(a / p) = 1 if a is a quadratic residue and a ≢ 0 mod p (a / p) = -1 if a is a quadratic non-residue mod p (a / p) = 0 if a ≡ 0 mod p Which means given any integer a, calculating pow(a,(p-1)/2,p) is enough to determine if a is a quadratic residue.\nNow for the flag. Given the following 1024 bit prime and 10 integers, find the quadratic residue and then calculate its square root; the square root is your flag. Of the two possible roots, submit the larger one as your answer.\nChallenge files:\noutput.txt file: output.txt\n1 2 3 p = 101524035174539890485408575671085261788758965189060164484385690801466167356667036677932998889725476582421738788500738738503134356158197247473850273565349249573867251280253564698939768700489401960767007716413932851838937641880157263936985954881657889497583485535527613578457628399173971810541670838543309159139 ints = [25081841204695904475894082974192007718642931811040324543182130088804239047149283334700530600468528298920930150221871666297194395061462592781551275161695411167049544771049769000895119729307495913024360169904315078028798025169985966732789207320203861858234048872508633514498384390497048416012928086480326832803, 45471765180330439060504647480621449634904192839383897212809808339619841633826534856109999027962620381874878086991125854247108359699799913776917227058286090426484548349388138935504299609200377899052716663351188664096302672712078508601311725863678223874157861163196340391008634419348573975841578359355931590555, 17364140182001694956465593533200623738590196990236340894554145562517924989208719245429557645254953527658049246737589538280332010533027062477684237933221198639948938784244510469138826808187365678322547992099715229218615475923754896960363138890331502811292427146595752813297603265829581292183917027983351121325, 14388109104985808487337749876058284426747816961971581447380608277949200244660381570568531129775053684256071819837294436069133592772543582735985855506250660938574234958754211349215293281645205354069970790155237033436065434572020652955666855773232074749487007626050323967496732359278657193580493324467258802863, 4379499308310772821004090447650785095356643590411706358119239166662089428685562719233435615196994728767593223519226235062647670077854687031681041462632566890129595506430188602238753450337691441293042716909901692570971955078924699306873191983953501093343423248482960643055943413031768521782634679536276233318, 85256449776780591202928235662805033201684571648990042997557084658000067050672130152734911919581661523957075992761662315262685030115255938352540032297113615687815976039390537716707854569980516690246592112936796917504034711418465442893323439490171095447109457355598873230115172636184525449905022174536414781771, 50576597458517451578431293746926099486388286246142012476814190030935689430726042810458344828563913001012415702876199708216875020997112089693759638454900092580746638631062117961876611545851157613835724635005253792316142379239047654392970415343694657580353333217547079551304961116837545648785312490665576832987, 96868738830341112368094632337476840272563704408573054404213766500407517251810212494515862176356916912627172280446141202661640191237336568731069327906100896178776245311689857997012187599140875912026589672629935267844696976980890380730867520071059572350667913710344648377601017758188404474812654737363275994871, 4881261656846638800623549662943393234361061827128610120046315649707078244180313661063004390750821317096754282796876479695558644108492317407662131441224257537276274962372021273583478509416358764706098471849536036184924640593888902859441388472856822541452041181244337124767666161645827145408781917658423571721, 18237936726367556664171427575475596460727369368246286138804284742124256700367133250078608537129877968287885457417957868580553371999414227484737603688992620953200143688061024092623556471053006464123205133894607923801371986027458274343737860395496260538663183193877539815179246700525865152165600985105257601565] Solution Tonelli–Shanks algorithmis used to find the square root of n mod p.\nNote: Tonelli-Shanks doesn’t work for composite (non-prime) moduli. Finding square roots modulo composites is computationally equivalent to integer factorization.\nSince p = 3 mod 4 is hinted to us, we can conclude: [ image source: https://medium.com/@pavanipoluru.21.01/cryptohack-mathematics-d0f691fffe4e ]\n1 2 3 4 5 6 p = 101524035174539890485408575671085261788758965189060164484385690801466167356667036677932998889725476582421738788500738738503134356158197247473850273565349249573867251280253564698939768700489401960767007716413932851838937641880157263936985954881657889497583485535527613578457628399173971810541670838543309159139 ints = [25081841204695904475894082974192007718642931811040324543182130088804239047149283334700530600468528298920930150221871666297194395061462592781551275161695411167049544771049769000895119729307495913024360169904315078028798025169985966732789207320203861858234048872508633514498384390497048416012928086480326832803, 45471765180330439060504647480621449634904192839383897212809808339619841633826534856109999027962620381874878086991125854247108359699799913776917227058286090426484548349388138935504299609200377899052716663351188664096302672712078508601311725863678223874157861163196340391008634419348573975841578359355931590555, 17364140182001694956465593533200623738590196990236340894554145562517924989208719245429557645254953527658049246737589538280332010533027062477684237933221198639948938784244510469138826808187365678322547992099715229218615475923754896960363138890331502811292427146595752813297603265829581292183917027983351121325, 14388109104985808487337749876058284426747816961971581447380608277949200244660381570568531129775053684256071819837294436069133592772543582735985855506250660938574234958754211349215293281645205354069970790155237033436065434572020652955666855773232074749487007626050323967496732359278657193580493324467258802863, 4379499308310772821004090447650785095356643590411706358119239166662089428685562719233435615196994728767593223519226235062647670077854687031681041462632566890129595506430188602238753450337691441293042716909901692570971955078924699306873191983953501093343423248482960643055943413031768521782634679536276233318, 85256449776780591202928235662805033201684571648990042997557084658000067050672130152734911919581661523957075992761662315262685030115255938352540032297113615687815976039390537716707854569980516690246592112936796917504034711418465442893323439490171095447109457355598873230115172636184525449905022174536414781771, 50576597458517451578431293746926099486388286246142012476814190030935689430726042810458344828563913001012415702876199708216875020997112089693759638454900092580746638631062117961876611545851157613835724635005253792316142379239047654392970415343694657580353333217547079551304961116837545648785312490665576832987, 96868738830341112368094632337476840272563704408573054404213766500407517251810212494515862176356916912627172280446141202661640191237336568731069327906100896178776245311689857997012187599140875912026589672629935267844696976980890380730867520071059572350667913710344648377601017758188404474812654737363275994871, 4881261656846638800623549662943393234361061827128610120046315649707078244180313661063004390750821317096754282796876479695558644108492317407662131441224257537276274962372021273583478509416358764706098471849536036184924640593888902859441388472856822541452041181244337124767666161645827145408781917658423571721, 18237936726367556664171427575475596460727369368246286138804284742124256700367133250078608537129877968287885457417957868580553371999414227484737603688992620953200143688061024092623556471053006464123205133894607923801371986027458274343737860395496260538663183193877539815179246700525865152165600985105257601565] qr = [a for a in ints if pow(a, (p-1)//2, p) == 1] print(max([pow(a,(p+1)//4,p) for a in qr])) 93291799125366706806545638475797430512104976066103610269938025709952247020061090804870186195285998727680200979853848718589126765742550855954805290253592144209552123062161458584575060939481368210688629862036958857604707468372384278049741369153506182660264876115428251983455344219194133033177700490981696141526 Modular Square Root In Legendre Symbol we introduced a fast way to determine whether a number is a square root modulo a prime. We can go further: there are algorithms for efficiently calculating such roots. The best one in practice is called Tonelli-Shanks, which gets its funny name from the fact that it was first described by an Italian in the 19th century and rediscovered independently by Daniel Shanks in the 1970s.\nAll primes that aren’t 2 are of the form p ≡ 1 mod 4 or p ≡ 3 mod 4, since all odd numbers obey these congruences. As the previous challenge hinted, in the p ≡ 3 mod 4 case, a really simple formula for computing square roots can be derived directly from Fermat’s little theorem. That leaves us still with the p ≡ 1 mod 4 case, so a more general algorithm is required.\nIn a congruence of the form r2 ≡ a mod p, Tonelli-Shanks calculates r.\nThe main use-case for this algorithm is finding elliptic curve co-ordinates. Its operation is somewhat complex so we’re not going to discuss the details, however, implementations are easy to find and Sage has one built-in.\nFind the square root of a modulo the 2048-bit prime p. Give the smaller of the two roots as your answer.\nChallenge files:\noutput.txt file: output.txt\n1 2 a = 8479994658316772151941616510097127087554541274812435112009425778595495359700244470400642403747058566807127814165396640215844192327900454116257979487432016769329970767046735091249898678088061634796559556704959846424131820416048436501387617211770124292793308079214153179977624440438616958575058361193975686620046439877308339989295604537867493683872778843921771307305602776398786978353866231661453376056771972069776398999013769588936194859344941268223184197231368887060609212875507518936172060702209557124430477137421847130682601666968691651447236917018634902407704797328509461854842432015009878011354022108661461024768 p = 30531851861994333252675935111487950694414332763909083514133769861350960895076504687261369815735742549428789138300843082086550059082835141454526618160634109969195486322015775943030060449557090064811940139431735209185996454739163555910726493597222646855506445602953689527405362207926990442391705014604777038685880527537489845359101552442292804398472642356609304810680731556542002301547846635101455995732584071355903010856718680732337369128498655255277003643669031694516851390505923416710601212618443109844041514942401969629158975457079026906304328749039997262960301209158175920051890620947063936347307238412281568760161 Solution 1 2 3 4 from sage.all import * a = 8479994658316772151941616510097127087554541274812435112009425778595495359700244470400642403747058566807127814165396640215844192327900454116257979487432016769329970767046735091249898678088061634796559556704959846424131820416048436501387617211770124292793308079214153179977624440438616958575058361193975686620046439877308339989295604537867493683872778843921771307305602776398786978353866231661453376056771972069776398999013769588936194859344941268223184197231368887060609212875507518936172060702209557124430477137421847130682601666968691651447236917018634902407704797328509461854842432015009878011354022108661461024768 p = 30531851861994333252675935111487950694414332763909083514133769861350960895076504687261369815735742549428789138300843082086550059082835141454526618160634109969195486322015775943030060449557090064811940139431735209185996454739163555910726493597222646855506445602953689527405362207926990442391705014604777038685880527537489845359101552442292804398472642356609304810680731556542002301547846635101455995732584071355903010856718680732337369128498655255277003643669031694516851390505923416710601212618443109844041514942401969629158975457079026906304328749039997262960301209158175920051890620947063936347307238412281568760161 print(mod(a,p).sqrt()) 2362339307683048638327773298580489298932137505520500388338271052053734747862351779647314176817953359071871560041125289919247146074907151612762640868199621186559522068338032600991311882224016021222672243139362180461232646732465848840425458257930887856583379600967761738596782877851318489355679822813155123045705285112099448146426755110160002515592418850432103641815811071548456284263507805589445073657565381850521367969675699760755310784623577076440037747681760302434924932113640061738777601194622244192758024180853916244427254065441962557282572849162772740798989647948645207349737457445440405057156897508368531939120 Chinese Remainder Theorem The Chinese Remainder Theorem gives a unique solution to a set of linear congruences if their moduli are coprime.\nThis means, that given a set of arbitrary integers ai, and pairwise coprime integers ni, such that the following linear congruences hold:\nx ≡ a1 mod n1 x ≡ a2 mod n2 ... x ≡ an mod nn There is a unique solution x ≡ a mod N where N = n1 * n2 * ... * nn.\nIn cryptography, we commonly use the Chinese Remainder Theorem to help us reduce a problem of very large integers into a set of several, easier problems.\nGiven the following set of linear congruences:\nx ≡ 2 mod 5 x ≡ 3 mod 11 x ≡ 5 mod 17 Find the integer a such that x ≡ a mod 935\nSolution Watched this video to understand the process of crt.\n1 2 from sage.all import * print(crt([2,3,5], [5,11,17])) 872 Alternate solution(s):\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 # source: CryptoHack user @Hon ''' Looking at Chinese Remainder Theorem... Taken x = a1 (mod n1) x = a2 (mod n2) x = a3 (mod n3) With gcd(n1,n2) = gcd(n1,n3) = gcd(n2,n3) = 1 -All the n-values are coprime with the others We have N = n1*n2*n3 and N1 = n2*n3 N2 = n1*n3 N3 = n1*n2 Summaring, the Ni values are composed multiplying all the n-values each others, except n at position i Ending, we call yi the solutions of Ni*yi = 1 (mod ni) Ex: N1 * y1 = 1 (mod n1) Now, we have to find the value of integer a such that: x = a (mod N) Knowing also that: x = a1N1y1 + a2N2y2 + a3N3y3 (mod N) Easy, no? ''' # x = 2 mod 5 # x = 3 mod 11 # x = 5 mod 17 # x = a mod 935 length = 3 a = [2,3,5] n = [5,11,17] Ntot= n[0] * n[1] * n[2] N = [ n[1]*n[2] , n[0]*n[2], n[0]*n[1] ] y = [pow(N[i],n[i]-2,n[i]) for i in range(length)] mysterious_a = 0 for i in range(length): mysterious_a += a[i]*N[i]*y[i] mysterious_a %= Ntot print(mysterious_a) Adrien’s Signs Adrien’s been looking at ways to encrypt his messages with the help of symbols and minus signs. Can you find a way to recover the flag?\nChallenge files:\nsource.py output.txt file: source.py\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 from random import randint a = 288260533169915 p = 1007621497415251 FLAG = b'crypto{????????????????????}' def encrypt_flag(flag): ciphertext = [] plaintext = ''.join([bin(i)[2:].zfill(8) for i in flag]) for b in plaintext: e = randint(1, p) n = pow(a, e, p) if b == '1': ciphertext.append(n) else: n = -n % p ciphertext.append(n) return ciphertext print(encrypt_flag(FLAG)) file: output.txt\n1 [67594220461269, 501237540280788, 718316769824518, 296304224247167, 48290626940198, 30829701196032, 521453693392074, 840985324383794, 770420008897119, 745131486581197, 729163531979577, 334563813238599, 289746215495432, 538664937794468, 894085795317163, 983410189487558, 863330928724430, 996272871140947, 352175210511707, 306237700811584, 631393408838583, 589243747914057, 538776819034934, 365364592128161, 454970171810424, 986711310037393, 657756453404881, 388329936724352, 90991447679370, 714742162831112, 62293519842555, 653941126489711, 448552658212336, 970169071154259, 339472870407614, 406225588145372, 205721593331090, 926225022409823, 904451547059845, 789074084078342, 886420071481685, 796827329208633, 433047156347276, 21271315846750, 719248860593631, 534059295222748, 879864647580512, 918055794962142, 635545050939893, 319549343320339, 93008646178282, 926080110625306, 385476640825005, 483740420173050, 866208659796189, 883359067574584, 913405110264883, 898864873510337, 208598541987988, 23412800024088, 911541450703474, 57446699305445, 513296484586451, 180356843554043, 756391301483653, 823695939808936, 452898981558365, 383286682802447, 381394258915860, 385482809649632, 357950424436020, 212891024562585, 906036654538589, 706766032862393, 500658491083279, 134746243085697, 240386541491998, 850341345692155, 826490944132718, 329513332018620, 41046816597282, 396581286424992, 488863267297267, 92023040998362, 529684488438507, 925328511390026, 524897846090435, 413156582909097, 840524616502482, 325719016994120, 402494835113608, 145033960690364, 43932113323388, 683561775499473, 434510534220939, 92584300328516, 763767269974656, 289837041593468, 11468527450938, 628247946152943, 8844724571683, 813851806959975, 72001988637120, 875394575395153, 70667866716476, 75304931994100, 226809172374264, 767059176444181, 45462007920789, 472607315695803, 325973946551448, 64200767729194, 534886246409921, 950408390792175, 492288777130394, 226746605380806, 944479111810431, 776057001143579, 658971626589122, 231918349590349, 699710172246548, 122457405264610, 643115611310737, 999072890586878, 203230862786955, 348112034218733, 240143417330886, 927148962961842, 661569511006072, 190334725550806, 763365444730995, 516228913786395, 846501182194443, 741210200995504, 511935604454925, 687689993302203, 631038090127480, 961606522916414, 138550017953034, 932105540686829, 215285284639233, 772628158955819, 496858298527292, 730971468815108, 896733219370353, 967083685727881, 607660822695530, 650953466617730, 133773994258132, 623283311953090, 436380836970128, 237114930094468, 115451711811481, 674593269112948, 140400921371770, 659335660634071, 536749311958781, 854645598266824, 303305169095255, 91430489108219, 573739385205188, 400604977158702, 728593782212529, 807432219147040, 893541884126828, 183964371201281, 422680633277230, 218817645778789, 313025293025224, 657253930848472, 747562211812373, 83456701182914, 470417289614736, 641146659305859, 468130225316006, 46960547227850, 875638267674897, 662661765336441, 186533085001285, 743250648436106, 451414956181714, 527954145201673, 922589993405001, 242119479617901, 865476357142231, 988987578447349, 430198555146088, 477890180119931, 844464003254807, 503374203275928, 775374254241792, 346653210679737, 789242808338116, 48503976498612, 604300186163323, 475930096252359, 860836853339514, 994513691290102, 591343659366796, 944852018048514, 82396968629164, 152776642436549, 916070996204621, 305574094667054, 981194179562189, 126174175810273, 55636640522694, 44670495393401, 74724541586529, 988608465654705, 870533906709633, 374564052429787, 486493568142979, 469485372072295, 221153171135022, 289713227465073, 952450431038075, 107298466441025, 938262809228861, 253919870663003, 835790485199226, 655456538877798, 595464842927075, 191621819564547] Solution First hint to the problem is the title: Adrien's Signs. The Legendre symbol was introduced by Adrien-Marie Legendre, so it would seem wise to use it here. Let’s look more into the code to see what’s going on.\nBasically, the byte letters of the plaintext flag are each converted to 8 bits (with padding of zeros). These are then joined together to make a large string of bits. For every bit, a**randit(1,p) % p is done to create n. If the bit happens to be 1, n is appended to the ciphertext list - otherwise n = -n % p occurs before appending n to the list.\nSo, we just need to determine whether the value is a 0 or 1 for each bit of information.\nFirst, we ensure a is indeed prime.\nThen, we check to make sure that (a / p) = 1 by the Legendre symbol to prove a is quadratic residue of mod p. Since this is the case, all encrypted values that are also quadratic residues of mod p will leak the value 1 back to us. In the case of the bit being 0, -n mod p = a^e mod p which becomes n = -a^e or (-1/p):\n[ image source: https://en.wikipedia.org/wiki/Legendre_symbol ]\nTherefore, when encrypted values are non-quadratic residue, it is a 0 bit.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 from Crypto.Util.number import long_to_bytes a = 288260533169915 p = 1007621497415251 enc = [67594220461269, 501237540280788, 718316769824518, 296304224247167, 48290626940198, 30829701196032, 521453693392074, 840985324383794, 770420008897119, 745131486581197, 729163531979577, 334563813238599, 289746215495432, 538664937794468, 894085795317163, 983410189487558, 863330928724430, 996272871140947, 352175210511707, 306237700811584, 631393408838583, 589243747914057, 538776819034934, 365364592128161, 454970171810424, 986711310037393, 657756453404881, 388329936724352, 90991447679370, 714742162831112, 62293519842555, 653941126489711, 448552658212336, 970169071154259, 339472870407614, 406225588145372, 205721593331090, 926225022409823, 904451547059845, 789074084078342, 886420071481685, 796827329208633, 433047156347276, 21271315846750, 719248860593631, 534059295222748, 879864647580512, 918055794962142, 635545050939893, 319549343320339, 93008646178282, 926080110625306, 385476640825005, 483740420173050, 866208659796189, 883359067574584, 913405110264883, 898864873510337, 208598541987988, 23412800024088, 911541450703474, 57446699305445, 513296484586451, 180356843554043, 756391301483653, 823695939808936, 452898981558365, 383286682802447, 381394258915860, 385482809649632, 357950424436020, 212891024562585, 906036654538589, 706766032862393, 500658491083279, 134746243085697, 240386541491998, 850341345692155, 826490944132718, 329513332018620, 41046816597282, 396581286424992, 488863267297267, 92023040998362, 529684488438507, 925328511390026, 524897846090435, 413156582909097, 840524616502482, 325719016994120, 402494835113608, 145033960690364, 43932113323388, 683561775499473, 434510534220939, 92584300328516, 763767269974656, 289837041593468, 11468527450938, 628247946152943, 8844724571683, 813851806959975, 72001988637120, 875394575395153, 70667866716476, 75304931994100, 226809172374264, 767059176444181, 45462007920789, 472607315695803, 325973946551448, 64200767729194, 534886246409921, 950408390792175, 492288777130394, 226746605380806, 944479111810431, 776057001143579, 658971626589122, 231918349590349, 699710172246548, 122457405264610, 643115611310737, 999072890586878, 203230862786955, 348112034218733, 240143417330886, 927148962961842, 661569511006072, 190334725550806, 763365444730995, 516228913786395, 846501182194443, 741210200995504, 511935604454925, 687689993302203, 631038090127480, 961606522916414, 138550017953034, 932105540686829, 215285284639233, 772628158955819, 496858298527292, 730971468815108, 896733219370353, 967083685727881, 607660822695530, 650953466617730, 133773994258132, 623283311953090, 436380836970128, 237114930094468, 115451711811481, 674593269112948, 140400921371770, 659335660634071, 536749311958781, 854645598266824, 303305169095255, 91430489108219, 573739385205188, 400604977158702, 728593782212529, 807432219147040, 893541884126828, 183964371201281, 422680633277230, 218817645778789, 313025293025224, 657253930848472, 747562211812373, 83456701182914, 470417289614736, 641146659305859, 468130225316006, 46960547227850, 875638267674897, 662661765336441, 186533085001285, 743250648436106, 451414956181714, 527954145201673, 922589993405001, 242119479617901, 865476357142231, 988987578447349, 430198555146088, 477890180119931, 844464003254807, 503374203275928, 775374254241792, 346653210679737, 789242808338116, 48503976498612, 604300186163323, 475930096252359, 860836853339514, 994513691290102, 591343659366796, 944852018048514, 82396968629164, 152776642436549, 916070996204621, 305574094667054, 981194179562189, 126174175810273, 55636640522694, 44670495393401, 74724541586529, 988608465654705, 870533906709633, 374564052429787, 486493568142979, 469485372072295, 221153171135022, 289713227465073, 952450431038075, 107298466441025, 938262809228861, 253919870663003, 835790485199226, 655456538877798, 595464842927075, 191621819564547] # Check if prime is of the form p ≡ 3 mod 4 (not p ≡ 1 mod 4) # pow(a, (p-1)//2, p) == kronecker(a,p) assert kronecker(a, p) == 1 pt_bits = '0b' for x in enc: # pow(x, (p-1)//2, p) == kronecker(x,p) qr = kronecker(x, p) if qr == 1: pt_bits += '1' else: # qr == p-1 =\u003e 1007621497415250 pt_bits += '0' pt_int = int(pt_bits,2) print(long_to_bytes(pt_int)) b'crypto{p4tterns_1n_re5idu3s}' Modular Binomials Rearrange the following equations to get the primes p,q\nN = p*q c1 = (2*p + 3*q)**e1 mod N c2 = (5*p + 7*q)**e2 mod N Challenge files:\ndata.txt file: data.txt\n1 2 3 4 5 N = 14905562257842714057932724129575002825405393502650869767115942606408600343380327866258982402447992564988466588305174271674657844352454543958847568190372446723549627752274442789184236490768272313187410077124234699854724907039770193680822495470532218905083459730998003622926152590597710213127952141056029516116785229504645179830037937222022291571738973603920664929150436463632305664687903244972880062028301085749434688159905768052041207513149370212313943117665914802379158613359049957688563885391972151218676545972118494969247440489763431359679770422939441710783575668679693678435669541781490217731619224470152467768073 e1 = 12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137 e2 = 12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697 c1 = 14010729418703228234352465883041270611113735889838753433295478495763409056136734155612156934673988344882629541204985909650433819205298939877837314145082403528055884752079219150739849992921393509593620449489882380176216648401057401569934043087087362272303101549800941212057354903559653373299153430753882035233354304783275982332995766778499425529570008008029401325668301144188970480975565215953953985078281395545902102245755862663621187438677596628109967066418993851632543137353041712721919291521767262678140115188735994447949166616101182806820741928292882642234238450207472914232596747755261325098225968268926580993051 c2 = 14386997138637978860748278986945098648507142864584111124202580365103793165811666987664851210230009375267398957979494066880296418013345006977654742303441030008490816239306394492168516278328851513359596253775965916326353050138738183351643338294802012193721879700283088378587949921991198231956871429805847767716137817313612304833733918657887480468724409753522369325138502059408241232155633806496752350562284794715321835226991147547651155287812485862794935695241612676255374480132722940682140395725089329445356434489384831036205387293760789976615210310436732813848937666608611803196199865435145094486231635966885932646519 Solution Unintended solution is factordb!\np = 112274000169258486390262064441991200608556376127408952701514962644340921899196091557519382763356534106376906489445103255177593594898966250176773605432765983897105047795619470659157057093771407309168345670541418772427807148039207489900810013783673957984006269120652134007689272484517805398390277308001719431273 q = 132760587806365301971479157072031448380135765794466787456948786731168095877956875295282661565488242190731593282663694728914945967253173047324353981530949360031535707374701705328450856944598803228299967009004598984671293494375599408764139743217465012770376728876547958852025425539298410751132782632817947101601 Alternate solution(s):\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 # source: CryptoHack user @diksown from fractions import gcd N = 14905562257842714057932724129575002825405393502650869767115942606408600343380327866258982402447992564988466588305174271674657844352454543958847568190372446723549627752274442789184236490768272313187410077124234699854724907039770193680822495470532218905083459730998003622926152590597710213127952141056029516116785229504645179830037937222022291571738973603920664929150436463632305664687903244972880062028301085749434688159905768052041207513149370212313943117665914802379158613359049957688563885391972151218676545972118494969247440489763431359679770422939441710783575668679693678435669541781490217731619224470152467768073 e1 = 12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137 e2 = 12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697 c1 = 14010729418703228234352465883041270611113735889838753433295478495763409056136734155612156934673988344882629541204985909650433819205298939877837314145082403528055884752079219150739849992921393509593620449489882380176216648401057401569934043087087362272303101549800941212057354903559653373299153430753882035233354304783275982332995766778499425529570008008029401325668301144188970480975565215953953985078281395545902102245755862663621187438677596628109967066418993851632543137353041712721919291521767262678140115188735994447949166616101182806820741928292882642234238450207472914232596747755261325098225968268926580993051 c2 = 14386997138637978860748278986945098648507142864584111124202580365103793165811666987664851210230009375267398957979494066880296418013345006977654742303441030008490816239306394492168516278328851513359596253775965916326353050138738183351643338294802012193721879700283088378587949921991198231956871429805847767716137817313612304833733918657887480468724409753522369325138502059408241232155633806496752350562284794715321835226991147547651155287812485862794935695241612676255374480132722940682140395725089329445356434489384831036205387293760789976615210310436732813848937666608611803196199865435145094486231635966885932646519 #N = p*q #c1 = (2*p + 3*q)**e1 mod /N #c2 = (5*p + 7*q)**e2 mod N #c1^e2 = (2*p + 3*q)**(e1*e2) mod N #c2^e1 = (5*p + 7*q)**(e1*e2) mod N #f1 = 5^e1*e2 * c1^e2 = (10*p + 15*q)**(e1*e2) mod N #f2 = 2^e1*e2 * c2^e1 = (10*p + 14*q)**(e1*e2) mod N #f1 mod q = f2 mod q =\u003e f1-f2 = 0 mod q f1 = pow(5, e1*e2, N) * pow(c1, e2, N) f2 = pow(2, e1*e2, N) * pow(c2, e1, N) q = abs(gcd(N, f1-f2)) p = N//q print(N, p, q, N-p*q, sep='\\n') source: CryptoHack user @exp101t 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 from math import gcd n = 14905562257842714057932724129575002825405393502650869767115942606408600343380327866258982402447992564988466588305174271674657844352454543958847568190372446723549627752274442789184236490768272313187410077124234699854724907039770193680822495470532218905083459730998003622926152590597710213127952141056029516116785229504645179830037937222022291571738973603920664929150436463632305664687903244972880062028301085749434688159905768052041207513149370212313943117665914802379158613359049957688563885391972151218676545972118494969247440489763431359679770422939441710783575668679693678435669541781490217731619224470152467768073 e1 = 12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137 e2 = 12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697 c1 = 14010729418703228234352465883041270611113735889838753433295478495763409056136734155612156934673988344882629541204985909650433819205298939877837314145082403528055884752079219150739849992921393509593620449489882380176216648401057401569934043087087362272303101549800941212057354903559653373299153430753882035233354304783275982332995766778499425529570008008029401325668301144188970480975565215953953985078281395545902102245755862663621187438677596628109967066418993851632543137353041712721919291521767262678140115188735994447949166616101182806820741928292882642234238450207472914232596747755261325098225968268926580993051 c2 = 14386997138637978860748278986945098648507142864584111124202580365103793165811666987664851210230009375267398957979494066880296418013345006977654742303441030008490816239306394492168516278328851513359596253775965916326353050138738183351643338294802012193721879700283088378587949921991198231956871429805847767716137817313612304833733918657887480468724409753522369325138502059408241232155633806496752350562284794715321835226991147547651155287812485862794935695241612676255374480132722940682140395725089329445356434489384831036205387293760789976615210310436732813848937666608611803196199865435145094486231635966885932646519 q1 = pow(c1, e2, n) q2 = pow(c2, e1, n) d = pow(5, e1 * e2, n) * q1 - pow(2, e1 * e2, n) * q2 q = gcd(d, n) p = n // q assert(p * q == n) ","wordCount":"3723","inLanguage":"en","image":"https://woadey.lol/images/cover.png","datePublished":"2022-10-29T20:05:14-07:00","dateModified":"2022-10-29T20:05:14-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://woadey.lol/posts/cryptohack/modular_arithmetic/"},"publisher":{"@type":"Organization","name":"woadey","logo":{"@type":"ImageObject","url":"https://woadey.lol/favicon/pink_trans_bg/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://woadey.lol/ accesskey=h title="oadey (Alt + H)"><img src=https://woadey.lol/favicon/white_pink_bg/apple-touch-icon.png height=30 width=30 alt=logo aria-label=logo>oadey</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://woadey.lol/posts/ title=posts><span>posts</span></a></li><li><a href=https://woadey.lol/categories/ title=categories><span>categories</span></a></li><li><a href=https://woadey.lol/tags/ title=tags><span>tags</span></a></li><li><a href=https://woadey.lol/archives/ title=archives><span>archives</span></a></li><li><a href=https://woadey.lol/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://woadey.lol/>home</a>&nbsp;»&nbsp;<a href=https://woadey.lol/posts/>posts</a></div><h1 class=post-title>CryptoHack: Modular Arithmetic</h1><div class=post-description>Writeups for CryptoHack&rsquo;s <a href=https://cryptohack.org/courses/modular/course_details/ title="Modular Arithmetic Course" target=_blank rel="nofollow noopener">Modular Arithmetic Course</a></div><div class=post-meta><span title='2022-10-29 20:05:14 -0700 -0700'>October 29, 2022</span>&nbsp;·&nbsp;18 min</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#greatest-common-divisor>Greatest Common Divisor</a><ul><li><a href=#solution>Solution</a></li></ul></li><li><a href=#extended-gcd>Extended GCD</a><ul><li><a href=#solution-1>Solution</a></li></ul></li><li><a href=#modular-arithmetic-1>Modular Arithmetic 1</a><ul><li><a href=#solution-2>Solution</a></li></ul></li><li><a href=#modular-arithmetic-2>Modular Arithmetic 2</a><ul><li><a href=#solution-3>Solution</a></li></ul></li><li><a href=#modular-inverting>Modular Inverting</a><ul><li><a href=#solution-4>Solution</a></li></ul></li><li><a href=#quadratic-residues>Quadratic Residues</a><ul><li><a href=#solution-5>Solution</a></li></ul></li><li><a href=#legendre-symbol>Legendre Symbol</a><ul><li><a href=#solution-6>Solution</a></li></ul></li><li><a href=#modular-square-root>Modular Square Root</a><ul><li><a href=#solution-7>Solution</a></li></ul></li><li><a href=#chinese-remainder-theorem>Chinese Remainder Theorem</a><ul><li><a href=#solution-8>Solution</a></li></ul></li><li><a href=#adriens-signs>Adrien&rsquo;s Signs</a><ul><li><a href=#solution-9>Solution</a></li></ul></li><li><a href=#modular-binomials>Modular Binomials</a><ul><li><a href=#solution-10>Solution</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=greatest-common-divisor>Greatest Common Divisor<a hidden class=anchor aria-hidden=true href=#greatest-common-divisor>#</a></h2><blockquote><p>The Greatest Common Divisor (<code>GCD</code>), sometimes known as the highest common factor, is the largest number which divides two positive integers (<code>a</code>,<code>b</code>).</p><p>For <code>a = 12</code>, <code>b = 8</code> we can calculate the divisors of <code>a: {1,2,3,4,6,12}</code> and the divisors of <code>b: {1,2,4,8}</code>. Comparing these two, we see that <code>gcd(a,b) = 4</code>.</p><p>Now imagine we take <code>a = 11</code>, <code>b = 17</code>. Both <code>a</code> and <code>b</code> are prime numbers. As a prime number has only itself and <code>1</code> as divisors, <code>gcd(a,b) = 1</code>.</p><p>We say that for any two integers <code>a,b</code>, if <code>gcd(a,b) = 1</code> then a and b are <strong>coprime</strong> integers.</p><p>If <code>a</code> and <code>b</code> are prime, they are also coprime. If <code>a</code> is prime and <code>b</code> &lt; <code>a</code> then <code>a</code> and <code>b</code> are coprime.
There are many tools to calculate the GCD of two integers, but for this task we recommend looking up <a href=https://en.wikipedia.org/wiki/Euclidean_algorithm title="Euclid&rsquo;s Algorithm" target=_blank rel="nofollow noopener">Euclid&rsquo;s Algorithm</a>.</p><p>Try coding it up; it&rsquo;s only a couple of lines. Use <code>a = 12, b = 8</code> to test it.</p><p>Now calculate <code>gcd(a,b)</code> for <code>a = 66528, b = 52920</code> and enter it below.</p></blockquote><p><code>Euclid's Algorithm</code> pseudocode:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>gcd</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=nx>a</span> <span class=err>≠</span> <span class=nx>b</span> 
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>a</span> <span class=o>&gt;</span> <span class=nx>b</span>
</span></span><span class=line><span class=cl>            <span class=nx>a</span> <span class=o>:=</span> <span class=nx>a</span> <span class=err>−</span> <span class=nx>b</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span>
</span></span><span class=line><span class=cl>            <span class=nx>b</span> <span class=o>:=</span> <span class=nx>b</span> <span class=err>−</span> <span class=nx>a</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>a</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>gcd</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>b</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>a</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>gcd</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>a</span> <span class=nx>mod</span> <span class=nx>b</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=solution>Solution<a hidden class=anchor aria-hidden=true href=#solution>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>gcd</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>b</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>a</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>gcd</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>%</span> <span class=n>b</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>gcd</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>gcd</span><span class=p>(</span><span class=mi>66528</span><span class=p>,</span> <span class=mi>52920</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=mi>1512</span>
</span></span></code></pre></div><h2 id=extended-gcd>Extended GCD<a hidden class=anchor aria-hidden=true href=#extended-gcd>#</a></h2><blockquote><p>Let <code>a</code> and <code>b</code> be positive integers.</p><p>The extended Euclidean algorithm is an efficient way to find integers <code>u,v</code> such that <code>a * u + b * v = gcd(a,b)</code></p><p>Using the two primes <code>p = 26513, q = 32321</code>, find the integers <code>u,v</code> such that <code>p * u + q * v = gcd(p,q)</code></p><p>Enter whichever of u and v is the lower number as the flag.</p></blockquote><h3 id=solution-1>Solution<a hidden class=anchor aria-hidden=true href=#solution-1>#</a></h3><p>I watched <a href="https://www.youtube.com/watch?v=hB34-GSDT3k" title="this video" target=_blank rel="nofollow noopener">this video</a> and read <a href=http://www-math.ucdenver.edu/~wcherowi/courses/m5410/exeucalg.html title="this article" target=_blank rel="nofollow noopener">this article</a> to better understand the extended Euclidean Algorithm.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># source: https://www.geeksforgeeks.org/python-program-for-basic-and-extended-euclidean-algorithms-2/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># function for extended Euclidean Algorithm</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gcdExtended</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># Base Case</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>a</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>b</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>gcd</span><span class=p>,</span><span class=n>x1</span><span class=p>,</span><span class=n>y1</span> <span class=o>=</span> <span class=n>gcdExtended</span><span class=p>(</span><span class=n>b</span><span class=o>%</span><span class=n>a</span><span class=p>,</span> <span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Update x and y using results of recursive call</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>y1</span> <span class=o>-</span> <span class=p>(</span><span class=n>b</span><span class=o>//</span><span class=n>a</span><span class=p>)</span> <span class=o>*</span> <span class=n>x1</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>x1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>gcd</span><span class=p>,</span><span class=n>x</span><span class=p>,</span><span class=n>y</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>gcdExtended</span><span class=p>(</span><span class=mi>26513</span><span class=p>,</span> <span class=mi>32321</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>10245</span><span class=p>,</span> <span class=o>-</span><span class=mi>8404</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=nb>min</span><span class=p>(</span><span class=mi>10245</span><span class=p>,</span> <span class=o>-</span><span class=mi>8404</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=mi>8404</span>
</span></span></code></pre></div><h2 id=modular-arithmetic-1>Modular Arithmetic 1<a hidden class=anchor aria-hidden=true href=#modular-arithmetic-1>#</a></h2><blockquote><p>Imagine you lean over and look at a cryptographer&rsquo;s notebook. You see some notes in the margin:</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>4 + 9 = 1
</span></span><span class=line><span class=cl>5 - 7 = 10
</span></span><span class=line><span class=cl>2 + 3 = 5
</span></span></code></pre></div><blockquote><p>At first you might think they&rsquo;ve gone mad. Maybe this is why there are so many data leaks nowadays you&rsquo;d think, but this is nothing more than modular arithmetic modulo 12 (albeit with some sloppy notation).</p><p>You may not have been calling it modular arithmetic, but you&rsquo;ve been doing these kinds of calculations since you learnt to tell the time (look again at those equations and think about adding hours).</p><p>Formally, &ldquo;calculating time&rdquo; is described by the theory of congruences. We say that two integers are congruent modulo m if <code>a ≡ b mod m</code>.</p><p>Another way of saying this, is that when we divide the integer <code>a</code> by <code>m</code>, the remainder is <code>b</code>. This tells you that if m divides a (this can be written as <code>m | a</code>) then <code>a ≡ 0 mod m</code>.</p><p>Calculate the following integers:</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>11 ≡ x mod 6
</span></span><span class=line><span class=cl>8146798528947 ≡ y mod 17
</span></span></code></pre></div><blockquote><p>The solution is the smaller of the two integers.</p></blockquote><h3 id=solution-2>Solution<a hidden class=anchor aria-hidden=true href=#solution-2>#</a></h3><p><a href=chrome-extension://efaidnbmnnnibpcajpcglclefindmkaj/https://www.math.nyu.edu/~hausner/congruence.pdf title="if a ≡ b mod m, then b ≡ a mod m."><em>if <code>a ≡ b mod m</code>, then <code>b ≡ a mod m</code>.</em></a></p><p>So:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>11 ≡ x mod 6 -&gt; x ≡ 11 mod 6 -&gt; x ≡ 5
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>8146798528947 ≡ y mod 17 -&gt; y ≡ 8146798528947 mod 17 -&gt; y ≡ 4
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;</span> <span class=nb>min</span><span class=p>(</span><span class=mi>11</span> <span class=o>%</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>8146798528947</span> <span class=o>%</span> <span class=mi>17</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>
</span></span></code></pre></div><h2 id=modular-arithmetic-2>Modular Arithmetic 2<a hidden class=anchor aria-hidden=true href=#modular-arithmetic-2>#</a></h2><blockquote><p>We&rsquo;ll pick up from the last challenge and imagine we&rsquo;ve picked a modulus <code>p</code>, and we will restrict ourselves to the case when <code>p</code> is prime.</p><p>The integers modulo <code>p</code> define a field, denoted <code>Fp</code>.</p><p>A finite field <code>Fp</code> is the set of integers <code>{0,1,...,p-1}</code>, and under both addition and multiplication there is an inverse element <code>b</code> for every element <code>a</code> in the set, such that <code>a + b = 0</code> and <code>a * b = 1</code>.</p><p>Lets say we pick <code>p = 17</code>. Calculate <code>3^17 mod 17</code>. Now do the same but with <code>5^17 mod 17</code>.</p><p>What would you expect to get for <code>7^16 mod 17</code>? Try calculating that.</p><p>This interesting fact is known as Fermat&rsquo;s little theorem. We&rsquo;ll be needing this (and its generalizations) when we look at RSA cryptography.</p><p>Now take the prime <code>p = 65537</code>. Calculate <code>273246787654^65536 mod 65537</code>.</p><p>Did you need a calculator?</p></blockquote><h3 id=solution-3>Solution<a hidden class=anchor aria-hidden=true href=#solution-3>#</a></h3><p>In summary, <a href=https://en.wikipedia.org/wiki/Fermat%27s_little_theorem title="Fermat&rsquo;s Little Theorem" target=_blank rel="nofollow noopener">Fermat&rsquo;s Little Theorem</a> states that:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>if p is prime, for every integer a:
</span></span><span class=line><span class=cl>    pow(a, p) = a mod p
</span></span><span class=line><span class=cl>and, if p is prime and a is an integer coprime with p:
</span></span><span class=line><span class=cl>    pow(a, p-1) = 1 mod p
</span></span></code></pre></div><p>So:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>math</span> <span class=kn>import</span> <span class=n>gcd</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=mi>273246787654</span>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>gcd</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>p</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Coprime! Solution is 1&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=modular-inverting>Modular Inverting<a hidden class=anchor aria-hidden=true href=#modular-inverting>#</a></h2><blockquote><p>As we&rsquo;ve seen, we can work within a finite field <code>Fp</code>, adding and multiplying elements, and always obtain another element of the field.</p><p>For all elements <code>g</code> in the field, there exists a unique integer <code>d</code> such that <code>g * d ≡ 1 mod p</code>.</p><p>This is the multiplicative inverse of <code>g</code>.</p><p>Example: <code>7 * 8 = 56 ≡ 1 mod 11</code></p><p>What is the inverse element: <code>3 * d ≡ 1 mod 13</code>?</p></blockquote><h3 id=solution-4>Solution<a hidden class=anchor aria-hidden=true href=#solution-4>#</a></h3><p>Followed <a href=https://www.khanacademy.org/computing/computer-science/cryptography/modarithmetic/a/modular-inverses title="this tutorial" target=_blank rel="nofollow noopener">this tutorial</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># a = 3</span>
</span></span><span class=line><span class=cl><span class=c1># c = 13</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>imod</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>c</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>c</span><span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>a</span><span class=o>*</span><span class=n>i</span> <span class=o>==</span> <span class=mi>1</span><span class=o>%</span><span class=n>c</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>i</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=n>imod</span><span class=p>(</span><span class=mi>7</span><span class=p>,</span><span class=mi>11</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=n>imod</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=mi>13</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=mi>9</span>
</span></span></code></pre></div><p>Alternate solution(s):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># source: CryptoHack user @Hon</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>Looking again at Fermat&#39;s little theorem...
</span></span></span><span class=line><span class=cl><span class=s1>if p is prime, for every integer a:
</span></span></span><span class=line><span class=cl><span class=s1>        pow(a, p) = a mod p
</span></span></span><span class=line><span class=cl><span class=s1>and, if p is prime and a is an integer coprime with p:
</span></span></span><span class=line><span class=cl><span class=s1>        pow(a, p-1) = 1 mod p
</span></span></span><span class=line><span class=cl><span class=s1>We can do some magic like this:
</span></span></span><span class=line><span class=cl><span class=s1>Note: i&#39;ll use math notation, so a^b means pow(a,b)
</span></span></span><span class=line><span class=cl><span class=s1>        a^(p-1) = 1 (mod p)
</span></span></span><span class=line><span class=cl><span class=s1>        a^(p-1) * a^-1 = a^-1 (mod p)
</span></span></span><span class=line><span class=cl><span class=s1>        a^(p-2) * a * a^-1 = a^-1 (mod p)
</span></span></span><span class=line><span class=cl><span class=s1>        a^(p-2) * 1 = a^-1 (mod p)
</span></span></span><span class=line><span class=cl><span class=s1>So finally we have:
</span></span></span><span class=line><span class=cl><span class=s1>        a^(p-2) = a^-1 (mod p)
</span></span></span><span class=line><span class=cl><span class=s1>So, doing a^(p-2) and then (mod p) we can achieve
</span></span></span><span class=line><span class=cl><span class=s1>our result
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>pow</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>p</span><span class=o>-</span><span class=mi>2</span><span class=p>)</span> <span class=o>%</span> <span class=n>p</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># source: CryptoHack user @DaBaddest</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>The problem given is 3 * d ≡ 1 mod 13
</span></span></span><span class=line><span class=cl><span class=s1>To calculate d we can divide both sides by 3 which gives us
</span></span></span><span class=line><span class=cl><span class=s1>  d = (1/3) * 1 mod 13
</span></span></span><span class=line><span class=cl><span class=s1>which is equivalent to
</span></span></span><span class=line><span class=cl><span class=s1>  d = 3^-1 mod 13, where ^ symbol is raised to the power of
</span></span></span><span class=line><span class=cl><span class=s1>We can easily convert this into python equation using the pow function
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>pow</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>13</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=quadratic-residues>Quadratic Residues<a hidden class=anchor aria-hidden=true href=#quadratic-residues>#</a></h2><blockquote><p>We&rsquo;ve looked at multiplication and division in modular arithmetic, but what does it mean to take the square root modulo an integer?</p><p>For the following discussion, let&rsquo;s work modulo <code>p = 29</code>. We can take the integer <code>a = 11</code> and calculate <code>a^2 = 5 mod 29</code>.</p><p>As <code>a = 11</code>, <code>a^2 = 5</code>, we say the square root of <code>5</code> is <code>11</code>.</p><p>This feels good, but now let&rsquo;s think about the square root of <code>18</code>. From the above, we know we need to find some integer a such that <code>a^2 = 18</code></p><p>Your first idea might be to start with <code>a = 1</code> and loop to <code>a = p-1</code>. In this discussion p isn&rsquo;t too large and we can quickly look.</p><p>Have a go, try coding this and see what you find. If you&rsquo;ve coded it right, you&rsquo;ll find that for all <code>a ∈ Fp*</code> you never find an a such that <code>a^2 = 18</code>.</p><p>What we are seeing, is that for the elements of <code>F*p</code>, not every element has a square root. In fact, what we find is that for roughly one half of the elements of <code>Fp*</code>, there is no square root.</p><p>In other words, <code>x</code> is a quadratic residue when it is possible to take the square root of <code>x</code> modulo an integer <code>p</code>.</p><p>In the below list there are two non-quadratic residues and one quadratic residue.</p><p>Find the quadratic residue and then calculate its square root. Of the two possible roots, submit the smaller one as the flag.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>p = 29
</span></span><span class=line><span class=cl>ints = [14, 6, 11]
</span></span></code></pre></div><h3 id=solution-5>Solution<a hidden class=anchor aria-hidden=true href=#solution-5>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>29</span>
</span></span><span class=line><span class=cl><span class=n>ints</span> <span class=o>=</span> <span class=p>[</span><span class=mi>14</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>11</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>qr</span> <span class=o>=</span> <span class=p>[</span><span class=n>a</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>p</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=k>if</span> <span class=nb>pow</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=n>p</span><span class=p>)</span> <span class=ow>in</span> <span class=n>ints</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>min</span><span class=p>(</span><span class=n>qr</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=mi>8</span>
</span></span></code></pre></div><h2 id=legendre-symbol>Legendre Symbol<a hidden class=anchor aria-hidden=true href=#legendre-symbol>#</a></h2><blockquote><p>In Quadratic Residues we learnt what it means to take the square root modulo an integer. We also saw that taking a root isn&rsquo;t always possible.</p><p>In the previous case when <code>p = 29</code>, even the simplest method of calculating the square root was fast enough, but as <code>p</code> gets larger, this method becomes wildly unreasonable.</p><p>Lucky for us, we have a way to check whether an integer is a quadratic residue with a single calculation thanks to Legendre. In the following, we will assume we are working modulo a prime p.</p><p>Before looking at Legendre&rsquo;s symbol, let&rsquo;s take a brief detour to see an interesting property of quadratic (non-)residues.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>Quadratic Residue * Quadratic Residue = Quadratic Residue
</span></span><span class=line><span class=cl>Quadratic Residue * Quadratic Non-residue = Quadratic Non-residue
</span></span><span class=line><span class=cl>Quadratic Non-residue * Quadratic Non-residue = Quadratic Residue
</span></span></code></pre></div><blockquote><p>So what&rsquo;s the trick? The <a href=https://en.wikipedia.org/wiki/Legendre_symbol title="Legendre Symbol" target=_blank rel="nofollow noopener">Legendre Symbol</a> gives an efficient way to determine whether an integer is a quadratic residue modulo an odd prime p.</p><p>Legendre&rsquo;s Symbol: <code>(a / p) ≡ a^(p-1)/2 mod p</code> obeys:</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>(a / p) = 1 if a is a quadratic residue and a ≢ 0 mod p
</span></span><span class=line><span class=cl>(a / p) = -1 if a is a quadratic non-residue mod p
</span></span><span class=line><span class=cl>(a / p) = 0 if a ≡ 0 mod p
</span></span></code></pre></div><blockquote><p>Which means given any integer a, calculating <code>pow(a,(p-1)/2,p)</code> is enough to determine if a is a quadratic residue.</p><p>Now for the flag. Given the following 1024 bit prime and 10 integers, find the quadratic residue and then calculate its square root; the square root is your flag. Of the two possible roots, submit the larger one as your answer.</p><p>Challenge files:</p><ul><li>output.txt</li></ul></blockquote><p><em>file: output.txt</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>p = 101524035174539890485408575671085261788758965189060164484385690801466167356667036677932998889725476582421738788500738738503134356158197247473850273565349249573867251280253564698939768700489401960767007716413932851838937641880157263936985954881657889497583485535527613578457628399173971810541670838543309159139
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ints = [25081841204695904475894082974192007718642931811040324543182130088804239047149283334700530600468528298920930150221871666297194395061462592781551275161695411167049544771049769000895119729307495913024360169904315078028798025169985966732789207320203861858234048872508633514498384390497048416012928086480326832803, 45471765180330439060504647480621449634904192839383897212809808339619841633826534856109999027962620381874878086991125854247108359699799913776917227058286090426484548349388138935504299609200377899052716663351188664096302672712078508601311725863678223874157861163196340391008634419348573975841578359355931590555, 17364140182001694956465593533200623738590196990236340894554145562517924989208719245429557645254953527658049246737589538280332010533027062477684237933221198639948938784244510469138826808187365678322547992099715229218615475923754896960363138890331502811292427146595752813297603265829581292183917027983351121325, 14388109104985808487337749876058284426747816961971581447380608277949200244660381570568531129775053684256071819837294436069133592772543582735985855506250660938574234958754211349215293281645205354069970790155237033436065434572020652955666855773232074749487007626050323967496732359278657193580493324467258802863, 4379499308310772821004090447650785095356643590411706358119239166662089428685562719233435615196994728767593223519226235062647670077854687031681041462632566890129595506430188602238753450337691441293042716909901692570971955078924699306873191983953501093343423248482960643055943413031768521782634679536276233318, 85256449776780591202928235662805033201684571648990042997557084658000067050672130152734911919581661523957075992761662315262685030115255938352540032297113615687815976039390537716707854569980516690246592112936796917504034711418465442893323439490171095447109457355598873230115172636184525449905022174536414781771, 50576597458517451578431293746926099486388286246142012476814190030935689430726042810458344828563913001012415702876199708216875020997112089693759638454900092580746638631062117961876611545851157613835724635005253792316142379239047654392970415343694657580353333217547079551304961116837545648785312490665576832987, 96868738830341112368094632337476840272563704408573054404213766500407517251810212494515862176356916912627172280446141202661640191237336568731069327906100896178776245311689857997012187599140875912026589672629935267844696976980890380730867520071059572350667913710344648377601017758188404474812654737363275994871, 4881261656846638800623549662943393234361061827128610120046315649707078244180313661063004390750821317096754282796876479695558644108492317407662131441224257537276274962372021273583478509416358764706098471849536036184924640593888902859441388472856822541452041181244337124767666161645827145408781917658423571721, 18237936726367556664171427575475596460727369368246286138804284742124256700367133250078608537129877968287885457417957868580553371999414227484737603688992620953200143688061024092623556471053006464123205133894607923801371986027458274343737860395496260538663183193877539815179246700525865152165600985105257601565]
</span></span></code></pre></td></tr></table></div></div><h3 id=solution-6>Solution<a hidden class=anchor aria-hidden=true href=#solution-6>#</a></h3><p><a href=https://en.wikipedia.org/wiki/Tonelli%E2%80%93Shanks_algorithm title="Tonelli–Shanks algorithm" target=_blank rel="nofollow noopener">Tonelli–Shanks algorithm</a>is used to find the square root of <code>n mod p</code>.</p><p><em>Note: Tonelli-Shanks doesn&rsquo;t work for composite (non-prime) moduli. Finding square roots modulo composites is computationally equivalent to integer factorization.</em></p><p>Since <code>p = 3 mod 4</code> is hinted to us, we can conclude:
<img loading=lazy src=images/tonelli.png#center alt=tonelli>
[ <em>image source: <a href=https://medium.com/@pavanipoluru.21.01/cryptohack-mathematics-d0f691fffe4e title=https://medium.com/@pavanipoluru.21.01/cryptohack-mathematics-d0f691fffe4e target=_blank rel="nofollow noopener">https://medium.com/@pavanipoluru.21.01/cryptohack-mathematics-d0f691fffe4e</a></em> ]</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>101524035174539890485408575671085261788758965189060164484385690801466167356667036677932998889725476582421738788500738738503134356158197247473850273565349249573867251280253564698939768700489401960767007716413932851838937641880157263936985954881657889497583485535527613578457628399173971810541670838543309159139</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ints</span> <span class=o>=</span> <span class=p>[</span><span class=mi>25081841204695904475894082974192007718642931811040324543182130088804239047149283334700530600468528298920930150221871666297194395061462592781551275161695411167049544771049769000895119729307495913024360169904315078028798025169985966732789207320203861858234048872508633514498384390497048416012928086480326832803</span><span class=p>,</span> <span class=mi>45471765180330439060504647480621449634904192839383897212809808339619841633826534856109999027962620381874878086991125854247108359699799913776917227058286090426484548349388138935504299609200377899052716663351188664096302672712078508601311725863678223874157861163196340391008634419348573975841578359355931590555</span><span class=p>,</span> <span class=mi>17364140182001694956465593533200623738590196990236340894554145562517924989208719245429557645254953527658049246737589538280332010533027062477684237933221198639948938784244510469138826808187365678322547992099715229218615475923754896960363138890331502811292427146595752813297603265829581292183917027983351121325</span><span class=p>,</span> <span class=mi>14388109104985808487337749876058284426747816961971581447380608277949200244660381570568531129775053684256071819837294436069133592772543582735985855506250660938574234958754211349215293281645205354069970790155237033436065434572020652955666855773232074749487007626050323967496732359278657193580493324467258802863</span><span class=p>,</span> <span class=mi>4379499308310772821004090447650785095356643590411706358119239166662089428685562719233435615196994728767593223519226235062647670077854687031681041462632566890129595506430188602238753450337691441293042716909901692570971955078924699306873191983953501093343423248482960643055943413031768521782634679536276233318</span><span class=p>,</span> <span class=mi>85256449776780591202928235662805033201684571648990042997557084658000067050672130152734911919581661523957075992761662315262685030115255938352540032297113615687815976039390537716707854569980516690246592112936796917504034711418465442893323439490171095447109457355598873230115172636184525449905022174536414781771</span><span class=p>,</span> <span class=mi>50576597458517451578431293746926099486388286246142012476814190030935689430726042810458344828563913001012415702876199708216875020997112089693759638454900092580746638631062117961876611545851157613835724635005253792316142379239047654392970415343694657580353333217547079551304961116837545648785312490665576832987</span><span class=p>,</span> <span class=mi>96868738830341112368094632337476840272563704408573054404213766500407517251810212494515862176356916912627172280446141202661640191237336568731069327906100896178776245311689857997012187599140875912026589672629935267844696976980890380730867520071059572350667913710344648377601017758188404474812654737363275994871</span><span class=p>,</span> <span class=mi>4881261656846638800623549662943393234361061827128610120046315649707078244180313661063004390750821317096754282796876479695558644108492317407662131441224257537276274962372021273583478509416358764706098471849536036184924640593888902859441388472856822541452041181244337124767666161645827145408781917658423571721</span><span class=p>,</span> <span class=mi>18237936726367556664171427575475596460727369368246286138804284742124256700367133250078608537129877968287885457417957868580553371999414227484737603688992620953200143688061024092623556471053006464123205133894607923801371986027458274343737860395496260538663183193877539815179246700525865152165600985105257601565</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>qr</span> <span class=o>=</span> <span class=p>[</span><span class=n>a</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>ints</span> <span class=k>if</span> <span class=nb>pow</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=p>(</span><span class=n>p</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>max</span><span class=p>([</span><span class=nb>pow</span><span class=p>(</span><span class=n>a</span><span class=p>,(</span><span class=n>p</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span><span class=o>//</span><span class=mi>4</span><span class=p>,</span><span class=n>p</span><span class=p>)</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>qr</span><span class=p>]))</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=mi>93291799125366706806545638475797430512104976066103610269938025709952247020061090804870186195285998727680200979853848718589126765742550855954805290253592144209552123062161458584575060939481368210688629862036958857604707468372384278049741369153506182660264876115428251983455344219194133033177700490981696141526</span>
</span></span></code></pre></div><h2 id=modular-square-root>Modular Square Root<a hidden class=anchor aria-hidden=true href=#modular-square-root>#</a></h2><blockquote><p>In Legendre Symbol we introduced a fast way to determine whether a number is a square root modulo a prime. We can go further: there are algorithms for efficiently calculating such roots. The best one in practice is called Tonelli-Shanks, which gets its funny name from the fact that it was first described by an Italian in the 19th century and rediscovered independently by Daniel Shanks in the 1970s.</p><p>All primes that aren&rsquo;t 2 are of the form <code>p ≡ 1 mod 4</code> or <code>p ≡ 3 mod 4</code>, since all odd numbers obey these congruences. As the previous challenge hinted, in the <code>p ≡ 3 mod 4</code> case, a really simple formula for computing square roots can be <a href=https://crypto.stackexchange.com/questions/20993/significance-of-3mod4-in-squares-and-square-roots-mod-n/20994#20994 title=derived target=_blank rel="nofollow noopener">derived</a> directly from Fermat&rsquo;s little theorem. That leaves us still with the <code>p ≡ 1 mod 4</code> case, so a more general algorithm is required.</p><p>In a congruence of the form <code>r2 ≡ a mod p</code>, Tonelli-Shanks calculates <code>r</code>.</p><p>The main use-case for this algorithm is finding elliptic curve co-ordinates. Its operation is somewhat complex so we&rsquo;re not going to discuss the details, however, implementations are easy to find and Sage has one built-in.</p><p>Find the square root of <code>a</code> modulo the 2048-bit prime <code>p</code>. Give the smaller of the two roots as your answer.</p><p>Challenge files:</p><ul><li>output.txt</li></ul></blockquote><p><em>file: output.txt</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>a = 8479994658316772151941616510097127087554541274812435112009425778595495359700244470400642403747058566807127814165396640215844192327900454116257979487432016769329970767046735091249898678088061634796559556704959846424131820416048436501387617211770124292793308079214153179977624440438616958575058361193975686620046439877308339989295604537867493683872778843921771307305602776398786978353866231661453376056771972069776398999013769588936194859344941268223184197231368887060609212875507518936172060702209557124430477137421847130682601666968691651447236917018634902407704797328509461854842432015009878011354022108661461024768
</span></span><span class=line><span class=cl>p = 30531851861994333252675935111487950694414332763909083514133769861350960895076504687261369815735742549428789138300843082086550059082835141454526618160634109969195486322015775943030060449557090064811940139431735209185996454739163555910726493597222646855506445602953689527405362207926990442391705014604777038685880527537489845359101552442292804398472642356609304810680731556542002301547846635101455995732584071355903010856718680732337369128498655255277003643669031694516851390505923416710601212618443109844041514942401969629158975457079026906304328749039997262960301209158175920051890620947063936347307238412281568760161
</span></span></code></pre></td></tr></table></div></div><h3 id=solution-7>Solution<a hidden class=anchor aria-hidden=true href=#solution-7>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sage.all</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=mi>8479994658316772151941616510097127087554541274812435112009425778595495359700244470400642403747058566807127814165396640215844192327900454116257979487432016769329970767046735091249898678088061634796559556704959846424131820416048436501387617211770124292793308079214153179977624440438616958575058361193975686620046439877308339989295604537867493683872778843921771307305602776398786978353866231661453376056771972069776398999013769588936194859344941268223184197231368887060609212875507518936172060702209557124430477137421847130682601666968691651447236917018634902407704797328509461854842432015009878011354022108661461024768</span>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>30531851861994333252675935111487950694414332763909083514133769861350960895076504687261369815735742549428789138300843082086550059082835141454526618160634109969195486322015775943030060449557090064811940139431735209185996454739163555910726493597222646855506445602953689527405362207926990442391705014604777038685880527537489845359101552442292804398472642356609304810680731556542002301547846635101455995732584071355903010856718680732337369128498655255277003643669031694516851390505923416710601212618443109844041514942401969629158975457079026906304328749039997262960301209158175920051890620947063936347307238412281568760161</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>mod</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>p</span><span class=p>)</span><span class=o>.</span><span class=n>sqrt</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=mi>2362339307683048638327773298580489298932137505520500388338271052053734747862351779647314176817953359071871560041125289919247146074907151612762640868199621186559522068338032600991311882224016021222672243139362180461232646732465848840425458257930887856583379600967761738596782877851318489355679822813155123045705285112099448146426755110160002515592418850432103641815811071548456284263507805589445073657565381850521367969675699760755310784623577076440037747681760302434924932113640061738777601194622244192758024180853916244427254065441962557282572849162772740798989647948645207349737457445440405057156897508368531939120</span>
</span></span></code></pre></div><h2 id=chinese-remainder-theorem>Chinese Remainder Theorem<a hidden class=anchor aria-hidden=true href=#chinese-remainder-theorem>#</a></h2><blockquote><p>The Chinese Remainder Theorem gives a unique solution to a set of linear congruences if their moduli are coprime.</p><p>This means, that given a set of arbitrary integers <code>ai</code>, and pairwise coprime integers <code>ni</code>, such that the following linear congruences hold:</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>x ≡ a1 mod n1
</span></span><span class=line><span class=cl>x ≡ a2 mod n2
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>x ≡ an mod nn
</span></span></code></pre></div><blockquote><p>There is a unique solution <code>x ≡ a mod N</code> where <code>N = n1 * n2 * ... * nn</code>.</p><p>In cryptography, we commonly use the Chinese Remainder Theorem to help us reduce a problem of very large integers into a set of several, easier problems.</p><p>Given the following set of linear congruences:</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>x ≡ 2 mod 5
</span></span><span class=line><span class=cl>x ≡ 3 mod 11
</span></span><span class=line><span class=cl>x ≡ 5 mod 17
</span></span></code></pre></div><p>Find the integer a such that <code>x ≡ a mod 935</code></p><h3 id=solution-8>Solution<a hidden class=anchor aria-hidden=true href=#solution-8>#</a></h3><p>Watched <a href="https://www.youtube.com/watch?v=zIFehsBHB8o" title="this video" target=_blank rel="nofollow noopener">this video</a> to understand the process of <code>crt</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sage.all</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>crt</span><span class=p>([</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>5</span><span class=p>],</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span><span class=mi>11</span><span class=p>,</span><span class=mi>17</span><span class=p>]))</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=mi>872</span>
</span></span></code></pre></div><p>Alternate solution(s):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># source: CryptoHack user @Hon</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>Looking at Chinese Remainder Theorem...
</span></span></span><span class=line><span class=cl><span class=s1>Taken
</span></span></span><span class=line><span class=cl><span class=s1>        x = a1 (mod n1)
</span></span></span><span class=line><span class=cl><span class=s1>        x = a2 (mod n2)
</span></span></span><span class=line><span class=cl><span class=s1>        x = a3 (mod n3)
</span></span></span><span class=line><span class=cl><span class=s1>With gcd(n1,n2) = gcd(n1,n3) = gcd(n2,n3) = 1
</span></span></span><span class=line><span class=cl><span class=s1>        -All the n-values are coprime with the others
</span></span></span><span class=line><span class=cl><span class=s1>We have N = n1*n2*n3 and
</span></span></span><span class=line><span class=cl><span class=s1>        N1 = n2*n3
</span></span></span><span class=line><span class=cl><span class=s1>        N2 = n1*n3
</span></span></span><span class=line><span class=cl><span class=s1>        N3 = n1*n2
</span></span></span><span class=line><span class=cl><span class=s1>Summaring, the Ni values are composed multiplying all
</span></span></span><span class=line><span class=cl><span class=s1>the n-values each others, except n at position i
</span></span></span><span class=line><span class=cl><span class=s1>Ending, we call yi the solutions of Ni*yi = 1 (mod ni)
</span></span></span><span class=line><span class=cl><span class=s1>        Ex: N1 * y1 = 1 (mod n1)
</span></span></span><span class=line><span class=cl><span class=s1>Now, we have to find the value of integer a such that:
</span></span></span><span class=line><span class=cl><span class=s1>        x = a (mod N)
</span></span></span><span class=line><span class=cl><span class=s1>Knowing also that:
</span></span></span><span class=line><span class=cl><span class=s1>        x = a1N1y1 + a2N2y2 + a3N3y3 (mod N)
</span></span></span><span class=line><span class=cl><span class=s1>Easy, no?
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># x = 2 mod 5</span>
</span></span><span class=line><span class=cl><span class=c1># x = 3 mod 11</span>
</span></span><span class=line><span class=cl><span class=c1># x = 5 mod 17</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># x = a mod 935</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>length</span> <span class=o>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span><span class=mi>11</span><span class=p>,</span><span class=mi>17</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Ntot</span><span class=o>=</span> <span class=n>n</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=n>n</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=n>n</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>N</span> <span class=o>=</span> <span class=p>[</span> <span class=n>n</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>*</span><span class=n>n</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=p>,</span> <span class=n>n</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=n>n</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=n>n</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=n>n</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=p>[</span><span class=nb>pow</span><span class=p>(</span><span class=n>N</span><span class=p>[</span><span class=n>i</span><span class=p>],</span><span class=n>n</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>-</span><span class=mi>2</span><span class=p>,</span><span class=n>n</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>length</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>mysterious_a</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>length</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>mysterious_a</span> <span class=o>+=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>*</span><span class=n>N</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>*</span><span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>mysterious_a</span> <span class=o>%=</span> <span class=n>Ntot</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>mysterious_a</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=adriens-signs>Adrien&rsquo;s Signs<a hidden class=anchor aria-hidden=true href=#adriens-signs>#</a></h2><blockquote><p>Adrien&rsquo;s been looking at ways to encrypt his messages with the help of symbols and minus signs. Can you find a way to recover the flag?</p><p>Challenge files:</p><ul><li>source.py</li><li>output.txt</li></ul></blockquote><p><em>file: source.py</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>random</span> <span class=kn>import</span> <span class=n>randint</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=mi>288260533169915</span>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>1007621497415251</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>FLAG</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;crypto{????????????????????}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>encrypt_flag</span><span class=p>(</span><span class=n>flag</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ciphertext</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>plaintext</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=nb>bin</span><span class=p>(</span><span class=n>i</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>flag</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=n>plaintext</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>e</span> <span class=o>=</span> <span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>n</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>b</span> <span class=o>==</span> <span class=s1>&#39;1&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>ciphertext</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>n</span> <span class=o>=</span> <span class=o>-</span><span class=n>n</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>            <span class=n>ciphertext</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ciphertext</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>encrypt_flag</span><span class=p>(</span><span class=n>FLAG</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p><em>file: output.txt</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>[67594220461269, 501237540280788, 718316769824518, 296304224247167, 48290626940198, 30829701196032, 521453693392074, 840985324383794, 770420008897119, 745131486581197, 729163531979577, 334563813238599, 289746215495432, 538664937794468, 894085795317163, 983410189487558, 863330928724430, 996272871140947, 352175210511707, 306237700811584, 631393408838583, 589243747914057, 538776819034934, 365364592128161, 454970171810424, 986711310037393, 657756453404881, 388329936724352, 90991447679370, 714742162831112, 62293519842555, 653941126489711, 448552658212336, 970169071154259, 339472870407614, 406225588145372, 205721593331090, 926225022409823, 904451547059845, 789074084078342, 886420071481685, 796827329208633, 433047156347276, 21271315846750, 719248860593631, 534059295222748, 879864647580512, 918055794962142, 635545050939893, 319549343320339, 93008646178282, 926080110625306, 385476640825005, 483740420173050, 866208659796189, 883359067574584, 913405110264883, 898864873510337, 208598541987988, 23412800024088, 911541450703474, 57446699305445, 513296484586451, 180356843554043, 756391301483653, 823695939808936, 452898981558365, 383286682802447, 381394258915860, 385482809649632, 357950424436020, 212891024562585, 906036654538589, 706766032862393, 500658491083279, 134746243085697, 240386541491998, 850341345692155, 826490944132718, 329513332018620, 41046816597282, 396581286424992, 488863267297267, 92023040998362, 529684488438507, 925328511390026, 524897846090435, 413156582909097, 840524616502482, 325719016994120, 402494835113608, 145033960690364, 43932113323388, 683561775499473, 434510534220939, 92584300328516, 763767269974656, 289837041593468, 11468527450938, 628247946152943, 8844724571683, 813851806959975, 72001988637120, 875394575395153, 70667866716476, 75304931994100, 226809172374264, 767059176444181, 45462007920789, 472607315695803, 325973946551448, 64200767729194, 534886246409921, 950408390792175, 492288777130394, 226746605380806, 944479111810431, 776057001143579, 658971626589122, 231918349590349, 699710172246548, 122457405264610, 643115611310737, 999072890586878, 203230862786955, 348112034218733, 240143417330886, 927148962961842, 661569511006072, 190334725550806, 763365444730995, 516228913786395, 846501182194443, 741210200995504, 511935604454925, 687689993302203, 631038090127480, 961606522916414, 138550017953034, 932105540686829, 215285284639233, 772628158955819, 496858298527292, 730971468815108, 896733219370353, 967083685727881, 607660822695530, 650953466617730, 133773994258132, 623283311953090, 436380836970128, 237114930094468, 115451711811481, 674593269112948, 140400921371770, 659335660634071, 536749311958781, 854645598266824, 303305169095255, 91430489108219, 573739385205188, 400604977158702, 728593782212529, 807432219147040, 893541884126828, 183964371201281, 422680633277230, 218817645778789, 313025293025224, 657253930848472, 747562211812373, 83456701182914, 470417289614736, 641146659305859, 468130225316006, 46960547227850, 875638267674897, 662661765336441, 186533085001285, 743250648436106, 451414956181714, 527954145201673, 922589993405001, 242119479617901, 865476357142231, 988987578447349, 430198555146088, 477890180119931, 844464003254807, 503374203275928, 775374254241792, 346653210679737, 789242808338116, 48503976498612, 604300186163323, 475930096252359, 860836853339514, 994513691290102, 591343659366796, 944852018048514, 82396968629164, 152776642436549, 916070996204621, 305574094667054, 981194179562189, 126174175810273, 55636640522694, 44670495393401, 74724541586529, 988608465654705, 870533906709633, 374564052429787, 486493568142979, 469485372072295, 221153171135022, 289713227465073, 952450431038075, 107298466441025, 938262809228861, 253919870663003, 835790485199226, 655456538877798, 595464842927075, 191621819564547]
</span></span></code></pre></td></tr></table></div></div><h3 id=solution-9>Solution<a hidden class=anchor aria-hidden=true href=#solution-9>#</a></h3><p>First hint to the problem is the title: <code>Adrien's Signs</code>. The <code>Legendre symbol</code> was introduced by <a href=https://en.wikipedia.org/wiki/Adrien-Marie_Legendre title="Adrien-Marie Legendre" target=_blank rel="nofollow noopener">Adrien-Marie Legendre</a>, so it would seem wise to use it here. Let&rsquo;s look more into the code to see what&rsquo;s going on.</p><p>Basically, the byte letters of the plaintext flag are each converted to 8 bits (with padding of zeros). These are then joined together to make a large string of bits. For every bit, <code>a**randit(1,p) % p</code> is done to create <code>n</code>. If the bit happens to be <code>1</code>, <code>n</code> is appended to the ciphertext list - otherwise <code>n = -n % p</code> occurs before appending <code>n</code> to the list.</p><p>So, we just need to determine whether the value is a <code>0</code> or <code>1</code> for each bit of information.</p><p>First, we ensure <code>a</code> is indeed prime.</p><p>Then, we check to make sure that <code>(a / p) = 1</code> by the <code>Legendre symbol</code> to prove <code>a</code> is quadratic residue of <code>mod p</code>. Since this is the case, all encrypted values that are also quadratic residues of <code>mod p</code> will leak the value <code>1</code> back to us. In the case of the bit being <code>0</code>, <code>-n mod p = a^e mod p</code> which becomes <code>n = -a^e</code> or <code>(-1/p)</code>:</p><p><img loading=lazy src=images/legendre.png#center alt=legendre>
[ <em>image source: <a href=https://en.wikipedia.org/wiki/Legendre_symbol title=https://en.wikipedia.org/wiki/Legendre_symbol target=_blank rel="nofollow noopener">https://en.wikipedia.org/wiki/Legendre_symbol</a></em> ]</p><p>Therefore, when encrypted values are non-quadratic residue, it is a <code>0</code> bit.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=mi>288260533169915</span>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>1007621497415251</span>
</span></span><span class=line><span class=cl><span class=n>enc</span> <span class=o>=</span> <span class=p>[</span><span class=mi>67594220461269</span><span class=p>,</span> <span class=mi>501237540280788</span><span class=p>,</span> <span class=mi>718316769824518</span><span class=p>,</span> <span class=mi>296304224247167</span><span class=p>,</span> <span class=mi>48290626940198</span><span class=p>,</span> <span class=mi>30829701196032</span><span class=p>,</span> <span class=mi>521453693392074</span><span class=p>,</span> <span class=mi>840985324383794</span><span class=p>,</span> <span class=mi>770420008897119</span><span class=p>,</span> <span class=mi>745131486581197</span><span class=p>,</span> <span class=mi>729163531979577</span><span class=p>,</span> <span class=mi>334563813238599</span><span class=p>,</span> <span class=mi>289746215495432</span><span class=p>,</span> <span class=mi>538664937794468</span><span class=p>,</span> <span class=mi>894085795317163</span><span class=p>,</span> <span class=mi>983410189487558</span><span class=p>,</span> <span class=mi>863330928724430</span><span class=p>,</span> <span class=mi>996272871140947</span><span class=p>,</span> <span class=mi>352175210511707</span><span class=p>,</span> <span class=mi>306237700811584</span><span class=p>,</span> <span class=mi>631393408838583</span><span class=p>,</span> <span class=mi>589243747914057</span><span class=p>,</span> <span class=mi>538776819034934</span><span class=p>,</span> <span class=mi>365364592128161</span><span class=p>,</span> <span class=mi>454970171810424</span><span class=p>,</span> <span class=mi>986711310037393</span><span class=p>,</span> <span class=mi>657756453404881</span><span class=p>,</span> <span class=mi>388329936724352</span><span class=p>,</span> <span class=mi>90991447679370</span><span class=p>,</span> <span class=mi>714742162831112</span><span class=p>,</span> <span class=mi>62293519842555</span><span class=p>,</span> <span class=mi>653941126489711</span><span class=p>,</span> <span class=mi>448552658212336</span><span class=p>,</span> <span class=mi>970169071154259</span><span class=p>,</span> <span class=mi>339472870407614</span><span class=p>,</span> <span class=mi>406225588145372</span><span class=p>,</span> <span class=mi>205721593331090</span><span class=p>,</span> <span class=mi>926225022409823</span><span class=p>,</span> <span class=mi>904451547059845</span><span class=p>,</span> <span class=mi>789074084078342</span><span class=p>,</span> <span class=mi>886420071481685</span><span class=p>,</span> <span class=mi>796827329208633</span><span class=p>,</span> <span class=mi>433047156347276</span><span class=p>,</span> <span class=mi>21271315846750</span><span class=p>,</span> <span class=mi>719248860593631</span><span class=p>,</span> <span class=mi>534059295222748</span><span class=p>,</span> <span class=mi>879864647580512</span><span class=p>,</span> <span class=mi>918055794962142</span><span class=p>,</span> <span class=mi>635545050939893</span><span class=p>,</span> <span class=mi>319549343320339</span><span class=p>,</span> <span class=mi>93008646178282</span><span class=p>,</span> <span class=mi>926080110625306</span><span class=p>,</span> <span class=mi>385476640825005</span><span class=p>,</span> <span class=mi>483740420173050</span><span class=p>,</span> <span class=mi>866208659796189</span><span class=p>,</span> <span class=mi>883359067574584</span><span class=p>,</span> <span class=mi>913405110264883</span><span class=p>,</span> <span class=mi>898864873510337</span><span class=p>,</span> <span class=mi>208598541987988</span><span class=p>,</span> <span class=mi>23412800024088</span><span class=p>,</span> <span class=mi>911541450703474</span><span class=p>,</span> <span class=mi>57446699305445</span><span class=p>,</span> <span class=mi>513296484586451</span><span class=p>,</span> <span class=mi>180356843554043</span><span class=p>,</span> <span class=mi>756391301483653</span><span class=p>,</span> <span class=mi>823695939808936</span><span class=p>,</span> <span class=mi>452898981558365</span><span class=p>,</span> <span class=mi>383286682802447</span><span class=p>,</span> <span class=mi>381394258915860</span><span class=p>,</span> <span class=mi>385482809649632</span><span class=p>,</span> <span class=mi>357950424436020</span><span class=p>,</span> <span class=mi>212891024562585</span><span class=p>,</span> <span class=mi>906036654538589</span><span class=p>,</span> <span class=mi>706766032862393</span><span class=p>,</span> <span class=mi>500658491083279</span><span class=p>,</span> <span class=mi>134746243085697</span><span class=p>,</span> <span class=mi>240386541491998</span><span class=p>,</span> <span class=mi>850341345692155</span><span class=p>,</span> <span class=mi>826490944132718</span><span class=p>,</span> <span class=mi>329513332018620</span><span class=p>,</span> <span class=mi>41046816597282</span><span class=p>,</span> <span class=mi>396581286424992</span><span class=p>,</span> <span class=mi>488863267297267</span><span class=p>,</span> <span class=mi>92023040998362</span><span class=p>,</span> <span class=mi>529684488438507</span><span class=p>,</span> <span class=mi>925328511390026</span><span class=p>,</span> <span class=mi>524897846090435</span><span class=p>,</span> <span class=mi>413156582909097</span><span class=p>,</span> <span class=mi>840524616502482</span><span class=p>,</span> <span class=mi>325719016994120</span><span class=p>,</span> <span class=mi>402494835113608</span><span class=p>,</span> <span class=mi>145033960690364</span><span class=p>,</span> <span class=mi>43932113323388</span><span class=p>,</span> <span class=mi>683561775499473</span><span class=p>,</span> <span class=mi>434510534220939</span><span class=p>,</span> <span class=mi>92584300328516</span><span class=p>,</span> <span class=mi>763767269974656</span><span class=p>,</span> <span class=mi>289837041593468</span><span class=p>,</span> <span class=mi>11468527450938</span><span class=p>,</span> <span class=mi>628247946152943</span><span class=p>,</span> <span class=mi>8844724571683</span><span class=p>,</span> <span class=mi>813851806959975</span><span class=p>,</span> <span class=mi>72001988637120</span><span class=p>,</span> <span class=mi>875394575395153</span><span class=p>,</span> <span class=mi>70667866716476</span><span class=p>,</span> <span class=mi>75304931994100</span><span class=p>,</span> <span class=mi>226809172374264</span><span class=p>,</span> <span class=mi>767059176444181</span><span class=p>,</span> <span class=mi>45462007920789</span><span class=p>,</span> <span class=mi>472607315695803</span><span class=p>,</span> <span class=mi>325973946551448</span><span class=p>,</span> <span class=mi>64200767729194</span><span class=p>,</span> <span class=mi>534886246409921</span><span class=p>,</span> <span class=mi>950408390792175</span><span class=p>,</span> <span class=mi>492288777130394</span><span class=p>,</span> <span class=mi>226746605380806</span><span class=p>,</span> <span class=mi>944479111810431</span><span class=p>,</span> <span class=mi>776057001143579</span><span class=p>,</span> <span class=mi>658971626589122</span><span class=p>,</span> <span class=mi>231918349590349</span><span class=p>,</span> <span class=mi>699710172246548</span><span class=p>,</span> <span class=mi>122457405264610</span><span class=p>,</span> <span class=mi>643115611310737</span><span class=p>,</span> <span class=mi>999072890586878</span><span class=p>,</span> <span class=mi>203230862786955</span><span class=p>,</span> <span class=mi>348112034218733</span><span class=p>,</span> <span class=mi>240143417330886</span><span class=p>,</span> <span class=mi>927148962961842</span><span class=p>,</span> <span class=mi>661569511006072</span><span class=p>,</span> <span class=mi>190334725550806</span><span class=p>,</span> <span class=mi>763365444730995</span><span class=p>,</span> <span class=mi>516228913786395</span><span class=p>,</span> <span class=mi>846501182194443</span><span class=p>,</span> <span class=mi>741210200995504</span><span class=p>,</span> <span class=mi>511935604454925</span><span class=p>,</span> <span class=mi>687689993302203</span><span class=p>,</span> <span class=mi>631038090127480</span><span class=p>,</span> <span class=mi>961606522916414</span><span class=p>,</span> <span class=mi>138550017953034</span><span class=p>,</span> <span class=mi>932105540686829</span><span class=p>,</span> <span class=mi>215285284639233</span><span class=p>,</span> <span class=mi>772628158955819</span><span class=p>,</span> <span class=mi>496858298527292</span><span class=p>,</span> <span class=mi>730971468815108</span><span class=p>,</span> <span class=mi>896733219370353</span><span class=p>,</span> <span class=mi>967083685727881</span><span class=p>,</span> <span class=mi>607660822695530</span><span class=p>,</span> <span class=mi>650953466617730</span><span class=p>,</span> <span class=mi>133773994258132</span><span class=p>,</span> <span class=mi>623283311953090</span><span class=p>,</span> <span class=mi>436380836970128</span><span class=p>,</span> <span class=mi>237114930094468</span><span class=p>,</span> <span class=mi>115451711811481</span><span class=p>,</span> <span class=mi>674593269112948</span><span class=p>,</span> <span class=mi>140400921371770</span><span class=p>,</span> <span class=mi>659335660634071</span><span class=p>,</span> <span class=mi>536749311958781</span><span class=p>,</span> <span class=mi>854645598266824</span><span class=p>,</span> <span class=mi>303305169095255</span><span class=p>,</span> <span class=mi>91430489108219</span><span class=p>,</span> <span class=mi>573739385205188</span><span class=p>,</span> <span class=mi>400604977158702</span><span class=p>,</span> <span class=mi>728593782212529</span><span class=p>,</span> <span class=mi>807432219147040</span><span class=p>,</span> <span class=mi>893541884126828</span><span class=p>,</span> <span class=mi>183964371201281</span><span class=p>,</span> <span class=mi>422680633277230</span><span class=p>,</span> <span class=mi>218817645778789</span><span class=p>,</span> <span class=mi>313025293025224</span><span class=p>,</span> <span class=mi>657253930848472</span><span class=p>,</span> <span class=mi>747562211812373</span><span class=p>,</span> <span class=mi>83456701182914</span><span class=p>,</span> <span class=mi>470417289614736</span><span class=p>,</span> <span class=mi>641146659305859</span><span class=p>,</span> <span class=mi>468130225316006</span><span class=p>,</span> <span class=mi>46960547227850</span><span class=p>,</span> <span class=mi>875638267674897</span><span class=p>,</span> <span class=mi>662661765336441</span><span class=p>,</span> <span class=mi>186533085001285</span><span class=p>,</span> <span class=mi>743250648436106</span><span class=p>,</span> <span class=mi>451414956181714</span><span class=p>,</span> <span class=mi>527954145201673</span><span class=p>,</span> <span class=mi>922589993405001</span><span class=p>,</span> <span class=mi>242119479617901</span><span class=p>,</span> <span class=mi>865476357142231</span><span class=p>,</span> <span class=mi>988987578447349</span><span class=p>,</span> <span class=mi>430198555146088</span><span class=p>,</span> <span class=mi>477890180119931</span><span class=p>,</span> <span class=mi>844464003254807</span><span class=p>,</span> <span class=mi>503374203275928</span><span class=p>,</span> <span class=mi>775374254241792</span><span class=p>,</span> <span class=mi>346653210679737</span><span class=p>,</span> <span class=mi>789242808338116</span><span class=p>,</span> <span class=mi>48503976498612</span><span class=p>,</span> <span class=mi>604300186163323</span><span class=p>,</span> <span class=mi>475930096252359</span><span class=p>,</span> <span class=mi>860836853339514</span><span class=p>,</span> <span class=mi>994513691290102</span><span class=p>,</span> <span class=mi>591343659366796</span><span class=p>,</span> <span class=mi>944852018048514</span><span class=p>,</span> <span class=mi>82396968629164</span><span class=p>,</span> <span class=mi>152776642436549</span><span class=p>,</span> <span class=mi>916070996204621</span><span class=p>,</span> <span class=mi>305574094667054</span><span class=p>,</span> <span class=mi>981194179562189</span><span class=p>,</span> <span class=mi>126174175810273</span><span class=p>,</span> <span class=mi>55636640522694</span><span class=p>,</span> <span class=mi>44670495393401</span><span class=p>,</span> <span class=mi>74724541586529</span><span class=p>,</span> <span class=mi>988608465654705</span><span class=p>,</span> <span class=mi>870533906709633</span><span class=p>,</span> <span class=mi>374564052429787</span><span class=p>,</span> <span class=mi>486493568142979</span><span class=p>,</span> <span class=mi>469485372072295</span><span class=p>,</span> <span class=mi>221153171135022</span><span class=p>,</span> <span class=mi>289713227465073</span><span class=p>,</span> <span class=mi>952450431038075</span><span class=p>,</span> <span class=mi>107298466441025</span><span class=p>,</span> <span class=mi>938262809228861</span><span class=p>,</span> <span class=mi>253919870663003</span><span class=p>,</span> <span class=mi>835790485199226</span><span class=p>,</span> <span class=mi>655456538877798</span><span class=p>,</span> <span class=mi>595464842927075</span><span class=p>,</span> <span class=mi>191621819564547</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check if prime is of the form p ≡ 3 mod 4 (not p ≡ 1 mod 4)</span>
</span></span><span class=line><span class=cl><span class=c1># pow(a, (p-1)//2, p) == kronecker(a,p)</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>kronecker</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pt_bits</span> <span class=o>=</span> <span class=s1>&#39;0b&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>enc</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># pow(x, (p-1)//2, p) == kronecker(x,p)</span>
</span></span><span class=line><span class=cl>    <span class=n>qr</span> <span class=o>=</span> <span class=n>kronecker</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>qr</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>pt_bits</span> <span class=o>+=</span> <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># qr == p-1 =&gt; 1007621497415250</span>
</span></span><span class=line><span class=cl>        <span class=n>pt_bits</span> <span class=o>+=</span> <span class=s1>&#39;0&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pt_int</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>pt_bits</span><span class=p>,</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>pt_int</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=sa>b</span><span class=s1>&#39;crypto</span><span class=si>{p4tterns_1n_re5idu3s}</span><span class=s1>&#39;</span>
</span></span></code></pre></div><h2 id=modular-binomials>Modular Binomials<a hidden class=anchor aria-hidden=true href=#modular-binomials>#</a></h2><blockquote><p>Rearrange the following equations to get the primes p,q</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>N = p*q
</span></span><span class=line><span class=cl>c1 = (2*p + 3*q)**e1 mod N
</span></span><span class=line><span class=cl>c2 = (5*p + 7*q)**e2 mod N
</span></span></code></pre></div><blockquote><p>Challenge files:</p><ul><li>data.txt</li></ul></blockquote><p><em>file: data.txt</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>N = 14905562257842714057932724129575002825405393502650869767115942606408600343380327866258982402447992564988466588305174271674657844352454543958847568190372446723549627752274442789184236490768272313187410077124234699854724907039770193680822495470532218905083459730998003622926152590597710213127952141056029516116785229504645179830037937222022291571738973603920664929150436463632305664687903244972880062028301085749434688159905768052041207513149370212313943117665914802379158613359049957688563885391972151218676545972118494969247440489763431359679770422939441710783575668679693678435669541781490217731619224470152467768073
</span></span><span class=line><span class=cl>e1 = 12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137
</span></span><span class=line><span class=cl>e2 = 12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697
</span></span><span class=line><span class=cl>c1 = 14010729418703228234352465883041270611113735889838753433295478495763409056136734155612156934673988344882629541204985909650433819205298939877837314145082403528055884752079219150739849992921393509593620449489882380176216648401057401569934043087087362272303101549800941212057354903559653373299153430753882035233354304783275982332995766778499425529570008008029401325668301144188970480975565215953953985078281395545902102245755862663621187438677596628109967066418993851632543137353041712721919291521767262678140115188735994447949166616101182806820741928292882642234238450207472914232596747755261325098225968268926580993051
</span></span><span class=line><span class=cl>c2 = 14386997138637978860748278986945098648507142864584111124202580365103793165811666987664851210230009375267398957979494066880296418013345006977654742303441030008490816239306394492168516278328851513359596253775965916326353050138738183351643338294802012193721879700283088378587949921991198231956871429805847767716137817313612304833733918657887480468724409753522369325138502059408241232155633806496752350562284794715321835226991147547651155287812485862794935695241612676255374480132722940682140395725089329445356434489384831036205387293760789976615210310436732813848937666608611803196199865435145094486231635966885932646519
</span></span></code></pre></td></tr></table></div></div><h3 id=solution-10>Solution<a hidden class=anchor aria-hidden=true href=#solution-10>#</a></h3><p>Unintended solution is <a href="http://factordb.com/index.php?query=14905562257842714057932724129575002825405393502650869767115942606408600343380327866258982402447992564988466588305174271674657844352454543958847568190372446723549627752274442789184236490768272313187410077124234699854724907039770193680822495470532218905083459730998003622926152590597710213127952141056029516116785229504645179830037937222022291571738973603920664929150436463632305664687903244972880062028301085749434688159905768052041207513149370212313943117665914802379158613359049957688563885391972151218676545972118494969247440489763431359679770422939441710783575668679693678435669541781490217731619224470152467768073" title=factordb target=_blank rel="nofollow noopener">factordb</a>!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>p = 112274000169258486390262064441991200608556376127408952701514962644340921899196091557519382763356534106376906489445103255177593594898966250176773605432765983897105047795619470659157057093771407309168345670541418772427807148039207489900810013783673957984006269120652134007689272484517805398390277308001719431273
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>q = 132760587806365301971479157072031448380135765794466787456948786731168095877956875295282661565488242190731593282663694728914945967253173047324353981530949360031535707374701705328450856944598803228299967009004598984671293494375599408764139743217465012770376728876547958852025425539298410751132782632817947101601
</span></span></code></pre></div><p>Alternate solution(s):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># source: CryptoHack user @diksown</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fractions</span> <span class=kn>import</span> <span class=n>gcd</span>
</span></span><span class=line><span class=cl><span class=n>N</span> <span class=o>=</span> <span class=mi>14905562257842714057932724129575002825405393502650869767115942606408600343380327866258982402447992564988466588305174271674657844352454543958847568190372446723549627752274442789184236490768272313187410077124234699854724907039770193680822495470532218905083459730998003622926152590597710213127952141056029516116785229504645179830037937222022291571738973603920664929150436463632305664687903244972880062028301085749434688159905768052041207513149370212313943117665914802379158613359049957688563885391972151218676545972118494969247440489763431359679770422939441710783575668679693678435669541781490217731619224470152467768073</span>
</span></span><span class=line><span class=cl><span class=n>e1</span> <span class=o>=</span> <span class=mi>12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137</span>
</span></span><span class=line><span class=cl><span class=n>e2</span> <span class=o>=</span> <span class=mi>12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697</span>
</span></span><span class=line><span class=cl><span class=n>c1</span> <span class=o>=</span> <span class=mi>14010729418703228234352465883041270611113735889838753433295478495763409056136734155612156934673988344882629541204985909650433819205298939877837314145082403528055884752079219150739849992921393509593620449489882380176216648401057401569934043087087362272303101549800941212057354903559653373299153430753882035233354304783275982332995766778499425529570008008029401325668301144188970480975565215953953985078281395545902102245755862663621187438677596628109967066418993851632543137353041712721919291521767262678140115188735994447949166616101182806820741928292882642234238450207472914232596747755261325098225968268926580993051</span>
</span></span><span class=line><span class=cl><span class=n>c2</span> <span class=o>=</span> <span class=mi>14386997138637978860748278986945098648507142864584111124202580365103793165811666987664851210230009375267398957979494066880296418013345006977654742303441030008490816239306394492168516278328851513359596253775965916326353050138738183351643338294802012193721879700283088378587949921991198231956871429805847767716137817313612304833733918657887480468724409753522369325138502059408241232155633806496752350562284794715321835226991147547651155287812485862794935695241612676255374480132722940682140395725089329445356434489384831036205387293760789976615210310436732813848937666608611803196199865435145094486231635966885932646519</span>
</span></span><span class=line><span class=cl><span class=c1>#N = p*q</span>
</span></span><span class=line><span class=cl><span class=c1>#c1 = (2*p + 3*q)**e1 mod /N</span>
</span></span><span class=line><span class=cl><span class=c1>#c2 = (5*p + 7*q)**e2 mod N </span>
</span></span><span class=line><span class=cl><span class=c1>#c1^e2 = (2*p + 3*q)**(e1*e2) mod N</span>
</span></span><span class=line><span class=cl><span class=c1>#c2^e1 = (5*p + 7*q)**(e1*e2) mod N</span>
</span></span><span class=line><span class=cl><span class=c1>#f1 = 5^e1*e2 * c1^e2 = (10*p + 15*q)**(e1*e2) mod N</span>
</span></span><span class=line><span class=cl><span class=c1>#f2 = 2^e1*e2 * c2^e1 = (10*p + 14*q)**(e1*e2) mod N</span>
</span></span><span class=line><span class=cl><span class=c1>#f1 mod q = f2 mod q =&gt; f1-f2 = 0 mod q</span>
</span></span><span class=line><span class=cl><span class=n>f1</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=n>e1</span><span class=o>*</span><span class=n>e2</span><span class=p>,</span> <span class=n>N</span><span class=p>)</span> <span class=o>*</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c1</span><span class=p>,</span> <span class=n>e2</span><span class=p>,</span> <span class=n>N</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>f2</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=n>e1</span><span class=o>*</span><span class=n>e2</span><span class=p>,</span> <span class=n>N</span><span class=p>)</span> <span class=o>*</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c2</span><span class=p>,</span> <span class=n>e1</span><span class=p>,</span> <span class=n>N</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=nb>abs</span><span class=p>(</span><span class=n>gcd</span><span class=p>(</span><span class=n>N</span><span class=p>,</span> <span class=n>f1</span><span class=o>-</span><span class=n>f2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=n>N</span><span class=o>//</span><span class=n>q</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>N</span><span class=p>,</span> <span class=n>p</span><span class=p>,</span> <span class=n>q</span><span class=p>,</span> <span class=n>N</span><span class=o>-</span><span class=n>p</span><span class=o>*</span><span class=n>q</span><span class=p>,</span> <span class=n>sep</span><span class=o>=</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><em>source: CryptoHack user @exp101t</em><figure class=image-caption><img alt=binomials srcset="/posts/cryptohack/modular_arithmetic/images/binomials_huc68504725af611a0b10d4416f9e1618e_62190_480x0_resize_q75_h2_box_3.webp 480w,
/posts/cryptohack/modular_arithmetic/images/binomials_huc68504725af611a0b10d4416f9e1618e_62190_768x0_resize_q75_h2_box_3.webp 768w,
/posts/cryptohack/modular_arithmetic/images/binomials_huc68504725af611a0b10d4416f9e1618e_62190_1024x0_resize_q75_h2_box_3.webp 1024w" sizes="(min-width:480px) 768px, 100vw" src=/posts/cryptohack/modular_arithmetic/images/binomials.png loading=lazy><figcaption></figcaption></figure></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>math</span> <span class=kn>import</span> <span class=n>gcd</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>14905562257842714057932724129575002825405393502650869767115942606408600343380327866258982402447992564988466588305174271674657844352454543958847568190372446723549627752274442789184236490768272313187410077124234699854724907039770193680822495470532218905083459730998003622926152590597710213127952141056029516116785229504645179830037937222022291571738973603920664929150436463632305664687903244972880062028301085749434688159905768052041207513149370212313943117665914802379158613359049957688563885391972151218676545972118494969247440489763431359679770422939441710783575668679693678435669541781490217731619224470152467768073</span>
</span></span><span class=line><span class=cl><span class=n>e1</span> <span class=o>=</span> <span class=mi>12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137</span>
</span></span><span class=line><span class=cl><span class=n>e2</span> <span class=o>=</span> <span class=mi>12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697</span>
</span></span><span class=line><span class=cl><span class=n>c1</span> <span class=o>=</span> <span class=mi>14010729418703228234352465883041270611113735889838753433295478495763409056136734155612156934673988344882629541204985909650433819205298939877837314145082403528055884752079219150739849992921393509593620449489882380176216648401057401569934043087087362272303101549800941212057354903559653373299153430753882035233354304783275982332995766778499425529570008008029401325668301144188970480975565215953953985078281395545902102245755862663621187438677596628109967066418993851632543137353041712721919291521767262678140115188735994447949166616101182806820741928292882642234238450207472914232596747755261325098225968268926580993051</span>
</span></span><span class=line><span class=cl><span class=n>c2</span> <span class=o>=</span> <span class=mi>14386997138637978860748278986945098648507142864584111124202580365103793165811666987664851210230009375267398957979494066880296418013345006977654742303441030008490816239306394492168516278328851513359596253775965916326353050138738183351643338294802012193721879700283088378587949921991198231956871429805847767716137817313612304833733918657887480468724409753522369325138502059408241232155633806496752350562284794715321835226991147547651155287812485862794935695241612676255374480132722940682140395725089329445356434489384831036205387293760789976615210310436732813848937666608611803196199865435145094486231635966885932646519</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>q1</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c1</span><span class=p>,</span> <span class=n>e2</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>q2</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c2</span><span class=p>,</span> <span class=n>e1</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=n>e1</span> <span class=o>*</span> <span class=n>e2</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span> <span class=o>*</span> <span class=n>q1</span> <span class=o>-</span> <span class=nb>pow</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=n>e1</span> <span class=o>*</span> <span class=n>e2</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span> <span class=o>*</span> <span class=n>q2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=n>gcd</span><span class=p>(</span><span class=n>d</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=n>n</span> <span class=o>//</span> <span class=n>q</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>assert</span><span class=p>(</span><span class=n>p</span> <span class=o>*</span> <span class=n>q</span> <span class=o>==</span> <span class=n>n</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://woadey.lol/tags/crypto/>crypto</a></li></ul><nav class=paginav><a class=prev href=https://woadey.lol/posts/htb/startingpoint-tier2/><span class=title>« Prev</span><br><span>HTB: Learn the basics of Penetration Testing - Tier 2</span></a>
<a class=next href=https://woadey.lol/posts/ctf/cryptoverse22/><span class=title>Next »</span><br><span>Cryptoverse CTF 2022</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://woadey.lol/>woadey</a></span>
<span>· Theme: tweaked
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>