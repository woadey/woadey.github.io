<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=Content-Security-Policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self'; form-action 'self'; frame-src 'self'; img-src 'self' data: https://*.google-analytics.com https://*.googletagmanager.com; object-src 'none'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' https://*.googletagmanager.com; prefetch-src 'self'; connect-src 'self' https://*.google-analytics.com https://*.analytics.google.com https://*.googletagmanager.com"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Offensive Security: Interview Prep | woadey</title>
<meta name=keywords content><meta name=description content="Red Team & Pentest Job Interview Preparation"><meta name=author content><link rel=canonical href=https://woadey.xyz/posts/general/interviews/><link crossorigin=anonymous href=/assets/css/stylesheet.1e29e54d58ab90b3a17e16bb686f83913075cda65bf7dd9d85dd20d1a57e1f46.css integrity="sha256-HinlTVirkLOhfha7aG+DkTB1zaZb992dhd0g0aV+H0Y=" rel="preload stylesheet" as=style><link rel=icon href=https://woadey.xyz/favicon/pink_trans_bg/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://woadey.xyz/favicon/pink_trans_bg/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://woadey.xyz/favicon/pink_trans_bg/favicon-32x32.png><link rel=apple-touch-icon href=https://woadey.xyz/favicon/white_pink_bg/apple-touch-icon.png><link rel=mask-icon href=https://woadey.xyz/favicon/pink_trans_bg/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://woadey.xyz/posts/general/interviews/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9703667233476494" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-EF924K1NXR"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EF924K1NXR")}</script><meta property="og:title" content="Offensive Security: Interview Prep"><meta property="og:description" content="Red Team & Pentest Job Interview Preparation"><meta property="og:type" content="article"><meta property="og:url" content="https://woadey.xyz/posts/general/interviews/"><meta property="og:image" content="https://woadey.xyz/favicon/white_pink_bg/apple-touch-icon.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-04-12T19:05:07-04:00"><meta property="article:modified_time" content="2024-04-12T19:05:07-04:00"><meta property="og:site_name" content="woadey's blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://woadey.xyz/favicon/white_pink_bg/apple-touch-icon.png"><meta name=twitter:title content="Offensive Security: Interview Prep"><meta name=twitter:description content="Red Team & Pentest Job Interview Preparation"><meta name=twitter:site content="@woadey_"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"posts","item":"https://woadey.xyz/posts/"},{"@type":"ListItem","position":2,"name":"Offensive Security: Interview Prep","item":"https://woadey.xyz/posts/general/interviews/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Offensive Security: Interview Prep","name":"Offensive Security: Interview Prep","description":"Red Team \u0026 Pentest Job Interview Preparation","keywords":[],"articleBody":"I have been exploring transitioning to a more technical and hands on role in the Offensive Security field (broad, I know). This naturally requires some interviews. Rather than keeping this to my self, I figured I would publish my review and document my efforts.\nSome of this is a review of basic concepts that I am already familiar with, but there are also areas within the fundamentals that I have missed or just haven’t learned about to the full depth.\nNote: this is more for me than anything else - a majority of this content is catering towards Red Team and Pentesting roles that I have been looking at, but obviously certain topics can be applied to other jobs you maybe looking for.\nMajor Topics Hacker Types (Hats) Black: malicious White: ethical Grey: not malicious, not ethical Green: new, unskilled Blue: vengeful Red: vigilante (A Few) Hacker Roles Pentetration tester Goal: find vulnerabilities in specified time and subset of assests Scope: scoped to system or applications Timeline: a few days to a few weeks Types: Internal: Identify vulnerabilities in an organization’s systems External: Identify vulnerabilities that could be exploited from the outside Cost: generally cheaper than red team due to less time spent Red teamer Goal: test the effectiveness of an organizations defensive strategies Scope: specific objective (exfiltrate financial information) Timeline: 3-4 weeks or longer Types: Internal: focus on the internal network and systems External: focus on the exteral attack surface Hybrid: A combination of the two Cost: generally pricey in comparison to pentest due to time OWASP Top 10 (2021) A01:2021-Broken Access Control moves up from the fifth position; 94% of applications were tested for some form of broken access control. The 34 Common Weakness Enumerations (CWEs) mapped to Broken Access Control had more occurrences in applications than any other category. A02:2021-Cryptographic Failures shifts up one position to #2, previously known as Sensitive Data Exposure, which was broad symptom rather than a root cause. The renewed focus here is on failures related to cryptography which often leads to sensitive data exposure or system compromise. A03:2021-Injection slides down to the third position. 94% of the applications were tested for some form of injection, and the 33 CWEs mapped into this category have the second most occurrences in applications. Cross-site Scripting is now part of this category in this edition. A04:2021-Insecure Design is a new category for 2021, with a focus on risks related to design flaws. If we genuinely want to “move left” as an industry, it calls for more use of threat modeling, secure design patterns and principles, and reference architectures. A05:2021-Security Misconfiguration moves up from #6 in the previous edition; 90% of applications were tested for some form of misconfiguration. With more shifts into highly configurable software, it’s not surprising to see this category move up. The former category for XML External Entities (XXE) is now part of this category. A06:2021-Vulnerable and Outdated Components was previously titled Using Components with Known Vulnerabilities and is #2 in the Top 10 community survey, but also had enough data to make the Top 10 via data analysis. This category moves up from #9 in 2017 and is a known issue that we struggle to test and assess risk. It is the only category not to have any Common Vulnerability and Exposures (CVEs) mapped to the included CWEs, so a default exploit and impact weights of 5.0 are factored into their scores. A07:2021-Identification and Authentication Failures was previously Broken Authentication and is sliding down from the second position, and now includes CWEs that are more related to identification failures. This category is still an integral part of the Top 10, but the increased availability of standardized frameworks seems to be helping. A08:2021-Software and Data Integrity Failures is a new category for 2021, focusing on making assumptions related to software updates, critical data, and CI/CD pipelines without verifying integrity. One of the highest weighted impacts from Common Vulnerability and Exposures/Common Vulnerability Scoring System (CVE/CVSS) data mapped to the 10 CWEs in this category. Insecure Deserialization from 2017 is now a part of this larger category. A09:2021-Security Logging and Monitoring Failures was previously Insufficient Logging \u0026 Monitoring and is added from the industry survey (#3), moving up from #10 previously. This category is expanded to include more types of failures, is challenging to test for, and isn’t well represented in the CVE/CVSS data. However, failures in this category can directly impact visibility, incident alerting, and forensics. A10:2021-Server-Side Request Forgery is added from the Top 10 community survey (#1). The data shows a relatively low incidence rate with above average testing coverage, along with above-average ratings for Exploit and Impact potential. This category represents the scenario where the security community members are telling us this is important, even though it’s not illustrated in the data at this time. OSI Model Application Presentation Session Transport Network Data Link Physical TCP/IP Model Application OSI Equivalent: Application + Presentation + Session Transport OSI Equivalent: Transport Network OSI Equivalent: Network Network Interface OSI Equivalent: Data Link + Physical Application Layer Presentation Layer Session Layer Transport Layer Transmission Control Protocol (TCP) Connection oriented protocol: establishes a connection between sender and receiver befre transfer 3-way handshake: SYN, SYN-ACK, ACK stays in effect until timeout or reset by client or server Data is sent from source to destination Data integrity is ensured using ackowledgements and retransmissions Data is transfered in an order Checksums are used to verify the integrity of data transmitted Flow control: ensures data is sent at the most efficient rate from sender to receiver Congestion control: uses mechanisms and algorithms to achieve a high flow rate of data and avoid congestion [image source ] User Datagram Protocol (UDP) Connectionlesss communication protocol Only cares about sending the segments Network Layer Data Link Layer Physical Layer Common Questions Commands What is the command-line option to set the source port for a nmap scan?\n-g/–source-port : Use given port number -S : Spoof source address What does netstat show?\nTL;DR: Protocol | Local Address:Port | Foreign Address:Port | State | PID Displays information regarding traffic on the configured network interfaces The address of any protocol control blocks associated with the sockets and the state of all sockets The number of packets received, transmitted, and dropped in the communications subsystem Cumulative statistics per interfaces Routes and their status Source: IBM Docs What Windows / Linux commands can be used to show IP address information?\nWindows: ipconfig (cmd) netsh interface ip show addresses (cmd) Get-NetIPConfiguration (powershell) Linux: ifconfig ip addr hostname -I Networking Questions What is OSPF?\nShort for Open Shortest Path First Interior Gateway Protocol (IGP) for routing Internet Protocol (IP) packets within a single routing domain Intended to help routers find the best/fastest path for data to travel Wiki: OSPF What is BGP?\nShort for Border Gateway Protocol Routing protocol used to exchange routing information between different networks on the Internet Connects different networks (often run by ISPs) and decides the best path for data to travel Wifi: BGP What protocol is used to convert MAC addresses to IP addresses?\nAddress Resolution Protocol (ARP) Discover data link layer (Layer 2) addresses and converts to network layer (Layer 3) addresses Wiki: Address Resolution Protocol Windows Questions What is UAC (User Account Control), and how does it work?\nUser Account Control (UAC) is a security feature in Windows that helps prevent unauthorized changes to the operating system. When an action requires administrative privileges, UAC prompts the user to confirm the action or enter an administrator password, depending on the user’s account type. This helps protect the system from potentially harmful changes, such as the installation of malicious software, by ensuring that administrative tasks are not performed without explicit user consent. Source: Microsoft User Account Control What is Windows Telemtry?\nA Windows service that allows Microsoft to gather data from a device and transmit it to Microsoft: Device specifications and health App usage and performance Error reports and crash dumps Feedback and ratings Browser history and search queries Location and activity history Advertising ID and interests Source: GeeksForGeeks How can you view Windows logs?\nEvent Viewer (GUI) Application: Logs related to applications and programs. Security: Logs related to security events, such as logins. System: Logs related to Windows system components. Setup: Logs related to the installation and setup of Windows. Forwarded Events: Logs forwarded from other computers. Get-WinEvent -LogName System -MaxEvents 10 From a pcap, what are some ways to identify it is a Windows machine?\nNetBIOS Name Service (NBNS) Traffic: Windows machines often use NetBIOS over TCP/IP for name resolution and service announcements. Look for NBNS queries or responses on UDP port 137. The machine name in NBNS traffic can indicate a Windows system. SMB/CIFS Traffic: Windows systems commonly use SMB (Server Message Block) for file and printer sharing. Look for traffic on: TCP port 445 (SMB over TCP) TCP port 139 (NetBIOS Session Service) The presence of SMB traffic, especially with “Windows” in the SMB header, is a strong indicator. Windows Update or WSUS Traffic: Windows machines regularly connect to Windows Update servers or a local WSUS for updates. Look for HTTP/HTTPS traffic to domains like: update.microsoft.com windowsupdate.microsoft.com DNS Queries Specific to Windows: Windows systems may query DNS for specific Microsoft domains. Look for DNS queries to domains like: microsoft.com windows.com msftncsi.com (Network Connectivity Status Indicator) msftconnecttest.com Kerberos and LDAP Traffic: Kerberos traffic for authentication (typically on UDP/TCP port 88). LDAP traffic on: TCP port 389 (standard LDAP) TCP port 636 (LDAP over SSL) Common for domain-joined Windows machines. HTTP User-Agent Strings: Look for HTTP traffic and examine the User-Agent strings in the headers. Windows systems typically include “Windows” in the User-Agent string. Example: \"Mozilla/5.0 (Windows NT 10.0; Win64; x64)\". ICMP Echo Request (Ping) Patterns: Windows machines send ICMP Echo Requests (pings) with a specific TTL (Time to Live) value. The initial TTL value in Windows is often 128. The default payload size for pings from Windows systems is typically 32 bytes. DHCP Client Identifiers: When a Windows machine requests an IP address via DHCP, it may send a client identifier that includes a MAC address or a string indicating the system is Windows. Check DHCP Option 55 (Parameter Request List) and Option 60 (Vendor Class Identifier) for Windows-specific values. Microsoft-Specific Protocols: Windows machines use protocols unique to Windows environments: RDP (Remote Desktop Protocol) on TCP port 3389 WS-Discovery on UDP port 3702 Presence of these protocols suggests a Windows system. Windows Time Service (W32Time): If the machine is synchronized with a time server, it may use the Windows Time Service. Look for NTP (Network Time Protocol) traffic where the client might identify itself as a Windows machine. Linux Questions What is dmesg?\nShort for Diagnostic Messages Prints / Controls the kernel ring buffer (a circular buffer used for keeping the log messages of the kernel and kernel modules) Source: dmesg man page What is the difference between /bin and /sbin\n/bin : For binaries usable before the /usr partition is mounted. This is used for trivial binaries used in the very early boot stage or ones that you need to have available in booting single-user mode. Think of binaries like cat, ls, etc. /sbin : Same, but for binaries with superuser (root) privileges required. /usr/bin : Same as first, but for general system-wide binaries. /usr/sbin : Same as above, but for binaries with superuser (root) privileges required. Source: Differences between… More detail with Filesystem Hierarchy Standard (FHS) What command can you use to find files?\nfind /path/to/search -name \"*pattern*\"\nSource: find man page\nWhat is the command to show services?\nsystemctl - Control the systemd system and service manager\nsystemctl list-unit lists all units (services, sockets, timers) which are loaded into memory by systemd\nsystemctl --type=service --state=running to specifically show running services\nSource: systemctl man page\nAttack Questions What is the difference between Reflected XSS, Stored XSS and DOM XSS?\nReflected XSS: where the malicious script comes from the current HTTP request. Stored XSS: where the malicious script comes from the website’s database. DOM-based XSS: where the vulnerability exists in client-side code rather than server-side code. What is Kerberoasting?\nTargets Service Principal Name accounts, specifically the NTLM hash which is used to encrypt TGS-REP All thats needed is cleartext password or NTLM hash of user, shell in context of domain user account, or SYSTEM level access on a domain-joined host YT:Hacksplained “Pentest Interview Questions” General Questions What is the last pentest tool you used, improved, suite?\nWhere do you find new vulnerability research?\nWho is your hacking idol?\nWhat is your latest writeup?\nWhere do you have room to improve in?\nJunior Level What is XSS?\nWhat is SQL Injection? When an attacker is able to insert a malicious SQL payload within a website field in order to interact with the SQL database. This is due to improper (or lack there of) sanatization of client-side input. Often times this involves having a query that will always be true, such as 1=1 --. HackTricks has quite a few paylaods and descriptions to help.\nWhat is an Open Redirect (Vulnerability)? Open redirects are when a web application allows users to redirect/forward to another URL. Open redirect vulnerabilites can lead to phishing attacks, XSS attacks, SSRF attacks, CSP bypassing, etc.\nWhich cookie security flags exist?\nDifference between Pentest / Vulnerability test?\nDifference between Black/White/Gray box?\nWhat pentest types/techniques exist?\nWhich file upload restrictions are common in web applications?\nSenior Level Content of a good pentest report?\nHow do you detect a CSRF attack?\nHow does XXE payload work?\nWhat is a boolean blind SQLi?\nExplain different HTTP methods, what they are used for, and how to be exploited?\nWhat is a salt?\nDifference between attack web app and api?\nLast found business logic vulnerability?\nPrincipal Level What is a threat model and how can this be useful?\nBenefits of bug bounty vs pentest?\nHow to measure pentest results?\nExplain details of HTTP DSync attack\nHow does deserialization work?\nWhat are common auth standards and how can you attack them?\nCan SSTI lead to RCE?\nWhat was your last RCE vulnerability?\n","wordCount":"2345","inLanguage":"en","image":"https://woadey.xyz/favicon/white_pink_bg/apple-touch-icon.png","datePublished":"2024-04-12T19:05:07-04:00","dateModified":"2024-04-12T19:05:07-04:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://woadey.xyz/posts/general/interviews/"},"publisher":{"@type":"Organization","name":"woadey","logo":{"@type":"ImageObject","url":"https://woadey.xyz/favicon/pink_trans_bg/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://woadey.xyz/ accesskey=h title="oadey (Alt + H)"><img src=/images/pink.jpeg srcset="/images/pink_hu17913946300421030964.webp 32w, /images/pink_hu18268070055743548763.webp 120w" sizes=32px height=32 width=32 alt=logo aria-label=logo>
oadey</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://woadey.xyz/posts/ title=posts><span>posts</span></a></li><li><a href=https://woadey.xyz/categories/ title=categories><span>categories</span></a></li><li><a href=https://woadey.xyz/tags/ title=tags><span>tags</span></a></li><li><a href=https://woadey.xyz/archives/ title=archives><span>archives</span></a></li><li><a href=https://woadey.xyz/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://woadey.xyz/>home</a>&nbsp;»&nbsp;<a href=https://woadey.xyz/posts/>posts</a></div><h1 class="post-title entry-hint-parent">Offensive Security: Interview Prep</h1><div class=post-description>Red Team & Pentest Job Interview Preparation</div><div class=post-meta><span title='2024-04-12 19:05:07 -0400 -0400'>April 12, 2024</span>&nbsp;·&nbsp;12 min</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#major-topics>Major Topics</a><ul><li><a href=#hacker-types-hats>Hacker Types (Hats)</a></li><li><a href=#a-few-hacker-roles>(A Few) Hacker Roles</a></li><li><a href=#owasp-top-10-2021httpsowasporgwww-project-top-ten><a href=https://owasp.org/www-project-top-ten/>OWASP Top 10 (2021)</a></a></li><li><a href=#osi-model>OSI Model</a></li><li><a href=#tcpip-model>TCP/IP Model</a></li><li><a href=#application-layer>Application Layer</a></li><li><a href=#presentation-layer>Presentation Layer</a></li><li><a href=#session-layer>Session Layer</a></li><li><a href=#transport-layer>Transport Layer</a></li><li><a href=#network-layer>Network Layer</a></li><li><a href=#data-link-layer>Data Link Layer</a></li><li><a href=#physical-layer>Physical Layer</a></li></ul></li><li><a href=#common-questions>Common Questions</a><ul><li><a href=#commands>Commands</a></li><li><a href=#networking-questions>Networking Questions</a></li><li><a href=#windows-questions>Windows Questions</a></li><li><a href=#linux-questions>Linux Questions</a></li><li><a href=#attack-questions>Attack Questions</a></li><li><a href=#ythacksplained-pentest-interview-questionshttpswwwyoutubecomwatchvcr-dj6eueiy>YT:Hacksplained &ldquo;<a href="https://www.youtube.com/watch?v=cR-Dj6eueiY">Pentest Interview Questions</a>&rdquo;</a></li></ul></li></ul></nav></div></details></div><div class=post-content><p><em>I have been exploring transitioning to a more technical and hands on role in the Offensive Security field (broad, I know). This naturally requires some interviews. Rather than keeping this to my self, I figured I would publish my review and document my efforts.</em></p><p><em>Some of this is a review of basic concepts that I am already familiar with, but there are also areas within the fundamentals that I have missed or just haven&rsquo;t learned about to the full depth.</em></p><p><strong>Note: this is more for me than anything else - a majority of this content is catering towards Red Team and Pentesting roles that I have been looking at, but obviously certain topics can be applied to other jobs you maybe looking for.</strong></p><h2 id=major-topics>Major Topics<a hidden class=anchor aria-hidden=true href=#major-topics>#</a></h2><h3 id=hacker-types-hats>Hacker Types (Hats)<a hidden class=anchor aria-hidden=true href=#hacker-types-hats>#</a></h3><ul><li>Black: malicious</li><li>White: ethical</li><li>Grey: not malicious, not ethical</li><li>Green: new, unskilled</li><li>Blue: vengeful</li><li>Red: vigilante</li></ul><h3 id=a-few-hacker-roles>(A Few) Hacker Roles<a hidden class=anchor aria-hidden=true href=#a-few-hacker-roles>#</a></h3><h4 id=pentetration-tester>Pentetration tester<a hidden class=anchor aria-hidden=true href=#pentetration-tester>#</a></h4><ul><li>Goal: find vulnerabilities in specified time and subset of assests</li><li>Scope: scoped to system or applications</li><li>Timeline: a few days to a few weeks</li><li>Types:<ul><li>Internal: Identify vulnerabilities in an organization&rsquo;s systems</li><li>External: Identify vulnerabilities that could be exploited from the outside</li></ul></li><li>Cost: generally cheaper than red team due to less time spent</li></ul><h4 id=red-teamer>Red teamer<a hidden class=anchor aria-hidden=true href=#red-teamer>#</a></h4><ul><li>Goal: test the effectiveness of an organizations defensive strategies</li><li>Scope: specific objective (exfiltrate financial information)</li><li>Timeline: 3-4 weeks or longer</li><li>Types:<ul><li>Internal: focus on the internal network and systems</li><li>External: focus on the exteral attack surface</li><li>Hybrid: A combination of the two</li></ul></li><li>Cost: generally pricey in comparison to pentest due to time</li></ul><h3 id=owasp-top-10-2021httpsowasporgwww-project-top-ten><a href=https://owasp.org/www-project-top-ten/ title="OWASP Top 10 (2021)" target=_blank rel="nofollow noopener">OWASP Top 10 (2021)</a></h3><ul><li><a href=https://owasp.org/Top10/A01_2021-Broken_Access_Control/ title="A01:2021-Broken Access Control" target=_blank rel="nofollow noopener">A01:2021-Broken Access Control</a> moves up from the fifth position; 94% of applications were tested for some form of broken access control. The 34 Common Weakness Enumerations (CWEs) mapped to Broken Access Control had more occurrences in applications than any other category.</li><li><a href=https://owasp.org/Top10/A02_2021-Cryptographic_Failures/ title="A02:2021-Cryptographic Failures" target=_blank rel="nofollow noopener">A02:2021-Cryptographic Failures</a> shifts up one position to #2, previously known as Sensitive Data Exposure, which was broad symptom rather than a root cause. The renewed focus here is on failures related to cryptography which often leads to sensitive data exposure or system compromise.</li><li><a href=https://owasp.org/Top10/A03_2021-Injection/ title=A03:2021-Injection target=_blank rel="nofollow noopener">A03:2021-Injection</a> slides down to the third position. 94% of the applications were tested for some form of injection, and the 33 CWEs mapped into this category have the second most occurrences in applications. Cross-site Scripting is now part of this category in this edition.</li><li><a href=https://owasp.org/Top10/A04_2021-Insecure_Design/ title="A04:2021-Insecure Design" target=_blank rel="nofollow noopener">A04:2021-Insecure Design</a> is a new category for 2021, with a focus on risks related to design flaws. If we genuinely want to “move left” as an industry, it calls for more use of threat modeling, secure design patterns and principles, and reference architectures.</li><li><a href=https://owasp.org/Top10/A05_2021-Security_Misconfiguration/ title="A05:2021-Security Misconfiguration" target=_blank rel="nofollow noopener">A05:2021-Security Misconfiguration</a> moves up from #6 in the previous edition; 90% of applications were tested for some form of misconfiguration. With more shifts into highly configurable software, it’s not surprising to see this category move up. The former category for XML External Entities (XXE) is now part of this category.</li><li><a href=https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/ title="A06:2021-Vulnerable and Outdated Components" target=_blank rel="nofollow noopener">A06:2021-Vulnerable and Outdated Components</a> was previously titled Using Components with Known Vulnerabilities and is #2 in the Top 10 community survey, but also had enough data to make the Top 10 via data analysis. This category moves up from #9 in 2017 and is a known issue that we struggle to test and assess risk. It is the only category not to have any Common Vulnerability and Exposures (CVEs) mapped to the included CWEs, so a default exploit and impact weights of 5.0 are factored into their scores.</li><li><a href=https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/ title="A07:2021-Identification and Authentication Failures" target=_blank rel="nofollow noopener">A07:2021-Identification and Authentication Failures</a> was previously Broken Authentication and is sliding down from the second position, and now includes CWEs that are more related to identification failures. This category is still an integral part of the Top 10, but the increased availability of standardized frameworks seems to be helping.</li><li><a href=https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/ title="A08:2021-Software and Data Integrity Failures" target=_blank rel="nofollow noopener">A08:2021-Software and Data Integrity Failures</a> is a new category for 2021, focusing on making assumptions related to software updates, critical data, and CI/CD pipelines without verifying integrity. One of the highest weighted impacts from Common Vulnerability and Exposures/Common Vulnerability Scoring System (CVE/CVSS) data mapped to the 10 CWEs in this category. Insecure Deserialization from 2017 is now a part of this larger category.</li><li><a href=https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/ title="A09:2021-Security Logging and Monitoring Failures" target=_blank rel="nofollow noopener">A09:2021-Security Logging and Monitoring Failures</a> was previously Insufficient Logging & Monitoring and is added from the industry survey (#3), moving up from #10 previously. This category is expanded to include more types of failures, is challenging to test for, and isn’t well represented in the CVE/CVSS data. However, failures in this category can directly impact visibility, incident alerting, and forensics.</li><li><a href=https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/ title="A10:2021-Server-Side Request Forgery" target=_blank rel="nofollow noopener">A10:2021-Server-Side Request Forgery</a> is added from the Top 10 community survey (#1). The data shows a relatively low incidence rate with above average testing coverage, along with above-average ratings for Exploit and Impact potential. This category represents the scenario where the security community members are telling us this is important, even though it’s not illustrated in the data at this time.</li></ul><h3 id=osi-model>OSI Model<a hidden class=anchor aria-hidden=true href=#osi-model>#</a></h3><ul><li><a href=#application-layer title=Application>Application</a></li><li><a href=#presentation-layer title=Presentation>Presentation</a></li><li><a href=#session-layer title=Session>Session</a></li><li><a href=#transport-layer title=Transport>Transport</a></li><li><a href=#network-layer title=Network>Network</a></li><li><a href=#data-link-layer title="Data Link">Data Link</a></li><li><a href=#physical-layer title=Physical>Physical</a></li></ul><h3 id=tcpip-model>TCP/IP Model<a hidden class=anchor aria-hidden=true href=#tcpip-model>#</a></h3><ul><li>Application<ul><li>OSI Equivalent: Application + Presentation + Session</li></ul></li><li>Transport<ul><li>OSI Equivalent: Transport</li></ul></li><li>Network<ul><li>OSI Equivalent: Network</li></ul></li><li>Network Interface<ul><li>OSI Equivalent: Data Link + Physical</li></ul></li></ul><h3 id=application-layer>Application Layer<a hidden class=anchor aria-hidden=true href=#application-layer>#</a></h3><h3 id=presentation-layer>Presentation Layer<a hidden class=anchor aria-hidden=true href=#presentation-layer>#</a></h3><h3 id=session-layer>Session Layer<a hidden class=anchor aria-hidden=true href=#session-layer>#</a></h3><h3 id=transport-layer>Transport Layer<a hidden class=anchor aria-hidden=true href=#transport-layer>#</a></h3><h4 id=transmission-control-protocol-tcp>Transmission Control Protocol (TCP)<a hidden class=anchor aria-hidden=true href=#transmission-control-protocol-tcp>#</a></h4><ul><li>Connection oriented protocol: establishes a connection between sender and receiver befre transfer<ul><li>3-way handshake: SYN, SYN-ACK, ACK stays in effect until timeout or reset by client or server</li></ul></li><li>Data is sent from source to destination</li><li>Data integrity is ensured using ackowledgements and retransmissions</li><li>Data is transfered in an order</li><li>Checksums are used to verify the integrity of data transmitted</li><li>Flow control: ensures data is sent at the most efficient rate from sender to receiver</li><li>Congestion control: uses mechanisms and algorithms to achieve a high flow rate of data and avoid congestion</li></ul><p><figure class=image-caption><img alt="TCP Header" srcset="/posts/general/interviews/images/tcp-header.i_hu1677836683820584616.webp 480w,
/posts/general/interviews/images/tcp-header.i_hu12082579564413922719.webp 768w,
/posts/general/interviews/images/tcp-header.i_hu9171256770761926619.webp 1024w" sizes=100vw src=images/tcp-header.i.jpg#center width=768 height=512 loading=lazy style=filter:var(--invert-img)><figcaption>[<a href=https://www.lifewire.com/tcp-headers-and-udp-headers-explained-817970 title="image source" target=_blank rel="nofollow noopener"><em>image source</em></a> ]</figcaption></figure></p><h4 id=user-datagram-protocol-udp>User Datagram Protocol (UDP)<a hidden class=anchor aria-hidden=true href=#user-datagram-protocol-udp>#</a></h4><ul><li>Connectionlesss communication protocol</li><li>Only cares about sending the segments</li></ul><h3 id=network-layer>Network Layer<a hidden class=anchor aria-hidden=true href=#network-layer>#</a></h3><h3 id=data-link-layer>Data Link Layer<a hidden class=anchor aria-hidden=true href=#data-link-layer>#</a></h3><h3 id=physical-layer>Physical Layer<a hidden class=anchor aria-hidden=true href=#physical-layer>#</a></h3><hr><h2 id=common-questions>Common Questions<a hidden class=anchor aria-hidden=true href=#common-questions>#</a></h2><h3 id=commands>Commands<a hidden class=anchor aria-hidden=true href=#commands>#</a></h3><p><strong>What is the command-line option to set the source port for a nmap scan?</strong></p><ul><li>-g/&ndash;source-port : Use given port number</li><li>-S &lt;IP_Address>: Spoof source address</li></ul><p><strong>What does <code>netstat</code> show?</strong></p><ul><li>TL;DR: Protocol | Local Address:Port | Foreign Address:Port | State | PID</li><li>Displays information regarding traffic on the configured network interfaces<ul><li>The address of any protocol control blocks associated with the sockets and the state of all sockets</li><li>The number of packets received, transmitted, and dropped in the communications subsystem</li><li>Cumulative statistics per interfaces</li><li>Routes and their status</li></ul></li><li>Source: <a href="https://www.ibm.com/docs/en/aix/7.1?topic=analysis-netstat-command" title="IBM Docs" target=_blank rel="nofollow noopener">IBM Docs</a></li></ul><p><strong>What Windows / Linux commands can be used to show IP address information?</strong></p><ul><li>Windows:<ul><li><code>ipconfig</code> (cmd)</li><li><code>netsh interface ip show addresses</code> (cmd)</li><li><code>Get-NetIPConfiguration</code> (powershell)</li></ul></li><li>Linux:<ul><li><code>ifconfig</code></li><li><code>ip addr</code></li><li><code>hostname -I</code></li></ul></li></ul><h3 id=networking-questions>Networking Questions<a hidden class=anchor aria-hidden=true href=#networking-questions>#</a></h3><p><strong>What is <code>OSPF</code>?</strong></p><ul><li>Short for <strong>Open Shortest Path First</strong></li><li>Interior Gateway Protocol (IGP) for routing Internet Protocol (IP) packets within a single routing domain</li><li>Intended to help routers find the best/fastest path for data to travel</li><li>Wiki: <a href="https://en.wikipedia.org/wiki/Open_Shortest_Path_First#:~:text=OSPF%20is%20an%20interior%20gateway,topology%20map%20of%20the%20network." title=OSPF target=_blank rel="nofollow noopener">OSPF</a></li></ul><p><strong>What is <code>BGP</code>?</strong></p><ul><li>Short for <strong>Border Gateway Protocol</strong></li><li>Routing protocol used to exchange routing information between different networks on the Internet</li><li>Connects different networks (often run by ISPs) and decides the best path for data to travel</li><li>Wifi: <a href=https://en.wikipedia.org/wiki/Border_Gateway_Protocol title=BGP target=_blank rel="nofollow noopener">BGP</a></li></ul><p><strong>What protocol is used to convert MAC addresses to IP addresses?</strong></p><ul><li>Address Resolution Protocol (ARP)</li><li>Discover data link layer (Layer 2) addresses and converts to network layer (Layer 3) addresses</li><li>Wiki: <a href=https://en.wikipedia.org/wiki/Address_Resolution_Protocol title="Address Resolution Protocol" target=_blank rel="nofollow noopener">Address Resolution Protocol</a></li></ul><h3 id=windows-questions>Windows Questions<a hidden class=anchor aria-hidden=true href=#windows-questions>#</a></h3><p><strong>What is UAC (User Account Control), and how does it work?</strong></p><ul><li>User Account Control (UAC) is a security feature in Windows that helps prevent unauthorized changes to the operating system. When an action requires administrative privileges, UAC prompts the user to confirm the action or enter an administrator password, depending on the user&rsquo;s account type. This helps protect the system from potentially harmful changes, such as the installation of malicious software, by ensuring that administrative tasks are not performed without explicit user consent.</li><li>Source: <a href=https://learn.microsoft.com/en-us/windows/security/application-security/application-control/user-account-control/how-it-works title="Microsoft User Account Control" target=_blank rel="nofollow noopener">Microsoft User Account Control</a></li></ul><p><strong>What is Windows Telemtry?</strong></p><ul><li>A Windows service that allows Microsoft to gather data from a device and transmit it to Microsoft:<ul><li>Device specifications and health</li><li>App usage and performance</li><li>Error reports and crash dumps</li><li>Feedback and ratings</li><li>Browser history and search queries</li><li>Location and activity history</li><li>Advertising ID and interests</li></ul></li><li>Source: <a href=https://www.geeksforgeeks.org/enable-or-disable-windows-telemetry/ title=GeeksForGeeks target=_blank rel="nofollow noopener">GeeksForGeeks</a></li></ul><p><strong>How can you view Windows logs?</strong></p><ul><li>Event Viewer (GUI)<ul><li>Application: Logs related to applications and programs.</li><li>Security: Logs related to security events, such as logins.</li><li>System: Logs related to Windows system components.</li><li>Setup: Logs related to the installation and setup of Windows.</li><li>Forwarded Events: Logs forwarded from other computers.</li></ul></li><li><code>Get-WinEvent -LogName System -MaxEvents 10</code></li></ul><p><strong>From a pcap, what are some ways to identify it is a Windows machine?</strong></p><ul><li>NetBIOS Name Service (NBNS) Traffic:<ul><li>Windows machines often use NetBIOS over TCP/IP for name resolution and service announcements.</li><li>Look for NBNS queries or responses on UDP port 137.</li><li>The machine name in NBNS traffic can indicate a Windows system.</li></ul></li><li>SMB/CIFS Traffic:<ul><li>Windows systems commonly use SMB (Server Message Block) for file and printer sharing.</li><li>Look for traffic on:<ul><li>TCP port 445 (SMB over TCP)</li><li>TCP port 139 (NetBIOS Session Service)</li></ul></li><li>The presence of SMB traffic, especially with &ldquo;Windows&rdquo; in the SMB header, is a strong indicator.</li></ul></li><li>Windows Update or WSUS Traffic:<ul><li>Windows machines regularly connect to Windows Update servers or a local WSUS for updates.</li><li>Look for HTTP/HTTPS traffic to domains like:<ul><li><code>update.microsoft.com</code></li><li><code>windowsupdate.microsoft.com</code></li></ul></li></ul></li><li>DNS Queries Specific to Windows:<ul><li>Windows systems may query DNS for specific Microsoft domains.</li><li>Look for DNS queries to domains like:<ul><li><code>microsoft.com</code></li><li><code>windows.com</code></li><li><code>msftncsi.com</code> (Network Connectivity Status Indicator)</li><li><code>msftconnecttest.com</code></li></ul></li></ul></li><li>Kerberos and LDAP Traffic:<ul><li>Kerberos traffic for authentication (typically on UDP/TCP port 88).</li><li>LDAP traffic on:<ul><li>TCP port 389 (standard LDAP)</li><li>TCP port 636 (LDAP over SSL)</li></ul></li><li>Common for domain-joined Windows machines.</li></ul></li><li>HTTP User-Agent Strings:<ul><li>Look for HTTP traffic and examine the User-Agent strings in the headers.</li><li>Windows systems typically include &ldquo;Windows&rdquo; in the User-Agent string.</li><li>Example: <code>"Mozilla/5.0 (Windows NT 10.0; Win64; x64)"</code>.</li></ul></li><li>ICMP Echo Request (Ping) Patterns:<ul><li>Windows machines send ICMP Echo Requests (pings) with a specific TTL (Time to Live) value.</li><li>The initial TTL value in Windows is often 128.</li><li>The default payload size for pings from Windows systems is typically 32 bytes.</li></ul></li><li>DHCP Client Identifiers:<ul><li>When a Windows machine requests an IP address via DHCP, it may send a client identifier that includes a MAC address or a string indicating the system is Windows.</li><li>Check DHCP Option 55 (Parameter Request List) and Option 60 (Vendor Class Identifier) for Windows-specific values.</li></ul></li><li>Microsoft-Specific Protocols:<ul><li>Windows machines use protocols unique to Windows environments:<ul><li>RDP (Remote Desktop Protocol) on TCP port 3389</li><li>WS-Discovery on UDP port 3702</li></ul></li><li>Presence of these protocols suggests a Windows system.</li></ul></li><li>Windows Time Service (W32Time):<ul><li>If the machine is synchronized with a time server, it may use the Windows Time Service.</li><li>Look for NTP (Network Time Protocol) traffic where the client might identify itself as a Windows machine.</li></ul></li></ul><h3 id=linux-questions>Linux Questions<a hidden class=anchor aria-hidden=true href=#linux-questions>#</a></h3><p><strong>What is <code>dmesg</code>?</strong></p><ul><li>Short for <strong>Diagnostic Messages</strong></li><li>Prints / Controls the <a href=https://unix.stackexchange.com/questions/198178/what-are-the-concepts-of-kernel-ring-buffer-user-level-log-level title="kernel ring buffer" target=_blank rel="nofollow noopener">kernel ring buffer</a> (a circular buffer used for keeping the log messages of the kernel and kernel modules)</li><li>Source: <a href=https://man7.org/linux/man-pages/man1/dmesg.1.html title="dmesg man page" target=_blank rel="nofollow noopener"><code>dmesg</code> man page</a></li></ul><p><strong>What is the difference between <code>/bin</code> and <code>/sbin</code></strong></p><ul><li><code>/bin</code> : For binaries usable before the <code>/usr</code> partition is mounted. This is used for trivial binaries used in the very early boot stage or ones that you need to have available in booting single-user mode. Think of binaries like <code>cat</code>, <code>ls</code>, etc.</li><li><code>/sbin</code> : Same, but for binaries with superuser (root) privileges required.</li><li><code>/usr/bin</code> : Same as first, but for general system-wide binaries.</li><li><code>/usr/sbin</code> : Same as above, but for binaries with superuser (root) privileges required.</li><li>Source: <a href=https://askubuntu.com/questions/308045/differences-between-bin-sbin-usr-bin-usr-sbin-usr-local-bin-usr-local title="Differences between&mldr;" target=_blank rel="nofollow noopener">Differences between&mldr;</a></li><li>More detail with <a href=https://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard title="Filesystem Hierarchy Standard (FHS)" target=_blank rel="nofollow noopener">Filesystem Hierarchy Standard (FHS)</a></li></ul><p><strong>What command can you use to find files?</strong></p><ul><li><p><code>find /path/to/search -name "*pattern*"</code></p></li><li><p>Source: <a href=https://man7.org/linux/man-pages/man1/find.1.html title="find man page" target=_blank rel="nofollow noopener"><code>find</code> man page</a></p></li><li><p><strong>What is the command to show services?</strong></p></li><li><p><code>systemctl</code> - Control the systemd system and service manager</p></li><li><p><code>systemctl list-unit</code> lists all units (services, sockets, timers) which are loaded into memory by <strong>systemd</strong></p></li><li><p><code>systemctl --type=service --state=running</code> to specifically show running services</p></li><li><p>Source: <a href=https://www.man7.org/linux/man-pages/man1/systemctl.1.html title="systemctl man page" target=_blank rel="nofollow noopener"><code>systemctl</code> man page</a></p></li></ul><h3 id=attack-questions>Attack Questions<a hidden class=anchor aria-hidden=true href=#attack-questions>#</a></h3><p><strong>What is the difference between Reflected XSS, Stored XSS and DOM XSS?</strong></p><ul><li>Reflected XSS: where the malicious script comes from the current HTTP request.</li><li>Stored XSS: where the malicious script comes from the website&rsquo;s database.</li><li>DOM-based XSS: where the vulnerability exists in client-side code rather than server-side code.</li></ul><p><strong>What is Kerberoasting?</strong></p><ul><li>Targets Service Principal Name accounts, specifically the NTLM hash which is used to encrypt TGS-REP</li><li>All thats needed is cleartext password or NTLM hash of user, shell in context of domain user account, or SYSTEM level access on a domain-joined host</li></ul><h3 id=ythacksplained-pentest-interview-questionshttpswwwyoutubecomwatchvcr-dj6eueiy>YT:Hacksplained &ldquo;<a href="https://www.youtube.com/watch?v=cR-Dj6eueiY" title="Pentest Interview Questions" target=_blank rel="nofollow noopener">Pentest Interview Questions</a>&rdquo;</h3><h4 id=general-questions>General Questions<a hidden class=anchor aria-hidden=true href=#general-questions>#</a></h4><p><strong>What is the last pentest tool you used, improved, suite?</strong></p><p><strong>Where do you find new vulnerability research?</strong></p><p><strong>Who is your hacking idol?</strong></p><p><strong>What is your latest writeup?</strong></p><p><strong>Where do you have room to improve in?</strong></p><h4 id=junior-level>Junior Level<a hidden class=anchor aria-hidden=true href=#junior-level>#</a></h4><p><strong>What is XSS?</strong></p><p><strong>What is SQL Injection?</strong>
When an attacker is able to insert a malicious SQL payload within a website field in order to interact with the SQL database. This is due to improper (or lack there of) sanatization of client-side input. Often times this involves having a query that will always be true, such as <code>1=1 --</code>. <a href=https://book.hacktricks.xyz/pentesting-web/sql-injection title=HackTricks target=_blank rel="nofollow noopener">HackTricks</a> has quite a few paylaods and descriptions to help.</p><p><strong>What is an Open Redirect (Vulnerability)?</strong>
Open redirects are when a web application allows users to redirect/forward to another URL. Open redirect vulnerabilites can lead to phishing attacks, XSS attacks, SSRF attacks, CSP bypassing, etc.</p><p><strong>Which cookie security flags exist?</strong></p><p><strong>Difference between Pentest / Vulnerability test?</strong></p><p><strong>Difference between Black/White/Gray box?</strong></p><p><strong>What pentest types/techniques exist?</strong></p><p><strong>Which file upload restrictions are common in web applications?</strong></p><h4 id=senior-level>Senior Level<a hidden class=anchor aria-hidden=true href=#senior-level>#</a></h4><p><strong>Content of a good pentest report?</strong></p><p><strong>How do you detect a CSRF attack?</strong></p><p><strong>How does XXE payload work?</strong></p><p><strong>What is a boolean blind SQLi?</strong></p><p><strong>Explain different HTTP methods, what they are used for, and how to be exploited?</strong></p><p><strong>What is a salt?</strong></p><p><strong>Difference between attack web app and api?</strong></p><p><strong>Last found business logic vulnerability?</strong></p><h4 id=principal-level>Principal Level<a hidden class=anchor aria-hidden=true href=#principal-level>#</a></h4><p><strong>What is a threat model and how can this be useful?</strong></p><p><strong>Benefits of bug bounty vs pentest?</strong></p><p><strong>How to measure pentest results?</strong></p><p><strong>Explain details of HTTP DSync attack</strong></p><p><strong>How does deserialization work?</strong></p><p><strong>What are common auth standards and how can you attack them?</strong></p><p><strong>Can SSTI lead to RCE?</strong></p><p><strong>What was your last RCE vulnerability?</strong></p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://woadey.xyz/posts/htb/pentester/><span class=title>Next »</span><br><span>HTB Academy: Penetration Tester</span></a></nav></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>